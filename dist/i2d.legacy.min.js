/*!
      * i2djs v3.6.0
      * (c) 2021 Narayana Swamy (narayanaswamy14@gmail.com)
      * @license BSD-3-Clause
      */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).i2d={})}(this,(function(t){"use strict";var e,r,i,n=null,o=[],a={},s=[],h=[];function c(t,e,r){this.executable=e,this.duration=e.duration?e.duration:0,this.delay=e.delay?e.delay:0,this.lastTime=0-(e.delay?e.delay:0),this.loopTracker=0,this.loop=e.loop?e.loop:0,this.direction=e.direction,this.easying=r,this.end=e.end?e.end:null,"reverse"===this.direction?this.factor=1:this.factor=0}function l(){}"undefined"==typeof window&&(global.window={setTimeout:setTimeout,clearTimeout:clearTimeout},global.performance={now:function(){return Date.now()}},global.document={}),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)},c.prototype.execute=function(t){this.executable.run(t)},c.prototype.resetCallBack=function(t){"function"==typeof t&&(this.callBack=t)},l.prototype={startAnimeFrames:function(){e||(e=window.requestAnimationFrame(p))},stopAnimeFrame:function(){e&&(window.cancelAnimFrame(e),e=null)},add:function(t,e,r){var i=new c(t,e,r);i.currTime=performance.now(),e.target&&(e.target.animList||(e.target.animList=[]),e.target.animList[e.target.animList.length]=i),o[o.length]=i,this.startAnimeFrames()},remove:function(t){var e=o.indexOf(t);-1!==e&&o.splice(e,1)},onRequestFrame:function(t){if("function"!=typeof t)throw new Error("Wrong input");h.push(t),h.length>0&&!e&&this.startAnimeFrames()},removeRequestFrameCall:function(t){if("function"!=typeof t)throw new Error("Wrong input");var e=h.indexOf(t);-1!==e&&h.splice(e,1)},clearAll:function(){o=[],h=[]}},l.prototype.addVdom=function(t){var e=s.length+1;return a[e]=t,s.push(e),this.startAnimeFrames(),e},l.prototype.removeVdom=function(t){var e=s.indexOf(t);-1!==e&&(s.splice(e,1),a[t].root.destroy(),delete a[t]),0===s.length&&0===o.length&&0===h.length&&this.stopAnimeFrame()},l.prototype.vDomChanged=function(t){if(a[t]&&void 0!==a[t].stateModified)a[t].stateModified=!0,a[t].root.stateModified=!0;else if("string"==typeof t){var e=t.split(":");if(a[e[0]]&&void 0!==a[e[0]].stateModified){a[e[0]].stateModified=!0,a[e[0]].root.stateModified=!0;var r=a[e[0]].root.fetchEl("#"+e[1]);r&&(r.stateModified=!0)}}},l.prototype.execute=function(){this.startAnimeFrames()},l.prototype.vDomUpdates=function(){for(var t=0,e=s.length;t<e;t+=1)if(s[t]&&a[s[t]]&&a[s[t]].stateModified)a[s[t]].execute(),a[s[t]].stateModified=!1;else if(s[t]&&a[s[t]]&&a[s[t]].root&&"NODE"!==a[s[t]].root.ENV){document.getElementById(a[s[t]].root.container.id)||this.removeVdom(s[t])}};var d=Math.abs,f=0,u=[];function p(){try{u=[],f=0,i=performance.now();for(var t=0;t<o.length;t+=1)(r=o[t]).lastTime+=i-r.currTime,r.currTime=i,r.lastTime<r.duration&&r.lastTime>=0?(r.execute(d(r.factor-r.easying(r.lastTime,r.duration))),u[f++]=r):r.lastTime>r.duration?y(r):u[f++]=r;o=u,h.length>0&&function(){for(var t=0;t<h.length;t+=1)h[t](i)}(),n.vDomUpdates()}catch(t){console.error(t)}finally{e=window.requestAnimationFrame(p)}}function y(t){if(t.loopTracker>=t.loop-1){if(t.execute(1-t.factor),t.end&&t.end(),t.executable.target){var e=t.executable.target.animList;if(e&&e.length>0)if(1===e.length)t.executable.target.animList=[];else if(e.length>1){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}}}else t.loopTracker+=1,t.lastTime=t.lastTime-t.duration,t.lastTime=t.lastTime%t.duration,"alternate"===t.direction?t.factor=1-t.factor:"reverse"===t.direction?t.factor=1:t.factor=0,t.execute(d(t.factor-t.easying(t.lastTime,t.duration))),u[f++]=t}var x=n=new l;function v(){}function m(t,e){var r,i=0,n=0,o=1,a=1,s=e;if(t.attr.transform&&t.attr.transform.translate&&(i=(r=t.attr.transform.translate)[0],n=r[1],s.x-=i,s.y-=n),t.attr.transform&&t.attr.transform.scale&&(o=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,a=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:o,s.x/=o,s.y/=a),t.attr.transform&&t.attr.transform.rotate){var h=t.attr.transform.rotate[0],c={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},l=s.x,d=s.y,f=c.x,u=c.y,p=Math.PI/180*h,y=Math.cos(p),x=Math.sin(p);s.x=y*(l-f)+x*(d-u)+f,s.y=y*(d-u)-x*(l-f)+u}}v.prototype.execute=function(){this.root.execute(),this.stateModified=!1},v.prototype.rootNode=function(t){this.root=t,this.stateModified=!0},v.prototype.eventsCheck=function(t,e,r){for(var i,n,o=0;o<=t.length-1;o+=1){var a=t[o],s={x:e.x,y:e.y};m(a,s),a.in({x:s.x,y:s.y})&&(a.children&&a.children.length>0?(n=this.eventsCheck(a.children,{x:s.x,y:s.y},r))&&(i=n):i=a)}return i},v.prototype.transformCoOr=m;var g=Math.sqrt,b=Math.sin,w=Math.cos,B=Math.abs,A=Math.atan2,T=Math.tan,k=Math.PI,E=Math.ceil,S=Math.max;function C(t,e){var r=1;if(0===e)return r;for(var i=1;i<=e;i+=1)r*=t;return r}function D(t,e){var r=0;for(var i in t)r+=C(e[i]-t[i],2);if(isNaN(r))throw new Error("error");return g(r)}function M(t,e,r){var i=C(r,3),n=C(r,2);return{x:e.ax*i+e.bx*n+e.cx*r+t.x,y:e.ay*i+e.by*n+e.cy*r+t.y}}var _=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r,i=[],n=!0,o=!1;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{o&&console.log("Error -"+r)}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},z=2*k,I=function(t,e,r,i,n,o,a){var s=t.x,h=t.y;return{x:i*(s*=e)-n*(h*=r)+o,y:n*s+i*h+a}},P=function(t,e){var r=4/3*T(e/4),i=w(t),n=b(t),o=w(t+e),a=b(t+e);return[{x:i-n*r,y:n+i*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]},O=function(t,e,r,i){var n=t*i-e*r<0?-1:1,o=(t*r+e*i)/(g(t*t+e*e)*g(t*t+e*e));return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)};function L(t,e,r,i){var n=t.x,o=t.y,a=e.x,s=e.y,h=k/180*r,c=w(-h),l=b(-h);return{x:c*(n-a)+l*(o-s)+a,y:c*(o-s)-l*(n-a)+s}}function N(){}N.prototype={pow:C,getAngle:function(t,e){return A(e.x-t.x,e.y-t.y)},getDistance:D,scaleAlongOrigin:function(t,e){var r={};for(var i in t)r[i]=t[i]*e;return r},scaleAlongPoint:function(t,e,r){var i=(t.y-e.y)/(t.x-e.x),n=t.x*r;return{x:n,y:(i*(n-e.x)+e.y)*r}},linearTransitionBetweenPoints:function(t,e,r){return{x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r}},bezierTransition:function(t,e,r,i){return{x:(t.x-2*e.x+r.x)*i*i+(2*e.x-2*t.x)*i+t.x,y:(t.y-2*e.y+r.y)*i*i+(2*e.y-2*t.y)*i+t.y}},bezierLength:function(t,e,r){var i={},n={};i.x=t.x+r.x-2*e.x,i.y=t.y+r.y-2*e.y,n.x=2*e.x-2*t.x,n.y=2*e.y-2*t.y;var o=4*(i.x*i.x+i.y*i.y),a=4*(i.x*n.x+i.y*n.y),s=n.x*n.x+n.y*n.y,h=2*g(o+a+s),c=g(o),l=2*o*c,d=2*g(s),f=a/c,u=(2*c+f+h)/(f+d);return u=isNaN(u)||B(u)===1/0?1:u,(l*h+c*a*(h-d)+(4*s*o-a*a)*Math.log(u))/(4*l)},cubicBezierTransition:M,cubicBezierLength:function(t,e){for(var r,i,n=.001,o=0,a=M.bind(null,t,e),s=0;s<=1;s+=n)r=a(s),i=a(s+n),o+=g(C((i.x-r.x)/n,2)+C((i.y-r.y)/n,2))*n;return o},cubicBezierCoefficients:function(t){var e=3*(t.cntrl1.x-t.p0.x),r=3*(t.cntrl2.x-t.cntrl1.x)-e,i=t.p1.x-t.p0.x-e-r,n=3*(t.cntrl1.y-t.p0.y),o=3*(t.cntrl2.y-t.cntrl1.y)-n;return{cx:e,bx:r,ax:i,cy:n,by:o,ay:t.p1.y-t.p0.y-n-o}},arcToBezier:function(t){var e=t.px,r=t.py,i=t.cx,n=t.cy,o=t.rx,a=t.ry,s=t.xAxisRotation,h=void 0===s?0:s,c=t.largeArcFlag,l=void 0===c?0:c,d=t.sweepFlag,f=void 0===d?0:d,u=[];if(0===o||0===a)return[];var p=b(h*z/360),y=w(h*z/360),x=y*(e-i)/2+p*(r-n)/2,v=-p*(e-i)/2+y*(r-n)/2;if(0===x&&0===v)return[];o=B(o),a=B(a);var m=C(x,2)/C(o,2)+C(v,2)/C(a,2);m>1&&(o*=g(m),a*=g(m));var A=function(t,e,r,i,n,o,a,s,h,c,l,d){var f=C(n,2),u=C(o,2),p=C(l,2),y=C(d,2),x=f*u-f*y-u*p;x<0&&(x=0);var v=(x=g(x/=f*y+u*p)*(a===s?-1:1))*n/o*d,m=x*-o/n*l,b=c*v-h*m+(t+r)/2,w=h*v+c*m+(e+i)/2,B=(l-v)/n,A=(d-m)/o,T=(-l-v)/n,k=(-d-m)/o,E=O(1,0,B,A),S=O(B,A,T,k);return 0===s&&S>0&&(S-=z),1===s&&S<0&&(S+=z),[b,w,E,S]}(e,r,i,n,o,a,l,f,p,y,x,v),T=_(A,4),k=T[0],D=T[1],M=T[2],L=T[3],N=S(E(B(L)/(z/4)),1);L/=N;for(var F=0;F<N;F++)u.push(P(M,L)),M+=L;return u.map((function(t){var e=I(t[0],o,a,y,p,k,D),r=e.x,i=e.y,n=I(t[1],o,a,y,p,k,D),s=n.x,h=n.y,c=I(t[2],o,a,y,p,k,D);return{x1:r,y1:i,x2:s,y2:h,x:c.x,y:c.y}}))},intermediateValue:function(t,e,r){return t+(e-t)*r},toCubicCurves:function(t){if(t.length){for(var e=t,r=[],i=0;i<e.length;i+=1)if(-1!==["M","C","S","Q"].indexOf(e[i].type))r.push(e[i]);else if(-1!==["V","H","L","Z"].indexOf(e[i].type)){var n={x:(e[i].p0.x+e[i].p1.x)/2,y:(e[i].p0.y+e[i].p1.y)/2};r.push({p0:e[i].p0,cntrl1:n,cntrl2:n,p1:e[i].p1,type:"C",length:e[i].length})}else console.log("wrong cmd type");return r}},rotatePoint:L,rotateBBox:function(t,e){var r={x:t.x,y:t.y},i={x:t.x+t.width,y:t.y},n={x:t.x,y:t.y+t.height},o={x:t.x+t.width,y:t.y+t.height},a=e.translate,s=e.rotate,h={x:s[1]||0,y:s[2]||0},c=s[0];a&&a.length>0&&(h.x+=a[0],h.y+=a[1]),r=L(r,h,c,D(r,h)),i=L(i,h,c,D(i,h)),n=L(n,h,c,D(n,h)),o=L(o,h,c,D(o,h));var l=[r.x,i.x,n.x,o.x].sort((function(t,e){return t-e})),d=[r.y,i.y,n.y,o.y].sort((function(t,e){return t-e}));return{x:l[0],y:d[0],width:l[3]-l[0],height:d[3]-d[0]}}};var F=new N,R=F;function j(t,e){return t/e}function X(t,e){var r=t/e;return 1-(1-r)*Math.sin(r*e*.002*Math.PI*2+Math.PI/2)/Math.exp(8*r)}function G(t,e){var r=t/e,i=r/100;return 1-(1-r)*Math.abs(Math.sin(r*e*i*Math.PI*2+Math.PI/2))/Math.exp(10*r)}function Y(t,e){var r=t/e;return r*r}function U(t,e){var r=t/e;return r*(2-r)}function H(t,e){var r=t/e;return r<.5?2*r*r:(4-2*r)*r-1}function V(t,e){var r=t/e;return R.pow(r,3)}function q(t,e){var r=t/e;return(r-=1)*r*r+1}function Z(t,e){var r=t/e;return r<.5?4*R.pow(r,3):(r-1)*(2*r-2)*(2*r-2)+1}function W(t,e){var r=t/e;return 1-Math.cos(r*Math.PI/2)}function Q(t,e){var r=t/e;return Math.cos(r*Math.PI/2)}function $(t,e){var r=t/e;return(1-Math.cos(Math.PI*r))/2}function J(t){var e;if("function"==typeof t)return function(e,r){return t(e/r)};switch(t){case"easeOutQuad":e=U;break;case"easeInQuad":e=Y;break;case"easeInOutQuad":e=H;break;case"easeInCubic":e=V;break;case"easeOutCubic":e=q;break;case"easeInOutCubic":e=Z;break;case"easeInSin":e=W;break;case"easeOutSin":e=Q;break;case"easeInOutSin":e=$;break;case"bounce":e=G;break;case"linear":e=j;break;case"elastic":e=X;break;default:e=j}return e}var K=0,tt=0;function et(){return K+=1}function rt(){return tt+=1}var it=J;function nt(t){return this.easying=it(t),this.transition=t,this}function ot(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.durationP=t,this}function at(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.loopValue=t,this}function st(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.directionV=t,this}function ht(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.data=t,"CANVAS"===this.data.nodeName&&(this.canvasStack=[]),this}function ct(t){return"function"!=typeof t?null:(this.callbckExe=t,this)}function lt(t){return this.end=t,this}function dt(t){return this.endExe=t,this}function ft(){this.start()}function ut(){this.queue=x,this.sequenceQueue=[],this.lengthV=0,this.currPos=0,this.ID=et(),this.loopCounter=0}function pt(){this.queue=x,this.group=[],this.currPos=0,this.ID=et(),this.loopCounter=1}ut.prototype={duration:ot,loop:at,callbck:ct,bind:ht,child:lt,ease:nt,end:dt,commit:ft,reset:function(t){return this.resetV=t,this},direction:st},ut.prototype.add=function(t){var e=this;return Array.isArray(t)||"function"==typeof t||(t=[t]),Array.isArray(t)&&t.map((function(t){return e.lengthV+=t.length?t.length:0,t})),this.sequenceQueue=this.sequenceQueue.concat(t),this},ut.prototype.easyingGlobal=function(t,e){return t/e},ut.prototype.start=function(){var t=this;if("alternate"===t.directionV)t.factor=t.factor?-1*t.factor:1,t.currPos=t.factor<0?this.sequenceQueue.length-1:0;else if("reverse"===t.directionV){for(var e=0;e<this.sequenceQueue.length;e+=1){var r=this.sequenceQueue[e];r instanceof ut||r instanceof pt||r.run(1),t.currPos=e}t.factor=-1}else t.currPos=0,t.factor=1;this.execute()},ut.prototype.execute=function(){var t=this,e=this.sequenceQueue[t.currPos];if(e="function"==typeof e?e():e)return e instanceof ut||e instanceof pt?e.end(t.triggerEnd.bind(t,e)).commit():(this.currObj=e,this.queue.add(rt(),{run:function(t){e.run(t)},target:e.target,delay:void 0!==e.delay?e.delay:0,duration:void 0!==e.duration?e.duration:t.durationP,loop:e.loop?e.loop:1,direction:t.factor<0?"reverse":"default",end:t.triggerEnd.bind(t,e)},(function(t,e){return t/e}))),this},ut.prototype.triggerEnd=function(t){var e=this;if(e.currPos+=e.factor,t.end&&e.triggerChild(t),e.sequenceQueue.length===e.currPos||e.currPos<0)return e.endExe&&e.endExe(),e.loopCounter+=1,void(e.loopCounter<e.loopValue&&e.start());this.execute()},ut.prototype.triggerChild=function(t){t.end instanceof pt||t.end instanceof ut?setTimeout((function(){t.end.commit()}),0):t.end()},pt.prototype={duration:ot,loop:at,callbck:ct,bind:ht,child:lt,ease:nt,end:dt,commit:ft,direction:st},pt.prototype.add=function(t){var e=this;return Array.isArray(t)||(t=[t]),this.group=this.group.concat(t),this.group.forEach((function(t){t.durationP=t.durationP?t.durationP:e.durationP})),this},pt.prototype.execute=function(){var t=this;t.currPos=0;for(var e=function(e,r){var i=t.group[e];i instanceof ut||i instanceof pt?i.end(t.triggerEnd.bind(t,i)).commit():t.queue.add(rt(),{run:function(t){i.run(t)},target:i.target,delay:void 0!==i.delay?i.delay:0,duration:void 0!==i.duration?i.duration:t.durationP,loop:i.loop?i.loop:1,direction:i.direction?i.direction:"default",end:t.triggerEnd.bind(t,i)},i.ease?it(i.ease):t.easying)},r=0,i=t.group.length;r<i;r++)e(r);return t},pt.prototype.start=function(){var t=this;"alternate"===t.directionV?t.factor=t.factor?-1*t.factor:1:"reverse"===t.directionV?t.factor=-1:t.factor=1,this.execute()},pt.prototype.triggerEnd=function(t){var e=this;this.currPos+=1,t.end&&this.triggerChild(t.end),this.currPos===this.group.length&&(this.endExe&&this.triggerChild(this.endExe),e.loopCounter+=1,e.loopCounter<e.loopValue&&e.start())},pt.prototype.triggerChild=function(t){t instanceof pt||t instanceof ut?t.commit():"function"==typeof t?t():console.log("wrong type")};var yt={sequenceChain:function(){return new ut},parallelChain:function(){return new pt}},xt=0,vt=F,mt=x,gt=J;function bt(t,e,r,i){var n=r.minX,o=r.minY,a=r.maxX,s=r.maxY;if(-1!==["V","H","L","v","h","l"].indexOf(t.type))[t.p0?t.p0:e.p1,t.p1].forEach((function(t){t.x<n&&(n=t.x),t.x>a&&(a=t.x),t.y<o&&(o=t.y),t.y>s&&(s=t.y)}));else if(-1!==["Q","C","q","c"].indexOf(t.type))for(var h,c=vt.cubicBezierCoefficients(t),l=vt.cubicBezierTransition.bind(null,t.p0,c),d=0;d<1;)h=l(d),d+=.05,h.x<n&&(n=h.x),h.x>a&&(a=h.x),h.y<o&&(o=h.y),h.y>s&&(s=h.y);else{var f=t.p0;f.x<n&&(n=f.x),f.x>a&&(a=f.x),f.y<o&&(o=f.y),f.y>s&&(s=f.y)}r.minX=n,r.minY=o,r.maxX=a,r.maxY=s,i.x=n,i.y=o,i.width=a-n,i.height=s-o}function wt(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Bt(t,e){return{x:t.x-e.x,y:t.y-e.y}}function At(t,e,r){return t?r:e}function Tt(t){this.stack=[],this.length=0,this.stackGroup=[],this.BBox={x:0,y:0,width:0,height:0},this.minMax={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},t&&this.parse(t)}function kt(t){return["S","C","V","L","H","Q"].indexOf(t)>-1}Tt.prototype={z:function(){return this.cp=this.start,this.segmentLength=vt.getDistance(this.pp,this.cp),this.stack.push({p0:this.pp,p1:this.cp,type:"Z",length:this.segmentLength,pointAt:function(t){return vt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},m:function(t,e){var r=At(t,this.pp?this.pp:{x:0,y:0},{x:0,y:0});return this.cntrl=null,this.cp=wt(e,r),this.start=this.cp,this.segmentLength=0,this.length=this.segmentLength,0!==this.currPathArr&&this.pp?(this.stackGroup.push(this.stack),this.stack=[]):this.stackGroup.push(this.stack),this.stack.push({type:"M",p0:this.cp,length:this.segmentLength,pointAt:function(t){return this.p0}}),this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},v:function(t,e){var r=At(t,this.pp,{x:this.pp.x,y:0});return this.cntrl=null,this.cp=wt(e,r),this.segmentLength=vt.getDistance(this.pp,this.cp),this.stack.push({type:"V",p0:this.pp,p1:this.cp,length:this.segmentLength,pointAt:function(t){return vt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},h:function(t,e){var r=At(t,this.pp,{x:0,y:this.pp.y});return this.cp=wt(e,r),this.cntrl=null,this.segmentLength=vt.getDistance(this.pp,this.cp),this.stack.push({type:t?"H":"h",p0:this.pp,p1:this.cp,length:this.segmentLength,relative:{p1:e},pointAt:function(t){return vt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},l:function(t,e){var r=At(t,this.pp,{x:0,y:0});return this.cntrl=null,this.cp=wt(e,r),this.segmentLength=vt.getDistance(this.pp,this.cp),this.stack.push({type:t?"L":"l",p0:this.pp,p1:this.cp,relative:{p1:e},length:this.segmentLength,pointAt:function(t){return vt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},q:function(t,e,r){var i=At(t,this.pp,{x:0,y:0}),n=wt(e,i),o=wt(r,i);return this.cp=o,this.segmentLength=vt.bezierLength(this.pp,n,this.cp),this.cp=o,this.stack.push({type:t?"Q":"q",p0:this.pp,cntrl1:n,cntrl2:n,p1:this.cp,relative:{cntrl1:e,p1:r},length:this.segmentLength,pointAt:function(t){return vt.bezierTransition(this.p0,this.cntrl1,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=n,bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this},s:function(t,e,r){var i=At(t,this.pp,{x:0,y:0}),n=wt(e,i),o=this.cntrl?wt(this.pp,Bt(this.pp,this.cntrl?this.cntrl:this.pp)):n,a=wt(r,i);this.cp=a;var s=vt.cubicBezierCoefficients({p0:this.pp,cntrl1:o,cntrl2:n,p1:a});return this.segmentLength=vt.cubicBezierLength(this.pp,s),this.stack.push({type:t?"S":"s",p0:this.pp,cntrl1:o,cntrl2:n,p1:this.cp,co:s,length:this.segmentLength,relative:{cntrl2:e,p1:r},pointAt:function(t){return vt.cubicBezierTransition(this.p0,this.co,t)}}),bt(this.stack[this.stack.length-1],this.stack[this.stack.length-2],this.minMax,this.BBox),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=n,this},c:function(t,e,r,i){var n=this,o=At(t,this.pp,{x:0,y:0}),a=wt(e,o),s=wt(r,o),h=wt(i,o),c=vt.cubicBezierCoefficients({p0:this.pp,cntrl1:a,cntrl2:s,p1:h});return this.cntrl=s,this.cp=h,this.segmentLength=vt.cubicBezierLength(this.pp,c),this.stack.push({type:t?"C":"c",p0:this.pp,cntrl1:a,cntrl2:s,p1:this.cp,length:this.segmentLength,co:c,relative:{cntrl1:e,cntrl2:r,p1:i},pointAt:function(t){return vt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,bt(n.stack[n.stack.length-1],n.stack[n.stack.length-2],n.minMax,n.BBox),this},a:function(t,e,r,i,n,o,a){var s=At(t,this.pp,{x:0,y:0}),h=this,c=wt(a,s);this.cp=c;var l=vt.arcToBezier({px:this.pp.x,py:this.pp.y,cx:c.x,cy:c.y,rx:e,ry:r,xAxisRotation:i,largeArcFlag:n,sweepFlag:o});return l.forEach((function(t,e){var r=0===e?h.pp:{x:l[0].x,y:l[0].y},i={x:t.x1,y:t.y1},n={x:t.x2,y:t.y2},o={x:t.x,y:t.y},a=vt.cubicBezierLength(r,vt.cubicBezierCoefficients({p0:r,cntrl1:i,cntrl2:n,p1:o}));h.stack.push({type:"C",p0:r,cntrl1:i,cntrl2:n,p1:o,length:a,pointAt:function(t){return vt.bezierTransition(this.p0,this.cntrl1,this.cntrl2,this.p1,t)}}),h.length+=a,bt(h.stack[h.stack.length-1],h.stack[h.stack.length-2],h.minMax,h.BBox)})),this.pp=this.cp,this.cntrl=null,this},fetchXY:function(){return{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:parseFloat(this.pathArr[this.currPathArr+=1])}}},Tt.prototype.points=function(t){if(void 0===this.f&&(this.f=.3),void 0===this.t&&(this.t=.6),0!==t.length){this.m(!0,{x:t[0].x,y:t[0].y});for(var e=0,r=0,i=0,n=0,o=0,a=t[0],s=1;s<t.length;s++){var h=t[s],c=t[s+1];n=0,o=0,c&&(e=(c.y-a.y)/(c.x-a.x),o=(n=(c.x-h.x)*-this.f)*e*this.t),this.c(!0,{x:a.x-r,y:a.y-i},{x:h.x+n,y:h.y+o},{x:h.x,y:h.y}),r=n,i=o,a=h}}},Tt.prototype.curveFfactor=function(t){this.f=t},Tt.prototype.curveTfactor=function(t){this.t=t},Tt.prototype.parse=function(t){for(this.path=t,this.currPathArr=-1,this.stack=[],this.length=0,this.pathArr=function(t){var e=t.replace(/e-/g,"$");e=(e=(e=e.replace(/ /g,",")).replace(/-/g,",-")).split(/([a-zA-Z,])/g).filter((function(t){return""!==t&&","!==t})).map((function(t){return t.replace(/\$/g,"e-")}));for(var r=0;r<e.length;r+=1)if(e[r].split(".").length>2){for(var i=e[r].split("."),n=[i[0]+"."+i[1]],o=2;o<i.length;o+=1)n.push("."+i[o]);e.splice(r,1,n[0],n[1])}return e}(this.path),this.stackGroup=[];this.currPathArr<this.pathArr.length-1;)this.case(this.pathArr[this.currPathArr+=1]);return this.stack},Tt.prototype.fetchPathString=function(){for(var t,e="",r=0;r<this.stack.length;r++)"M"===(t=this.stack[r]).type||"m"===t.type?e+=t.type+" "+t.p0.x+","+t.p0.y+" ":"Z"===t.type||"z"===t.type?e+="z":"C"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"c"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"Q"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.p1.x+","+t.p1.y+" ":"q"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"S"===t.type?e+=t.type+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"s"===t.type?e+=t.type+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"V"===t.type?e+=t.type+" "+t.p1.y+" ":"v"===t.type?e+=t.type+" "+t.relative.p1.y+" ":"H"===t.type?e+=t.type+" "+t.p1.x+" ":"h"===t.type?e+=t.type+" "+t.relative.p1.x+" ":"L"===t.type?e+=t.type+" "+t.p1.x+","+t.p1.y+" ":"l"===t.type&&(e+=t.type+" "+t.relative.p1.x+","+t.relative.p1.y+" ");return e},Tt.prototype.getTotalLength=function(){return this.length},Tt.prototype.getAngleAtLength=function(t,e){if(t>this.length)return null;var r=this.getPointAtLength(t),i=this.getPointAtLength(t+("src"===e?-1*t*.01:.01*t));return Math.atan2(i.y-r.y,i.x-r.x)},Tt.prototype.getPointAtLength=function(t){var e={x:0,y:0},r=t;return this.stack.every((function(t,i){return r-=t.length,Math.floor(r)>=0||(e=t.pointAt((t.length+r)/(0===t.length?1:t.length)),!1)})),e},Tt.prototype.execute=function(t,e){var r;e||t.beginPath();for(var i=0;i<this.stack.length;i++)switch((r=this.stack[i]).type){case"M":case"m":t.moveTo(r.p0.x,r.p0.y);break;case"Z":case"z":t.lineTo(r.p1.x,r.p1.y);break;case"L":case"l":case"V":case"v":case"H":case"h":t.lineTo(r.p1.x,r.p1.y);break;case"C":case"c":case"S":case"s":t.bezierCurveTo(r.cntrl1.x,r.cntrl1.y,r.cntrl2.x,r.cntrl2.y,r.p1.x,r.p1.y);break;case"Q":case"q":t.quadraticCurveTo(r.cntrl1.x,r.cntrl1.y,r.p1.x,r.p1.y)}e||t.closePath()},Tt.prototype.getPoints=function(t){for(var e,r=[],i=0;i<this.stack.length;i++){var n=0;switch((e=this.stack[i]).type){case"M":case"m":r[r.length]=e.p0.x,r[r.length]=e.p0.y;break;case"Z":case"z":r[r.length]=e.p1.x,r[r.length]=e.p1.y;break;case"L":case"l":case"V":case"v":case"H":case"h":r[r.length]=e.p1.x,r[r.length]=e.p1.y;break;case"C":case"c":case"S":case"s":case"Q":case"q":for(;n<=1;){var o=e.pointAt(n);r[r.length]=o.x,r[r.length]=o.y,n+=.05}}}return r},Tt.prototype.case=function(t){var e,r,i,n,o,a=t;switch(-1!==["m","M","v","V","l","L","h","H","q","Q","c","C","s","S","a","A","z","Z"].indexOf(a)?this.PC=a:(a=this.PC,this.currPathArr=this.currPathArr-1),a){case"m":this.m(!1,this.fetchXY());break;case"M":this.m(!0,this.fetchXY());break;case"v":this.v(!1,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"V":this.v(!0,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"l":this.l(!1,this.fetchXY());break;case"L":this.l(!0,this.fetchXY());break;case"h":this.h(!1,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"H":this.h(!0,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"q":this.q(!1,this.fetchXY(),this.fetchXY());break;case"Q":this.q(!0,this.fetchXY(),this.fetchXY());break;case"c":this.c(!1,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"C":this.c(!0,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"s":this.s(!1,this.fetchXY(),this.fetchXY());break;case"S":this.s(!0,this.fetchXY(),this.fetchXY());break;case"a":e=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!1,e,r,i,n,o,this.fetchXY());break;case"A":e=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!0,e,r,i,n,o,this.fetchXY());break;case"z":case"Z":this.z()}};var Et=function(t,e,r,i,n,o){this.type=t,this.p0=e,this.c1_src=r,this.c2_src=i,this.co=n,this.length_src=o};Et.prototype.execute=function(t){var e=this.co,r=this.p0,i=this.c1_src,n=this.c2_src,o={x:r.x+(i.x-r.x)*t,y:r.y+(i.y-r.y)*t},a=i.x+(n.x-i.x)*t,s=i.y+(n.y-i.y)*t;return this.cntrl1=o,this.cntrl2={x:o.x+(a-o.x)*t,y:o.y+(s-o.y)*t},this.p1={x:e.ax*vt.pow(t,3)+e.bx*vt.pow(t,2)+e.cx*t+r.x,y:e.ay*vt.pow(t,3)+e.by*vt.pow(t,2)+e.cy*t+r.y},this.length=this.length_src*t,this.relative={cntrl1:kt(this.type)?this.cntrl1:Bt(this.cntrl1,this.p0),cntrl2:kt(this.type)?this.cntrl2:Bt(this.cntrl2,this.p0),p1:kt(this.type)?this.p1:Bt(this.p1,this.p0)},this},Et.prototype.pointAt=function(t){return vt.cubicBezierTransition(this.p0,this.co,t)};var St=function(t,e,r,i,n,o){this.type=t,this.p0=e,this.p1_src=r,this.p2_src=i,this.length_src=n,this.length=0};St.prototype.execute=function(t){var e=this.p0,r=this.p1_src,i=this.p2_src;return this.length=this.length_src*t,this.cntrl1={x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t},this.cntrl2=this.cntrl1,this.p1={x:(e.x-2*r.x+i.x)*t*t+(2*r.x-2*e.x)*t+e.x,y:(e.y-2*r.y+i.y)*t*t+(2*r.y-2*e.y)*t+e.y},this.relative={cntrl1:kt(this.type)?this.cntrl1:Bt(this.cntrl1,this.p0),p1:kt(this.type)?this.p1:Bt(this.p1,this.p0)},this},St.prototype.pointAt=function(t){return vt.bezierTransition(this.p0,this.cntrl1,this.p1,t)};var Ct=function(t,e,r,i,n){this.type=t,this.p0=e,this.p1=e,this.p2_src=r,this.length_src=i,this.length=0};function Dt(t){return t instanceof Tt}Ct.prototype.execute=function(t){var e=this.p0,r=this.p2_src;return this.p1={x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t},this.length=this.length_src*t,this.relative={p1:kt(this.type)?this.p1:Bt(this.p1,this.p0)},this},Ct.prototype.pointAt=function(t){return vt.linearTransitionBetweenPoints(this.p0,this.p1,t)};var Mt={instance:function(t){return new Tt(t)},isTypePath:Dt,animatePathTo:function(t){var e=this,r=t.duration,i=t.ease,n=t.end,o=t.loop,a=t.direction,s=t.d||e.attr.d,h=0;if(e.arrayStack=[],!s)throw Error("Path Not defined");for(var c=yt.sequenceChain(),l=Dt(s)?s:new Tt(s),d=l.stackGroup.reduce((function(t,e){return t=t.concat(e)}),[]),f=[],u=function(t){if("Z"===d[t].type||"z"===d[t].type)f.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,render:new Ct(d[t].type,d[t].p0,d[0].p0,d[t].segmentLength),length:d[t].length}),h+=0;else if(-1!==["V","v","H","h","L","l"].indexOf(d[t].type))f.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,render:new Ct(d[t].type,d[t].p0,d[t].p1,d[t].length),length:d[t].length}),h+=d[t].length;else if("Q"===d[t].type||"q"===d[t].type)f.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,render:new St(d[t].type,d[t].p0,d[t].cntrl1,d[t].p1,d[t].length),length:d[t].length}),h+=d[t].length;else if("C"===d[t].type||"S"===d[t].type||"c"===d[t].type||"s"===d[t].type){var r=vt.cubicBezierCoefficients(d[t]);f.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,co:r,render:new Et(d[t].type,d[t].p0,d[t].cntrl1,d[t].cntrl2,r,d[t].length),length:d[t].length}),h+=d[t].length}else"M"!==d[t].type&&"m"!==d[t].type||(f.push({run:function(){l.stack.length=this.id+1,l.stack[this.id]={type:"M",p0:d[t].p0,length:0,pointAt:function(t){return this.p0}}},target:e,id:t,length:0}),h+=0)},p=0;p<d.length;p+=1)u(p);return f.forEach((function(t){t.duration=t.length/h*r})),c.add(f).ease(i).loop(o||0).direction(a||"default"),"function"==typeof n&&c.end(n.bind(e)),c.commit(),this},morphTo:function(t){var e=this,r=t.duration,i=t.ease,n=t.loop?t.loop:0,o=t.direction?t.direction:"default",a=t.attr.d?t.attr.d:e.attr.d,s=Dt(e.attr.d)?e.attr.d.stackGroup:new Tt(e.attr.d).stackGroup,h=Dt(a)?a.stackGroup:new Tt(a).stackGroup,c=[];e.arrayStack=[],s.length>1&&(s=s.sort((function(t,e){return e.segmentLength-t.segmentLength}))),h.length>1&&(h=h.sort((function(t,e){return e.segmentLength-t.segmentLength})));var l=s.length>h.length?s.length:h.length;w(f(s[0]),f(h[0]));for(var d=1;d<l;d+=1)s[d]&&w(f(s[d]),[{type:"M",p0:s[d][0].p0}]),h[d]&&w([{type:"M",p0:h[d][0].p0}],f(h[d]));function f(t){if(t.length){for(var e=t,r=[],i=0;i<e.length;i+=1)if(-1!==["M","C","S","Q"].indexOf(e[i].type))r.push(e[i]);else if(-1!==["V","H","L","Z"].indexOf(e[i].type)){var n={x:(e[i].p0.x+e[i].p1.x)/2,y:(e[i].p0.y+e[i].p1.y)/2};r.push({p0:e[i].p0,cntrl1:n,cntrl2:n,p1:e[i].p1,type:"C",length:e[i].length})}return r}}function u(t,e){c.push({run:function(t,e){var r=this,i=r.ctrl1Transition(e),n=r.ctrl2Transition(e),o=r.destTransition(e);t.c(!0,{x:i.x,y:i.y},{x:n.x,y:n.y},{x:o.x,y:o.y})},srcTransition:vt.linearTransitionBetweenPoints.bind(null,t.p0,e.p0),ctrl1Transition:vt.linearTransitionBetweenPoints.bind(null,t.cntrl1,e.cntrl1),ctrl2Transition:vt.linearTransitionBetweenPoints.bind(null,t.cntrl2,e.cntrl2),destTransition:vt.linearTransitionBetweenPoints.bind(null,t.p1,e.p1)})}function p(t,e){if(t.length===e)return t;for(var r=t.reduce((function(t,e){return t+e.length}),0),i=[],n=0;n<t.length;n+=1){var o=t[n].length,a=Math.floor(e/r*o);if(a<=1)i.push(t[n]);else{for(var s=t[n],h=void 0;a>1;){var c=s;h=y([c.p0,c.cntrl1,c.cntrl2,c.p1].slice(0),1/a),i.push({p0:c.p0,cntrl1:h.b1[0],cntrl2:h.b1[1],p1:h.b1[2],type:"C"}),s={p0:h.b1[2],cntrl1:h.b2[0],cntrl2:h.b2[1],p1:h.b2[2],type:"C"},a-=1}i.push(s)}}return i}function y(t,e){for(var r,i,n,o=[],a=t;a.length>0;){for(var s=0;s<a.length-1;s+=1)o.unshift(a[s]),a[s]=(r=a[s],i=a[s+1],n=e,{x:r.x+(i.x-r.x)*(void 0!==n?n:.5),y:r.y+(i.y-r.y)*(void 0!==n?n:.5)});o.unshift(a.pop())}return{b1:[{x:o[5].x,y:o[5].y},{x:o[2].x,y:o[2].y},{x:o[0].x,y:o[0].y}],b2:[{x:o[1].x,y:o[1].y},{x:o[3].x,y:o[3].y},{x:o[6].x,y:o[6].y}]}}function x(t){for(var e=0,r=0;r<t.length;r+=1)"M"!==t[r].type&&(e+=(t[r].p1.x-t[r].p0.x)*(t[r].p1.y+t[r].p0.y));return e}function v(t){var e=t.reverse(),r=[{type:"M",p0:e[0].p1}];return e.forEach((function(t){if("C"===t.type){var e=t,i=e.p0,n=e.cntrl1;e.p0=t.p1,e.p1=i,e.cntrl1=t.cntrl2,e.cntrl2=n,r.push(e)}})),r}function m(t){var e=0,r=0,i=0,n=0;return t.forEach((function(t){t.p0&&(e+=t.p0.x,r+=t.p0.y,i+=1,n+=1),t.p1&&(e+=t.p1.x,r+=t.p1.y,i+=1,n+=1)})),{x:e/i,y:r/n}}function g(t,e){return e.x>=t.x&&e.y<=t.y?1:e.x<=t.x&&e.y<=t.y?2:e.x<=t.x&&e.y>=t.y?3:4}function b(t,e){if(e<=0)return t;var r=t,i=r.splice(0,e);return i.shift(),(r=r.concat(i)).unshift({type:"M",p0:r[0].p0}),r.push({type:"M",p0:r[0].p0}),r}function w(t,e){var r,i,n=t.length>e.length?t.length:e.length;e.length>2&&t.length>2?(n>50?n+=30:n=n>=20?n+15:n+4,r=p(t,n),i=p(e,n)):(r=t,i=e),x(r)<0&&(r=v(r)),x(i)<0&&(i=v(i));var o=function(t,e){for(var r=m(t),i=m(e),n=t,o=e,a=0;a<t.length;a+=1)n[a].quad=g(r,t[a].p0);for(var s=0;s<e.length;s+=1)o[s].quad=g(i,e[s].p0);var h=0;return t.forEach((function(t,e){var i=vt.getDistance(t.p0,r);1===t.quad&&i>=h&&(h=i)})),h=0,e.forEach((function(t,e){var r=vt.getDistance(t.p0,i);1===t.quad&&r>h&&(h=r)})),{src:b(t,0),dest:b(e,0),srcCentroid:r,destCentroid:i}}(r,i);r=o.src.length>1?o.src:[{type:"M",p0:o.destCentroid}];for(var a,s,h=(i=o.dest.length>1?o.dest:[{type:"M",p0:o.srcCentroid}]).length<r.length?r.length:i.length,l=0;l<r.length;l+=1)r[l].index=l;for(var d=0;d<i.length;d+=1)i[d].index=d;for(var f=0;f<h;f+=1){var y=r[r.length-1].p0?r[r.length-1].p0:r[r.length-1].p1,w=i[i.length-1].p0?i[i.length-1].p0:i[i.length-1].p1,B=r[f]?r[f]:{type:"C",p0:y,p1:y,cntrl1:y,cntrl2:y,length:0},A=i[f]?i[f]:{type:"C",p0:w,p1:w,cntrl1:w,cntrl2:w,length:0};"M"===B.type&&"M"===A.type?(a=B,s=A,c.push({run:function(t,e){var r=this.pointTansition(e);t.m(!0,{x:r.x,y:r.y})},pointTansition:vt.linearTransitionBetweenPoints.bind(null,a.p0,s.p0)})):"M"===B.type||"M"===A.type?"M"===B.type?u({type:"C",p0:B.p0,p1:B.p0,cntrl1:B.p0,cntrl2:B.p0,length:0},A):u(B,{type:"C",p0:A.p0,p1:A.p0,cntrl1:A.p0,cntrl2:A.p0,length:0}):u(B,A)}}mt.add("morph_"+(xt+=1),{run:function(t){for(var r=new Tt,i=0,n=c.length;i<n;i++)c[i].run(r,t);e.setAttr("d",r)},target:e,duration:r,loop:n,direction:o},gt(i))}},_t={AliceBlue:"f0f8ff",AntiqueWhite:"faebd7",Aqua:"00ffff",Aquamarine:"7fffd4",Azure:"f0ffff",Beige:"f5f5dc",Bisque:"ffe4c4",Black:"000000",BlanchedAlmond:"ffebcd",Blue:"0000ff",BlueViolet:"8a2be2",Brown:"a52a2a",BurlyWood:"deb887",CadetBlue:"5f9ea0",Chartreuse:"7fff00",Chocolate:"d2691e",Coral:"ff7f50",CornflowerBlue:"6495ed",Cornsilk:"fff8dc",Crimson:"dc143c",Cyan:"00ffff",DarkBlue:"00008b",DarkCyan:"008b8b",DarkGoldenRod:"b8860b",DarkGray:"a9a9a9",DarkGrey:"a9a9a9",DarkGreen:"006400",DarkKhaki:"bdb76b",DarkMagenta:"8b008b",DarkOliveGreen:"556b2f",DarkOrange:"ff8c00",DarkOrchid:"9932cc",DarkRed:"8b0000",DarkSalmon:"e9967a",DarkSeaGreen:"8fbc8f",DarkSlateBlue:"483d8b",DarkSlateGray:"2f4f4f",DarkSlateGrey:"2f4f4f",DarkTurquoise:"00ced1",DarkViolet:"9400d3",DeepPink:"ff1493",DeepSkyBlue:"00bfff",DimGray:"696969",DimGrey:"696969",DodgerBlue:"1e90ff",FireBrick:"b22222",FloralWhite:"fffaf0",ForestGreen:"228b22",Fuchsia:"ff00ff",Gainsboro:"dcdcdc",GhostWhite:"f8f8ff",Gold:"ffd700",GoldenRod:"daa520",Gray:"808080",Grey:"808080",Green:"008000",GreenYellow:"adff2f",HoneyDew:"f0fff0",HotPink:"ff69b4",IndianRed:"cd5c5c",Indigo:"4b0082",Ivory:"fffff0",Khaki:"f0e68c",Lavender:"e6e6fa",LavenderBlush:"fff0f5",LawnGreen:"7cfc00",LemonChiffon:"fffacd",LightBlue:"add8e6",LightCoral:"f08080",LightCyan:"e0ffff",LightGoldenRodYellow:"fafad2",LightGray:"d3d3d3",LightGrey:"d3d3d3",LightGreen:"90ee90",LightPink:"ffb6c1",LightSalmon:"ffa07a",LightSeaGreen:"20b2aa",LightSkyBlue:"87cefa",LightSlateGray:"778899",LightSlateGrey:"778899",LightSteelBlue:"b0c4de",LightYellow:"ffffe0",Lime:"00ff00",LimeGreen:"32cd32",Linen:"faf0e6",Magenta:"ff00ff",Maroon:"800000",MediumAquaMarine:"66cdaa",MediumBlue:"0000cd",MediumOrchid:"ba55d3",MediumPurple:"9370db",MediumSeaGreen:"3cb371",MediumSlateBlue:"7b68ee",MediumSpringGreen:"00fa9a",MediumTurquoise:"48d1cc",MediumVioletRed:"c71585",MidnightBlue:"191970",MintCream:"f5fffa",MistyRose:"ffe4e1",Moccasin:"ffe4b5",NavajoWhite:"ffdead",Navy:"000080",OldLace:"fdf5e6",Olive:"808000",OliveDrab:"6b8e23",Orange:"ffa500",OrangeRed:"ff4500",Orchid:"da70d6",PaleGoldenRod:"eee8aa",PaleGreen:"98fb98",PaleTurquoise:"afeeee",PaleVioletRed:"db7093",PapayaWhip:"ffefd5",PeachPuff:"ffdab9",Peru:"cd853f",Pink:"ffc0cb",Plum:"dda0dd",PowderBlue:"b0e0e6",Purple:"800080",RebeccaPurple:"663399",Red:"ff0000",RosyBrown:"bc8f8f",RoyalBlue:"4169e1",SaddleBrown:"8b4513",Salmon:"fa8072",SandyBrown:"f4a460",SeaGreen:"2e8b57",SeaShell:"fff5ee",Sienna:"a0522d",Silver:"c0c0c0",SkyBlue:"87ceeb",SlateBlue:"6a5acd",SlateGray:"708090",SlateGrey:"708090",Snow:"fffafa",SpringGreen:"00ff7f",SteelBlue:"4682b4",Tan:"d2b48c",Teal:"008080",Thistle:"d8bfd8",Tomato:"ff6347",Turquoise:"40e0d0",Violet:"ee82ee",Wheat:"f5deb3",White:"ffffff",WhiteSmoke:"f5f5f5",Yellow:"ffff00",YellowGreen:"9acd32"},zt=Math.round,It="rgba(0,0,0,0)";function Pt(t,e,r,i){this.r=t,this.g=e,this.b=r,this.a=void 0===i?255:i,this.rgba="rgba("+t+","+e+","+r+","+i+")"}function Ot(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,r,i){return e+e+r+r+i+i}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new Pt(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255)}function Lt(t){var e,r,i,n,o,a,s,h=t.replace(/[^0-9.,]+/g,"").split(",").map((function(t){return parseFloat(t)}));if(o=h[0]/360,a=h[1]/100,s=h[2]/100,n=h[3],0===a)e=r=i=s;else{var c=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},l=s<.5?s*(1+a):s+a-s*a,d=2*s-l;e=255*c(d,l,o+1/3),r=255*c(d,l,o),i=255*c(d,l,o-1/3)}return new Pt(e,r,i,n)}function Nt(t){return t instanceof Pt?t:t.startsWith("#")?Ot(t):t.startsWith("rgb")?function(t){for(var e=t.replace(/[^0-9.,]+/g,"").split(","),r={},i=["r","g","b","a"],n=0;n<e.length;n+=1)r[i[n]]=parseFloat(e[n]);return new Pt(r.r,r.g,r.b,r.a)}(t):t.startsWith("hsl")?Lt(t):{r:0,g:0,b:0,a:255}}Pt.prototype.normalize=function(){return this.normalFlag||(this.r/=255,this.g/=255,this.b/=255,this.a/=255,this.normalFlag=!0),this};var Ft,Rt={nameToHex:function(t){return _t[t]?"#"+_t[t]:"#000"},hexToRgb:Ot,rgbToHex:function(t){var e=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")).split(",");return"#"+((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)},hslToRgb:Lt,transition:function(t,e){return e=e||It,t=Nt(t=t||It),e=Nt(e),function(r){return new Pt(zt(t.r+(e.r-t.r)*r),zt(t.g+(e.g-t.g)*r),zt(t.b+(e.b-t.b)*r),zt(t.a+(e.a-t.a)*r))}},colorToRGB:Nt,rgba:function(t,e,r,i){return new Pt(t,e,r,i)},isTypeColor:function(t){return t instanceof Pt||t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl")},RGBAInstanceCheck:function(t){return t instanceof Pt}};function jt(t){this.vDom=t,this.disable=!1,this.dragNode=null,this.touchNode=null,this.wheelNode=null,this.pointers=[]}function Xt(t,e,r){if(t.dom.parent)return t.dom.parent.events[e]&&t.dom.parent.events[e](t.dom.parent,r),Xt(t.dom.parent,e,r)}jt.prototype.getNode=function(t){},jt.prototype.addPointer=function(t){this.pointers.push(t)},jt.prototype.removePointer=function(t){for(var e=this,r=this.pointers,i=-1,n=0;n<r.length;n++)if(t.pointerId===r[n].pointerId){i=n;break}-1!==i&&(e.pointers=[],e.distance=0,this.pointerNode&&this.pointerNode.node.events.zoom&&this.pointerNode.node.events.zoom.onZoomEnd(this.pointerNode.node,t,e))},jt.prototype.clickCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"click")},jt.prototype.dblclickCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"dblclick")},jt.prototype.pointerdownCheck=function(t){var e=Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"pointerdown");!e||this.pointerNode&&this.pointerNode.node===e?this.pointerNode&&(this.pointerNode.clickCounter+=1):this.pointerNode={node:e,clickCounter:1,dragCounter:0},e&&(e.events.zoom||e.events.drag)?(e.events.zoom&&e.events.zoom.panFlag&&e.events.zoom.panExecute(e,t,"pointerdown",this),e.events.drag&&e.events.drag.execute(e,t,"pointerdown",this)):e&&"touch"===t.pointerType&&e.events.mouseover.call(e,t)},jt.prototype.pointermoveCheck=function(t){var e=this,r=this.pointerNode?this.pointerNode.node:null;r?(this.pointerNode.dragCounter+=1,r.events.zoom&&(r.events.zoom.panFlag&&r.events.zoom.panExecute(r,t,"pointermove",e),r.events.zoom.zoomPinch(r,t,e)),r.events.drag&&r.events.drag.execute(r,t,"pointermove",e),r.events.mousemove&&r.events.mousemove.call(r,t)):r&&"touch"===t.pointerType&&r.events.mousemove.call(r,t),t.preventDefault()},jt.prototype.pointerupCheck=function(t){var e=this,r=this.pointerNode?this.pointerNode.node:null;r&&(r.events.drag&&r.events.drag.execute(r,t,"pointerup",e),r.events.zoom&&r.events.zoom.panFlag&&r.events.zoom.panExecute(r,t,"pointerup",e),this.pointerNode.dragCounter<=2||"touch"===t.pointerType&&this.pointerNode.dragCounter<=5?(r.events.click&&r.events.click.call(r,t),Xt(r,"click",t),2===this.pointerNode.clickCounter&&(r.events.dblclick&&r.events.dblclick.call(r,t),Xt(r,"dblclick",t)),Ft&&clearTimeout(Ft),Ft=setTimeout((function(){e.pointerNode=null,Ft=null}),200)):this.pointerNode=null,"touch"===t.pointerType&&r.events.mouseup.call(r,t))},jt.prototype.mousedownCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousedown")},jt.prototype.mousemoveCheck=function(t){var e=Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousemove");this.selectedNode&&this.selectedNode!==e&&(this.selectedNode.events.mouseout&&this.selectedNode.events.mouseout.call(this.selectedNode,t),this.selectedNode.events.mouseleave&&this.selectedNode.events.mouseleave.call(this.selectedNode,t)),e&&(e.events.mouseover||e.events.mousein)&&this.selectedNode!==e&&(e.events.mouseover&&e.events.mouseover.call(e,t),e.events.mousein&&e.events.mousein.call(e,t)),this.selectedNode=e,t.preventDefault()},jt.prototype.mouseupCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseup")},jt.prototype.mouseleaveCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseleave")},jt.prototype.contextmenuCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"contextmenu")},jt.prototype.touchstartCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"touchstart")},jt.prototype.touchendCheck=function(t){Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"touchend")},jt.prototype.touchmoveCheck=function(t){var e=t.touches;0!==e.length&&Ut([this.vDom],{x:e[0].clientX,y:e[0].clientY},t,"touchmove")},jt.prototype.touchcancelCheck=function(t){Ut([this.vDom],{x:t.x,y:t.y},t,"touchcacel")};var Gt=0,Yt=0;function Ut(t,e,r,i){for(var n,o,a=t.length-1;a>=0;a-=1){var s=t[a],h={x:e.x,y:e.y};if(s.bbox&&(Ht(s,h),s.in({x:h.x,y:h.y})&&(s.children&&s.children.length>0?(o=Ut(s.children,{x:h.x,y:h.y},r,i))&&(n=o):n=s,s.events[i]&&"function"==typeof s.events[i]&&s.events[i](r),n)))break}return n||"rootNode"!==s.attr.id||(n=s,s.events[i]&&"function"==typeof s.events[i]&&s.events[i](r)),n}function Ht(t,e){var r,i=0,n=0,o=1,a=1,s=e;if(t.attr.transform&&t.attr.transform.translate&&(i=(r=t.attr.transform.translate)[0],n=r[1],s.x-=i,s.y-=n),t.attr.transform&&t.attr.transform.scale&&(o=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,a=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:o,s.x/=o,s.y/=a),t.attr.transform&&t.attr.transform.rotate){var h=t.attr.transform.rotate[0],c={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},l=s.x,d=s.y,f=c.x,u=c.y,p=Math.PI/180*h,y=Math.cos(p),x=Math.sin(p);s.x=y*(l-f)+x*(d-u)+f,s.y=y*(d-u)-x*(l-f)+u}}jt.prototype.wheelEventCheck=function(t){var e=this;if(this.wheelNode)this.wheelNode.events.zoom.zoomExecute(this.wheelNode,t,e),Gt+=1,this.wheelHndl&&(clearTimeout(this.wheelHndl),this.wheelHndl=null,Yt=Gt),this.wheelHndl=setTimeout((function(){Yt!==Gt?Yt=Gt:(e.wheelHndl=null,e.wheelNode.events.zoom.onZoomEnd(e.wheelNode,t,e),e.wheelNode=null,Gt=0)}),100);else{var r=Ut([this.vDom],{x:t.offsetX,y:t.offsetY},t,"wheel");(r=r||this.vDom)&&r.events.zoom&&(r.events.zoom.disableWheel||(r.events.zoom.zoomExecute(r,t,e),this.wheelNode=r))}};var Vt,qt=[],Zt="ResizeObserver loop completed with undelivered notifications.";!function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(Vt||(Vt={}));var Wt,Qt=function(){function t(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return t.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),$t=function(t){return t instanceof SVGElement&&"getBBox"in t},Jt=function(t){if($t(t)){var e=t.getBBox(),r=e.width,i=e.height;return!r&&!i}var n=t,o=n.offsetWidth,a=n.offsetHeight;return!(o||a||t.getClientRects().length)},Kt=function(t){var e,r,i=null===(r=null===(e=t)||void 0===e?void 0:e.ownerDocument)||void 0===r?void 0:r.defaultView;return!!(i&&t instanceof i.Element)},te="undefined"!=typeof window?window:{},ee=new WeakMap,re=/auto|scroll/,ie=/^tb|vertical/,ne=/msie|trident/i.test(te.navigator&&te.navigator.userAgent),oe=function(t){return parseFloat(t||"0")},ae=function(t,e,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=!1),Object.freeze({inlineSize:(r?e:t)||0,blockSize:(r?t:e)||0})},se=Object.freeze({devicePixelContentBoxSize:ae(),borderBoxSize:ae(),contentBoxSize:ae(),contentRect:new Qt(0,0,0,0)}),he=function(t,e){if(void 0===e&&(e=!1),ee.has(t)&&!e)return ee.get(t);if(Jt(t))return ee.set(t,se),se;var r=getComputedStyle(t),i=$t(t)&&t.ownerSVGElement&&t.getBBox(),n=!ne&&"border-box"===r.boxSizing,o=ie.test(r.writingMode||""),a=!i&&re.test(r.overflowY||""),s=!i&&re.test(r.overflowX||""),h=i?0:oe(r.paddingTop),c=i?0:oe(r.paddingRight),l=i?0:oe(r.paddingBottom),d=i?0:oe(r.paddingLeft),f=i?0:oe(r.borderTopWidth),u=i?0:oe(r.borderRightWidth),p=i?0:oe(r.borderBottomWidth),y=d+c,x=h+l,v=(i?0:oe(r.borderLeftWidth))+u,m=f+p,g=s?t.offsetHeight-m-t.clientHeight:0,b=a?t.offsetWidth-v-t.clientWidth:0,w=n?y+v:0,B=n?x+m:0,A=i?i.width:oe(r.width)-w-b,T=i?i.height:oe(r.height)-B-g,k=A+y+b+v,E=T+x+g+m,S=Object.freeze({devicePixelContentBoxSize:ae(Math.round(A*devicePixelRatio),Math.round(T*devicePixelRatio),o),borderBoxSize:ae(k,E,o),contentBoxSize:ae(A,T,o),contentRect:new Qt(d,h,A,T)});return ee.set(t,S),S},ce=function(t,e,r){var i=he(t,r),n=i.borderBoxSize,o=i.contentBoxSize,a=i.devicePixelContentBoxSize;switch(e){case Vt.DEVICE_PIXEL_CONTENT_BOX:return a;case Vt.BORDER_BOX:return n;default:return o}},le=function(t){var e=he(t);this.target=t,this.contentRect=e.contentRect,this.borderBoxSize=[e.borderBoxSize],this.contentBoxSize=[e.contentBoxSize],this.devicePixelContentBoxSize=[e.devicePixelContentBoxSize]},de=function(t){if(Jt(t))return 1/0;for(var e=0,r=t.parentNode;r;)e+=1,r=r.parentNode;return e},fe=function(){var t=1/0,e=[];qt.forEach((function(r){if(0!==r.activeTargets.length){var i=[];r.activeTargets.forEach((function(e){var r=new le(e.target),n=de(e.target);i.push(r),e.lastReportedSize=ce(e.target,e.observedBox),n<t&&(t=n)})),e.push((function(){r.callback.call(r.observer,i,r.observer)})),r.activeTargets.splice(0,r.activeTargets.length)}}));for(var r=0,i=e;r<i.length;r++){(0,i[r])()}return t},ue=function(t){qt.forEach((function(e){e.activeTargets.splice(0,e.activeTargets.length),e.skippedTargets.splice(0,e.skippedTargets.length),e.observationTargets.forEach((function(r){r.isActive()&&(de(r.target)>t?e.activeTargets.push(r):e.skippedTargets.push(r))}))}))},pe=function(){var t=0;for(ue(t);qt.some((function(t){return t.activeTargets.length>0}));)t=fe(),ue(t);return qt.some((function(t){return t.skippedTargets.length>0}))&&function(){var t;"function"==typeof ErrorEvent?t=new ErrorEvent("error",{message:Zt}):((t=document.createEvent("Event")).initEvent("error",!1,!1),t.message=Zt),window.dispatchEvent(t)}(),t>0},ye=[],xe=function(t){if(!Wt){var e=0,r=document.createTextNode("");new MutationObserver((function(){return ye.splice(0).forEach((function(t){return t()}))})).observe(r,{characterData:!0}),Wt=function(){r.textContent=""+(e?e--:e++)}}ye.push(t),Wt()},ve=0,me={attributes:!0,characterData:!0,childList:!0,subtree:!0},ge=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],be=function(t){return void 0===t&&(t=0),Date.now()+t},we=!1,Be=new(function(){function t(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return t.prototype.run=function(t){var e=this;if(void 0===t&&(t=250),!we){we=!0;var r,i=be(t);r=function(){var r=!1;try{r=pe()}finally{if(we=!1,t=i-be(),!ve)return;r?e.run(1e3):t>0?e.run(t):e.start()}},xe((function(){requestAnimationFrame(r)}))}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,me)};document.body?e():te.addEventListener("DOMContentLoaded",e)},t.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),ge.forEach((function(e){return te.addEventListener(e,t.listener,!0)})))},t.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),ge.forEach((function(e){return te.removeEventListener(e,t.listener,!0)})),this.stopped=!0)},t}()),Ae=function(t){!ve&&t>0&&Be.start(),!(ve+=t)&&Be.stop()},Te=function(){function t(t,e){this.target=t,this.observedBox=e||Vt.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var t,e=ce(this.target,this.observedBox,!0);return t=this.target,$t(t)||function(t){switch(t.tagName){case"INPUT":if("image"!==t.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(t)||"inline"!==getComputedStyle(t).display||(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}(),ke=function(t,e){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=e},Ee=new WeakMap,Se=function(t,e){for(var r=0;r<t.length;r+=1)if(t[r].target===e)return r;return-1},Ce=function(){function t(){}return t.connect=function(t,e){var r=new ke(t,e);Ee.set(t,r)},t.observe=function(t,e,r){var i=Ee.get(t),n=0===i.observationTargets.length;Se(i.observationTargets,e)<0&&(n&&qt.push(i),i.observationTargets.push(new Te(e,r&&r.box)),Ae(1),Be.schedule())},t.unobserve=function(t,e){var r=Ee.get(t),i=Se(r.observationTargets,e),n=1===r.observationTargets.length;i>=0&&(n&&qt.splice(qt.indexOf(r),1),r.observationTargets.splice(i,1),Ae(-1))},t.disconnect=function(t){var e=this,r=Ee.get(t);r.observationTargets.slice().forEach((function(r){return e.unobserve(t,r.target)})),r.activeTargets.splice(0,r.activeTargets.length)},t}(),De=function(){function t(t){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof t)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Ce.connect(this,t)}return t.prototype.observe=function(t,e){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Kt(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Ce.observe(this,t,e)},t.prototype.unobserve=function(t){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Kt(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Ce.unobserve(this,t)},t.prototype.disconnect=function(){Ce.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}(),Me=0,_e=F,ze=J,Ie=x,Pe=window.ResizeObserver||De;var Oe=function(t,e,r){var i=[],n=t.attr.transform;return"function"==typeof r?function(i){t[e](r.call(t,i))}:(r.forEach((function(t,r){var o;o=n[e]&&void 0!==n[e][r]?n[e][r]:"scale"===e?1:0,i.push(_e.intermediateValue.bind(null,o,t))})),function(r){t[e](i.map((function(t){return t(r)})))})},Le=function(t,e,r){var i,n,o;if("function"==typeof r)return function(i){t.setStyle(e,r.call(t,t.dataObj,i))};if(i=t.style[e],isNaN(r)){if(Rt.isTypeColor(r)){var a=Rt.transition(i,r);return function(r){t.setStyle(e,a(r))}}i=i.match(/(\d+)/g),o=r.match(/(\d+)/g),n=r.match(/\D+$/),i=parseInt(i.length>0?i[0]:0,10),o=parseInt(o.length>0?o[0]:0,10),n=n.length>0?n[0]:"px"}else i=void 0!==t.style[e]?t.style[e]:1,o=r,n=0;return function(r){t.setStyle(e,_e.intermediateValue(i,o,r)+n)}},Ne=function(t,e){var r,i=e.attr?e.attr:{},n=e.style?e.style:{},o=[];if("function"!=typeof i){var a=function(n){if("transform"!==n){var a=i[n];"function"==typeof a?o[o.length]=function(e){t.setAttr(n,a.call(t,e))}:"d"===n?t.morphTo(e):o[o.length]=function(t,e,r){var i=t.attr[e];return function(n){t.setAttr(e,_e.intermediateValue(i,r,n))}}(t,n,i[n])}else if("function"==typeof(r=i[n]))o[o.length]=function(t,e,r){return function(i){t.setAttr(e,r.call(t,i))}}(t,n,r);else{t.attr.transform||(t.attr.transform={});for(var s=Object.keys(i.transform),h=0,c=s.length;h<c;h+=1)o[o.length]=Oe(t,s[h],i.transform[s[h]])}};for(var s in i)a(s)}else o[o.length]=i.bind(t);if("function"!=typeof n)for(var h in n)o[o.length]=Le(t,h,n[h]);else o[o.length]=n.bind(t);return{run:function(t){for(var e=0,r=o.length;e<r;e+=1)o[e](t)},target:t,duration:e.duration,delay:e.delay?e.delay:0,end:e.end?e.end.bind(t,t.dataObj):null,loop:e.loop?e.loop:0,direction:e.direction?e.direction:"default",ease:e.ease?e.ease:"default"}};function Fe(t,e,r){for(var i=t.map(r),n={new:[],update:[],old:[]},o=0;o<e.length;o+=1){var a=i.indexOf(r(e[o].dataObj,o));-1!==a?(e[o].dataObj=t[a],n.update.push(e[o]),i[a]=null):n.old.push(e[o])}return n.new=t.filter((function(t,e){var n=i.indexOf(r(t,e));return-1!==n&&(i[n]=null,!0)})),n}var Re={};Re.push={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var e=0,r=t.length;e<r;e++)this.data.push(t[e]);if(this.config.action.enter){var i={};this.selector.split(",").forEach((function(e){i[e]=t})),this.config.action.enter.call(this,i)}},enumerable:!1,configurable:!1,writable:!1},Re.pop={value:function(){var t=this,e=this.data.pop();if(this.config.action.exit){var r={};this.selector.split(",").forEach((function(i){r[i]=t.fetchEls(i,[e])})),this.config.action.exit.call(this,r)}},enumerable:!1,configurable:!1,writable:!1},Re.remove={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var e=this,r=0,i=t.length;r<i;r++)-1!==this.data.indexOf(t[r])&&this.data.splice(this.data.indexOf(t[r]),1);if(this.config.action.exit){var n={};this.selector.split(",").forEach((function(r){n[r]=e.fetchEls(r,t)})),this.config.action.exit.call(this,n)}},enumerable:!1,configurable:!0,writable:!1},Re.update={value:function(){var t=this;if(this.config.action.update){var e={};this.selector.split(",").forEach((function(r){e[r]=t.fetchEls(r,t.data)})),this.config.action.update.call(this,e)}},enumerable:!1,configurable:!0,writable:!1},Re.join={value:function(t){this.data=t,Xe.call(this,t,this.selector,this.config)},enumerable:!1,configurable:!0,writable:!1};var je=function(){};function Xe(t,e,r){var i=this,n=e.split(","),o=r.joinOn,a={new:{},update:{},old:{}};o||(o=function(t,e){return e});for(var s=0,h=n.length;s<h;s++){var c=n[s],l=Fe(t,i.fetchEls(c).stack,o);a.new[c]=l.new,a.update[c]=(new Ye).wrapper(l.update),a.old[c]=(new Ye).wrapper(l.old)}return r.action&&(r.action.enter&&r.action.enter.call(i,a.new),r.action.exit&&r.action.exit.call(i,a.old),r.action.update&&r.action.update.call(i,a.update)),Re.config={value:r,enumerable:!1,configurable:!0,writable:!0},Re.selector={value:e,enumerable:!1,configurable:!0,writable:!1},Re.data={value:t,enumerable:!1,configurable:!0,writable:!0},Object.create(i,Re)}function Ge(t,e,r){var i,n={};for(i in t)"end"!==i&&("function"==typeof t[i]?n[i]=t[i].call(e,e.dataObj,r):n[i]=t[i]);return n}je.prototype.getAttr=function(t){return this.attr[t]},je.prototype.getStyle=function(t){return this.style[t]},je.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},je.prototype.fetchEls=function(t,e){var r=[],i=new Ye;if(this.children.length>0)if("."===t.charAt(0)){var n=t.substring(1,t.length);this.children.forEach((function(t){if(t){var i=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.class===n,o=!e&&t.attr.class===n;(i||o)&&r.push(t)}}))}else if("#"===t.charAt(0)){var o=t.substring(1,t.length);this.children.every((function(t){if(t){var i=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.id===o,n=!e&&t.attr.id===o;return!i&&!n||(r.push(t),!1)}}))}else t="group"===t?"g":t,this.children.forEach((function(i){if(i){var n=e&&i.dataObj&&-1!==e.indexOf(i.dataObj)&&i.nodeName===t,o=!e&&i.nodeName===t;(n||o)&&r.push(i)}}));return i.wrapper(r)},je.prototype.fetchEl=function(t,e){var r;if(this.children.length>0)if("."===t.charAt(0)){var i=t.substring(1,t.length);this.children.every((function(t){if(t){var n=e&&t.dataObj&&e===t.dataObj&&t.attr.class===i,o=!e&&t.attr.class===i;return!n&&!o||(r=t,!1)}}))}else if("#"===t.charAt(0)){var n=t.substring(1,t.length);this.children.every((function(t){if(t){var i=e&&t.dataObj&&e===t.dataObj&&t.attr.id===n,o=!e&&t.attr.id===n;return!i&&!o||(r=t,!1)}}))}else t="group"===t?"g":t,this.children.forEach((function(i){if(i){var n=e&&i.dataObj&&e===i.dataObj&&i.nodeName===t,o=!e&&i.nodeName===t;(n||o)&&(r=i)}}));return r},je.prototype.join=Xe,je.prototype.data=function(t){return t?(this.dataObj=t,this):this.dataObj},je.prototype.interrupt=function(){if(this.animList&&this.animList.length>0)for(var t=this.animList.length-1;t>=0;t--)Ie.remove(this.animList[t]);return this.animList=[],this},je.prototype.animateTo=function(t){return Ie.add(Me+=1,Ne(this,t),ze(t.ease)),this},je.prototype.animateExe=function(t){return Ne(this,t)};function Ye(t,e,r,i){var n,o,a=this;e||(e=[]);var s=r&&r.attr?Object.keys(r.attr):[],h=r&&r.style?Object.keys(r.style):[],c=!r||(void 0===r.bbox||r.bbox);return this.stack=e.map((function(e,l){for(var d,f=a.createNode(t.ctx,{el:r.el,bbox:c},i),u=0,p=h.length;u<p;u+=1)if(o=h[u],"function"==typeof r.style[o]){var y=r.style[o].call(f,e,l);f.setStyle(o,y)}else f.setStyle(o,r.style[o]);for(var x=0,v=s.length;x<v;x+=1)if("transform"!==(o=s[x]))if("function"==typeof r.attr[o]){var m=r.attr[o].call(f,e,l);f.setAttr(o,m)}else f.setAttr(o,r.attr[o]);else for(var g in"function"==typeof r.attr.transform?n=r.attr[o].call(f,e,l):(d=r.attr,n=d.transform),n)f[g](n[g]);return f.dataObj=e,f})),this}Ye.prototype={createEls:function(t,e){for(var r,i=[],n=t,o=0,a=this.stack.length;o<a;o+=1){var s={};if(r=this.stack[o],"function"==typeof t&&(n=t.call(r,r.dataObj,o)),"function"==typeof e)s=e.call(r,r.dataObj,o);else for(var h=Object.keys(e),c=0,l=h.length;c<l;c+=1){var d=h[c];s[d]=e[d]}i.push(r.createEls(n,s))}var f=new Ye;return f.wrapper(i),f},createEl:function(t){for(var e,r=[],i=0,n=this.stack.length;i<n;i+=1){var o={};if(e=this.stack[i],"function"==typeof t)o=t.call(e,e.dataObj,i);else for(var a=Object.keys(t),s=0,h=a.length;s<h;s+=1){var c=a[s];"object"!=typeof t[c]?o[c]=t[c]:o[c]=JSON.parse(JSON.stringify(t[c]))}r.push(e.createEl(o))}var l=new Ye;return l.wrapper(r),l},forEach:function(t){for(var e=0,r=this.stack.length;e<r;e+=1)t.call(this.stack[e],this.stack[e].dataObj,e);return this},setAttr:function(t,e){for(var r,i=arguments,n=0,o=this.stack.length;n<o;n+=1)if(r=this.stack[n],i.length>1)"function"==typeof e?r.setAttr(t,e.call(r,r.dataObj,n)):r.setAttr(t,e);else if("function"==typeof t)r.setAttr(t.call(r,r.dataObj,n));else for(var a=Object.keys(t),s=0,h=a.length;s<h;s+=1){var c=a[s];"function"==typeof t[c]?r.setAttr(c,t[c].call(r,r.dataObj,n)):r.setAttr(c,t[c])}return this},fetchEls:function(t,e){for(var r,i=[],n=0;n<this.stack.length;n+=1)r=this.stack[n],i.push(r.fetchEls(t,e));var o=new Ye;return o.wrapper(i),o},setStyle:function(t,e){for(var r,i=arguments,n=0,o=this.stack.length;n<o;n+=1)if(r=this.stack[n],i.length>1)"function"==typeof e?r.setStyle(t,e.call(r,r.dataObj,n)):r.setStyle(t,e);else{if("function"==typeof t)r.setStyle(t.call(r,r.dataObj,n));else for(var a=Object.keys(t),s=0,h=a.length;s<h;s+=1){var c=a[s];"function"==typeof t[c]?r.setStyle(c,t[c].call(r,r.dataObj,n)):r.setStyle(c,t[c])}"function"==typeof t?r.setStyle(t.call(r,r.dataObj,n)):r.setStyle(t)}return this},translate:function(t){for(var e,r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.translate(t.call(e,e.dataObj,r)):e.translate(t);return this},rotate:function(t){for(var e,r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.rotate(t.call(e,e.dataObj,r)):e.rotate(t);return this},scale:function(t){for(var e,r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.scale(t.call(e,e.dataObj,r)):e.scale(t);return this},exec:function(t){var e;if("function"==typeof t){for(var r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],t.call(e,e.dataObj,r);return this}},animateTo:function(t){for(var e,r,i=0;i<this.stack.length;i+=1)r={},r=Ge(t,e=this.stack[i],i),t.attr&&"function"!=typeof t.attr&&(r.attr=Ge(t.attr,e,i)),t.style&&"function"!=typeof t.style&&(r.style=Ge(t.style,e,i)),t.end&&(r.end=t.end),t.ease&&(r.ease=t.ease),e.animateTo(r);return this},animateExe:function(t){for(var e,r,i=[],n=0;n<this.stack.length;n+=1)r={},r=Ge(t,e=this.stack[n],n),t.attr&&"function"!=typeof t.attr&&(r.attr=Ge(t.attr,e,n)),t.style&&"function"!=typeof t.style&&(r.style=Ge(t.style,e,n)),t.end&&(r.end=t.end),t.ease&&(r.ease=t.ease),i.push(e.animateExe(r));return i},animatePathTo:function(t){for(var e,r=Object.keys(t),i=0,n=this.stack.length;i<n;i+=1){e=this.stack[i];for(var o={},a=0;a<r.length;a++){var s=t[r[a]];"function"==typeof s&&(s=s.call(e,e.dataObj,i)),o[r[a]]=s}e.animatePathTo(o)}return this},remove:function(){for(var t=0,e=this.stack.length;t<e;t+=1)this.stack[t].remove();return this},interrupt:function(){for(var t=0,e=this.stack.length;t<e;t+=1)this.stack[t].interrupt();return this},text:function(t){var e;if("function"!=typeof t)for(var r=0;r<this.stack.length;r+=1)(e=this.stack[r]).text(t);else for(var i=0;i<this.stack.length;i+=1)(e=this.stack[i]).text(t.call(e,e.dataObj,i));return this},join:function(t,e,r){for(var i,n=[],o=0;o<this.stack.length;o+=1)i=this.stack[o],n.push(i.join(t,e,r));var a=new Ye;return a.wrapper(n),a},on:function(t,e){for(var r=0,i=this.stack.length;r<i;r+=1)this.stack[r].on(t,e);return this}},Ye.prototype.createNode=function(){},Ye.prototype.wrapper=function(t){if(t)for(var e=0,r=t.length;e<r;e++){var i=t[e];this.stack.push(i)}return this};var Ue=function(t){var e=function(e){var r=t[e],i=r.contentRect;r.target.resizeHandler&&r.target.resizeHandler.forEach((function(t){t(i)}))};for(var r in t)e(r)};function He(t,e){t.ro||(t.ro=new Pe(Ue),t.ro.observe(t.container)),t.container.resizeHandler||(t.container.resizeHandler=[]),t.container.resizeHandler.push(e)}function Ve(t,e){if(t.container.resizeHandler){var r=t.container.resizeHandler.indexOf(e);-1!==r&&t.container.resizeHandler.splice(r,1),0===t.container.resizeHandler.length&&t.ro&&t.ro.disconnect()}}var qe=x,Ze=0;function We(){return Ze+=1}var Qe=function(){Ye.apply(this,arguments)};function $e(t,e){void 0===e&&(e={}),this.pDom=t;var r=e.id?e.id:"mask-"+Math.ceil(1e3*Math.random());this.id=e.id||r,e.id=r,this.defs||(this.defs=t.createEl({el:"defs"})),this.mask=this.defs.createEl({el:"mask",attr:e,style:{}})}function Je(t,e){void 0===e&&(e={}),this.pDom=t;var r=e.id?e.id:"clip-"+Math.ceil(1e3*Math.random());this.id=e.id||r,e.id=r,this.defs||(this.defs=t.createEl({el:"defs"})),this.clip=this.defs.createEl({el:"clipPath",attr:e,style:{}})}function Ke(t,e){void 0===e&&(e={}),this.pDom=t;var r=e.id?e.id:"pattern-"+Math.ceil(1e3*Math.random());this.id=e.id||r,e.id=r,this.defs||(this.defs=t.createEl({el:"defs"})),this.pattern=this.defs.createEl({el:"pattern",attr:e,style:{}})}function tr(t){var e="";for(var r in t)e+="rotate"===r?r+"("+t.rotate[0]+" "+(t.rotate[1]||0)+" "+(t.rotate[2]||0)+") ":r+"("+t[r].join(" ")+") ";return e}function er(t,e,r){this.config=t,this.type=e||"linear",this.pDom=r,this.defs=this.pDom.createEl({el:"defs"})}(Qe.prototype=new Ye).constructor=Qe,Qe.prototype.createNode=function(t,e,r){return nr(e,r)},$e.prototype.exe=function(){return"url(#"+this.id+")"},Je.prototype.exe=function(){return"url(#"+this.id+")"},Ke.prototype.exe=function(){return"url(#"+this.id+")"},er.prototype.exe=function(){return"url(#"+this.config.id+")"},er.prototype.linearGradient=function(){var t=this;return this.linearEl=this.defs.join([1],"linearGradient",{action:{enter:function(e){var r=this.createEls(e.linearGradient,{el:"linearGradient"}).setAttr({id:t.config.id,x1:t.config.x1+"%",y1:t.config.y1+"%",x2:t.config.x2+"%",y2:t.config.y2+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"});t.config.gradientTransform&&r.setAttr("gradientTransform",tr(t.config.gradientTransform))},exit:function(t){t.linearGradient.remove()},update:function(e){e.linearGradient.setAttr({id:t.config.id,x1:t.config.x1+"%",y1:t.config.y1+"%",x2:t.config.x2+"%",y2:t.config.y2+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"}),t.config.gradientTransform&&e.linearGradient.setAttr("gradientTransform",tr(t.config.gradientTransform))}}}),this.linearEl=this.linearEl.fetchEl("linearGradient"),this.linearEl.fetchEls("stop").remove(),this.linearEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:function(t,e){return t.value+"%"},"stop-color":function(t,e){return t.color}}}),this},er.prototype.radialGradient=function(){var t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.radialEl=this.defs.join([1],"radialGradient",{action:{enter:function(e){var r=this.createEls(e.radialGradient,{el:"radialGradient"}).setAttr({id:t.config.id,cx:t.config.innerCircle.x+"%",cy:t.config.innerCircle.y+"%",r:t.config.outerCircle.r+"%",fx:t.config.outerCircle.x+"%",fy:t.config.outerCircle.y+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"});t.config.gradientTransform&&r.setAttr("gradientTransform",tr(t.config.gradientTransform))},exit:function(t){t.radialGradient.remove()},update:function(e){e.radialGradient.setAttr({id:t.config.id,cx:t.config.innerCircle.x+"%",cy:t.config.innerCircle.y+"%",r:t.config.outerCircle.r+"%",fx:t.config.outerCircle.x+"%",fy:t.config.outerCircle.y+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"}),t.config.gradientTransform&&e.radialGradient.setAttr("gradientTransform",tr(t.config.gradientTransform))}}}),this.radialEl=this.radialEl.fetchEl("radialGradient"),this.radialEl.fetchEls("stop").remove(),this.radialEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:function(t,e){return t.value+"%"},"stop-color":function(t,e){return t.color}}}),this},er.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,"linear"===this.type?this.linearGradient():"radial"===this.type&&this.radialGradient())};var rr={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},ir=function(t){return document.createElementNS(rr.svg,t)};function nr(t,e){var r,i,n=null,o=t.el.indexOf(":");if(o>=0)r=t.el.slice(0,o),i=t.el.slice(o+1),n=document.createElementNS(rr[r],i);else switch(t.el){case"group":n=ir("g");break;default:n=ir(t.el)}var a=new or(n,t,We(),e);return t.dataObj&&(n.dataObj=t.dataObj),a}var or=function(t,e,r,i){this.dom=t,this.nodeName=t.nodeName,this.attr={},this.style={},this.changedAttribute={},this.changedStyles={},this.id=r,this.nodeType="svg",this.dom.nodeId=r,this.children=[],this.vDomIndex=i,this.events={},e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function ar(t,e){var r=e.indexOf(":"),i=t.changedAttribute[e];r>=0?t.dom.setAttributeNS(rr[e.slice(0,r)],e.slice(r+1),i):"text"===e?t.dom.textContent=i:"d"===e?Mt.isTypePath(i)?t.dom.setAttribute(e,i.fetchPathString()):t.dom.setAttribute(e,i):"onerror"===e||"onload"===e?t.dom[e]=function(e){i.call(t,e)}:t.dom.setAttribute(e,i)}function sr(t){var e="";for(var r in t.attr.transform)e+="rotate"===r?r+"("+t.attr.transform.rotate[0]+" "+(t.attr.transform.rotate[1]||0)+" "+(t.attr.transform.rotate[2]||0)+") ":r+"("+t.attr.transform[r].join(" ")+") ";t.dom.setAttribute("transform",e)}function hr(t){if("[object Array]"===Object.prototype.toString.call(t))return t.reduce((function(t,e){return t+e.x+","+e.y+" "}),"")}or.prototype=new je,or.prototype.node=function(){return this.execute(),this.dom},or.prototype.transFormAttributes=function(){var t=this;for(var e in t.changedAttribute)"transform"!==e?ar(t,e):sr(t);this.changedAttribute={}},or.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.scale=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)&&t.length>0?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:("function"==typeof e&&(e=e.call(this,this.dataObj)),Rt.RGBAInstanceCheck(e)&&(e=e.rgba),this.style[t]=e),this.changedStyles[t]=e;else if(1===arguments.length&&"object"==typeof t)for(var r in t)null==t[r]&&null!=this.style[t]?delete this.style[r]:this.style[r]=t[r],this.changedStyles[r]=t[r];return this.styleChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.setAttr=function(t,e){if(2===arguments.length)"points"===t&&(e=hr(e)),this.attr[t]=e,this.changedAttribute[t]=e;else if(1===arguments.length&&"object"==typeof t)for(var r in t)"points"===r&&(t[r]=hr(t[r])),this.attr[r]=t[r],this.changedAttribute[r]=t[r];return this.attrChanged=!0,qe.vDomChanged(this.vDomIndex),this},or.prototype.execute=function(){if(this.styleChanged||this.attrChanged){this.transFormAttributes();for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();for(var r in this.changedStyles)"object"==typeof this.changedStyles[r]&&(this.changedStyles[r]instanceof er||this.changedStyles[r]instanceof Ke||this.changedStyles[r]instanceof Je||this.changedStyles[r]instanceof $e)&&(this.changedStyles[r]=this.changedStyles[r].exe()),this.dom.style.setProperty(r,this.changedStyles[r],"");this.changedStyles={}}else for(var i=0,n=this.children.length;i<n;i+=1)this.children[i].execute()},or.prototype.child=function(t){var e=this.dom;if(t instanceof Qe){for(var r=document.createDocumentFragment(),i=0,n=t.stack.length;i<n;i++)r.appendChild(t.stack[i].dom),t.stack[i].parentNode=this,this.children[this.children.length]=t.stack[i];e.appendChild(r)}else t instanceof or?(e.appendChild(t.dom),t.parentNode=this,this.children.push(t)):console.log("wrong node type");return this},or.prototype.animatePathTo=Mt.animatePathTo,or.prototype.morphTo=Mt.morphTo,or.prototype.createRadialGradient=function(t){var e=new er(t,"radial",this);return e.radialGradient(),e},or.prototype.createLinearGradient=function(t){var e=new er(t,"linear",this);return e.linearGradient(),e},or.prototype.on=function(t,e){var r=this;if(r.events[t]&&"drag"!==t&&"zoom"!==t&&(r.dom.removeEventListener(t,r.events[t]),delete r.events[t]),"drag"===t&&delete r.dom.drag_,"zoom"===t&&(r.dom.removeEventListener("wheel",r.events[t]),delete r.dom.drag_),e){if("drag"===t)r.dom.drag_=function(t,i){e.execute(r,t,i)};else if("zoom"===t){var i,n=0,o=0;r.events[t]=function(t){e.disableWheel||(e.zoomExecute(r,t),n+=1,i&&(clearTimeout(i),i=null,o=n),i=setTimeout((function(){o!==n?o=n:(i=null,e.onZoomEnd(r,t),n=0)}),100))},r.dom.addEventListener("wheel",r.events[t]),r.dom.drag_=function(t,i,n){e.panFlag&&e.panExecute(r,t,i,n)}}else{var a=e.bind(r);r.events[t]=function(t){a(t)},r.dom.addEventListener(t,r.events[t])}return this}},or.prototype.html=function(t){return arguments.length?(this.dom.innerHTML(t),this):this.dom.innerHTML},or.prototype.text=function(t){return arguments.length?(this.attr.text=t,this.changedAttribute.text=t,this):this.attr.text},or.prototype.remove=function(){this.parentNode.removeChild(this)},or.prototype.createEls=function(t,e){var r=new Qe({type:"SVG"},t,e,this.vDomIndex);return this.child(r),qe.vDomChanged(this.vDomIndex),r},or.prototype.createEl=function(t){var e=nr(t,this.vDomIndex);return this.child(e),qe.vDomChanged(this.vDomIndex),e},or.prototype.removeChild=function(t){var e=this.children,r=e.indexOf(t);if(-1!==r){var i=e.splice(r,1)[0].dom;if(!this.dom.contains(i))return;this.dom.removeChild(i)}};var cr=x,lr=J,dr=0;function fr(){return dr+=1}function ur(t,e,r){var i=e.dx;void 0===i&&(i=0);var n=e.dy;void 0===n&&(n=0);var o=t.transform.translate,a=t.transform.scale,s=a[0],h=a[1];return void 0===h&&(h=s),function(t,e,r){var i=e[0],n=e[1];return r[0]>=t[0][0]*i&&r[0]<=t[1][0]*i&&r[1]>=t[0][1]*n&&r[1]<=t[1][1]*n}(r,[s,h],[o[0]+i,o[1]+n])&&(i/=s,n/=h,t.dx=i,t.dy=n,o[0]/=s,o[1]/=h,o[0]+=i,o[1]+=n,o[0]*=s,o[1]*=h),t}var pr=function(){var t=this;this.dragStartFlag=!1,this.dragExtent=[[-1/0,-1/0],[1/0,1/0]],this.event={x:0,y:0,dx:0,dy:0,transform:{translate:[0,0],scale:[1,1]}},this.onDragStart=function(e,r){t.event.x=r.offsetX,t.event.y=r.offsetY,t.event.dx=0,t.event.dy=0,t.dragStartFlag=!0},this.onDrag=function(){},this.onDragEnd=function(){t.event.x=event.offsetX,t.event.y=event.offsetY,t.event.dx=0,t.event.dy=0,t.dragStartFlag=!1}};function yr(t,e){return e<=t[0]?t[0]:e>=t[1]?t[1]:e}function xr(t,e,r,i){return t.translate[0]/=e,t.translate[1]/=e,t.translate[0]-=i[0]/e-i[0]/r,t.translate[1]-=i[1]/e-i[1]/r,t.scale=[r,r],t.translate[0]*=r,t.translate[1]*=r,t}pr.prototype={dragExtent:function(t){return this.dragExtent=t,this},dragStart:function(t){var e=this;return"function"==typeof t&&(this.onDragStart=function(r,i){e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,t.call(r,e.event),e.dragStartFlag=!0}),this},drag:function(t){var e=this;return"function"==typeof t&&(this.onDrag=function(r,i){var n=i.offsetX-e.event.x,o=i.offsetY-e.event.y;e.event.x=i.offsetX,e.event.y=i.offsetY,e.event=ur(this.event,{dx:n,dy:o},e.dragExtent),t.call(r,e.event)}),this},dragEnd:function(t){var e=this;return"function"==typeof t&&(this.onDragEnd=function(r,i){e.dragStartFlag=!1,e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,t.call(r,e.event)}),this},bindMethods:function(t){var e=this;t.dragTo=function(r,i){e.dragTo(t,r,i)}},execute:function(t,e,r){var i=this;this.event.e=e,e.preventDefault&&e.preventDefault(),this.dragStartFlag||"mousedown"!==r&&"pointerdown"!==r?!this.onDragEnd||"mouseup"!==r&&"mouseleave"!==r&&"pointerleave"!==r&&"pointerup"!==r?this.onDrag&&i.onDrag(t,e):i.onDragEnd(t,e):i.onDragStart(t,e)}};var vr=function(){var t=this;this.event={x:0,y:0,dx:0,dy:0,distance:0},this.event.pointers=[],this.event.transform={translate:[0,0],scale:[1,1]},this.zoomBy_=.001,this.zoomExtent_=[0,1/0],this.zoomStartFlag=!1,this.zoomDuration=250,this.onZoomStart=function(e,r){t.event.x=r.offsetX,t.event.y=r.offsetY,t.event.dx=0,t.event.dy=0,t.zoomStartFlag=!0,t.event.distance=0},this.onZoom=function(e,r){t.event.x=r.offsetX,t.event.y=r.offsetY},this.onZoomEnd=function(e,r){t.event.x=r.offsetX,t.event.y=r.offsetY,t.event.dx=0,t.event.dy=0,t.zoomStartFlag=!1,t.event.distance=0},this.onPanStart=function(t,e){},this.onPan=function(t,e){},this.onPanEnd=function(){},this.disableWheel=!1,this.disableDbclick=!1};vr.prototype.zoomStart=function(t){var e=this;return"function"==typeof t&&(this.zoomStartExe=t,this.onZoomStart=function(r,i,n){if(n.pointers&&2===n.pointers.length){var o=n.pointers;i={x:o[0].offsetX+.5*(o[1].offsetX-o[0].offsetX),y:o[0].offsetY+.5*(o[1].offsetY-o[0].offsetY)}}e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,e.zoomStartFlag||t.call(r,e.event),e.zoomStartFlag=!0,e.event.distance=0}),this},vr.prototype.zoom=function(t){var e=this;return"function"==typeof t&&(this.zoomExe=t,this.onZoom=function(r,i){var n=e.event.transform,o=n.scale[0],a=o,s=i.deltaY,h=i.offsetX,c=i.offsetY;a=yr(e.zoomExtent_,a+-1*s*e.zoomBy_),e.event.transform=xr(n,o,a,[h,c]),e.event.x=h,e.event.y=c,t.call(r,e.event)}),this},vr.prototype.zoomEnd=function(t){var e=this;return"function"==typeof t&&(this.zoomEndExe=t,this.onZoomEnd=function(r,i){e.event.x=i.offsetX,e.event.y=i.offsetY,e.event.dx=0,e.event.dy=0,e.zoomStartFlag=!1,t.call(r,e.event),e.event.distance=0}),this},vr.prototype.zoomTransition=function(){},vr.prototype.zoomExecute=function(t,e,r){this.eventType="zoom",e.preventDefault&&e.preventDefault(),this.zoomStartFlag?this.onZoom(t,e):this.onZoomStart(t,e,r)},vr.prototype.zoomPinch=function(t,e,r){var i=r.pointers;if(e.preventDefault&&e.preventDefault(),2===r.pointers.length)if(this.zoomStartFlag){for(var n=this.event.distance,o=0;o<i.length;o++)if(e.pointerId===i[o].pointerId){i[o]=e;break}var a=F.getDistance({x:i[0].offsetX,y:i[0].offsetY},{x:i[1].offsetX,y:i[1].offsetY}),s={offsetX:this.event.x,offsetY:this.event.y,deltaY:n?n-a:0};this.event.distance=a,this.onZoom(t,s)}else this.onZoomStart(t,e,r)},vr.prototype.scaleBy=function(t,e,r){var i=this,n=i.event.transform,o=e*n.scale[0],a=n.scale[0],s=this.zoomTarget_||r,h=(s[0]-r[0])*a,c=(s[1]-r[1])*a,l=0,d={run:function(e){var s=n.scale[0],d=yr(i.zoomExtent_,a+(o-a)*e);i.event.transform=xr(n,s,d,r),i.event.transform.translate[0]+=h*(e-l)/d,i.event.transform.translate[1]+=c*(e-l)/d,l=e,i.zoomExe&&i.zoomExe.call(t,i.event)},target:t,duration:i.zoomDuration,delay:0,end:function(){i.onZoomEnd&&i.onZoomEnd(t,{})},loop:1,direction:"default",ease:"default"};cr.add(fr(),d,lr(d.ease))},vr.prototype.zoomTarget=function(t){this.zoomTarget_=t},vr.prototype.scaleTo=function(t,e,r){var i=this,n=i.event.transform,o=n.scale[0],a=this.zoomTarget_||r,s=(a[0]-r[0])*o,h=(a[1]-r[1])*o,c=0,l={run:function(a){var l=n.scale[0],d=yr(i.zoomExtent_,o+(e-o)*a);i.event.transform=xr(n,l,d,r),i.event.transform.translate[0]+=s*(a-c)/d,i.event.transform.translate[1]+=h*(a-c)/d,c=a,i.zoomStartFlag||i.onZoomStart(t,{offsetX:r[0],offsetY:r[1]},{}),i.zoomExe&&i.zoomExe.call(t,i.event)},target:t,duration:i.zoomDuration,delay:0,end:function(){i.onZoomEnd&&i.onZoomEnd(t,i.event)},loop:1,direction:"default",ease:"default"};cr.add(fr(),l,lr(l.ease))},vr.prototype.panTo=function(t,e){var r=this,i=r.event.transform,n=e[0]-r.event.x,o=e[1]-r.event.y,a=0,s={run:function(e){var s=i.scale[0];i.translate[0]+=n*(e-a)/s,i.translate[1]+=o*(e-a)/s,a=e,r.zoomExe&&r.zoomExe.call(t,r.event)},target:t,duration:r.zoomDuration,delay:0,end:function(){r.onZoomEnd&&r.onZoomEnd(t,r.event)},loop:1,direction:"default",ease:"default"};cr.add(fr(),s,lr(s.ease))},vr.prototype.bindMethods=function(t){var e=this;t.scaleTo=function(r,i){e.scaleTo(t,r,i)},t.scaleBy=function(r,i){return e.scaleBy(t,r,i),t},t.panTo=function(r,i){return e.panTo(t,r,i),t}},vr.prototype.zoomFactor=function(t){return this.zoomBy_=t,this},vr.prototype.scaleExtent=function(t){return this.zoomExtent_=t,this},vr.prototype.duration=function(t){return this.zoomDuration=t||250,this},vr.prototype.panExtent=function(t){return this.panExtent_=t,this.panFlag=!0,this},vr.prototype.panExecute=function(t,e,r,i){if(1===i.pointers.length){if(this.event.e=e,this.eventType="pan",e.preventDefault&&e.preventDefault(),"touchstart"!==e.type&&"touchmove"!==e.type&&"touchend"!==e.type&&"touchcancel"!==e.type||(e.offsetX=e.touches[0].clientX,e.offsetY=e.touches[0].clientY),this.zoomStartFlag||"mousedown"!==r&&"pointerdown"!==r)if(!this.onZoomEnd||"mouseup"!==r&&"mouseleave"!==r&&"pointerup"!==r&&"pointerleave"!==r){if(this.zoomExe){var n=e.offsetX-this.event.x,o=e.offsetY-this.event.y;this.event.x=e.offsetX,this.event.y=e.offsetY,this.event=ur(this.event,{dx:n,dy:o},this.panExtent_),this.zoomExe.call(t,this.event)}}else this.onZoomEnd(t,e);else this.onZoomStart(t,e,{});e.preventDefault&&e.preventDefault()}};var mr={drag:function(){return new pr},zoom:function(){return new vr}},gr=F,br=x,wr=0,Br=mr.zoom(),Ar=mr.drag();function Tr(){return wr+=1}var kr=function(){Ye.apply(this,arguments)};function Er(t){var e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);return e<1?1:e}function Sr(t){var e={translateX:0,translateY:0,scaleX:1,scaleY:1};return t&&(t.translate&&t.translate.length>0&&(e.translateX=t.translate[0],e.translateY=t.translate[1]),t.scale&&t.scale.length>0&&(e.scaleX=t.scale[0],e.scaleY=t.scale[1]||e.scaleX)),e}function Cr(){var t=this,e=t.attr,r=e.transform,i=e.points;void 0===i&&(i=[]);var n=Sr(r),o=n.translateX,a=n.translateY,s=n.scaleX,h=n.scaleY;if(i&&i.length>0){for(var c=i[0].x,l=i[0].x,d=i[0].y,f=i[0].y,u=1;u<i.length;u+=1)c>i[u].x&&(c=i[u].x),l<i[u].x&&(l=i[u].x),d>i[u].y&&(d=i[u].y),f<i[u].y&&(f=i[u].y);t.BBox={x:o+c*s,y:a+d*h,width:(l-c)*s,height:(f-d)*h}}else t.BBox={x:0,y:0,width:0,height:0};r&&r.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox}function Dr(t,e){this.config=t,this.type=e||"linear",this.mode=this.config.mode&&"percent"!==this.config.mode?"absolute":"percent"}function Mr(t,e,r){this.imageData=t,this.width=e,this.height=r}function _r(t,e){void 0===e&&(e={});var r=e.id?e.id:"mask-"+Math.ceil(1e3*Math.random());this.config=e,this.mask=new Qr(t.dom.ctx,{el:"g",attr:{id:r}},Tr(),t.vDomIndex)}function zr(t){return new _r(this,t)}function Ir(t,e){void 0===e&&(e={});var r=e.id?e.id:"clip-"+Math.ceil(1e3*Math.random());this.clip=new Qr(t.dom.ctx,{el:"g",attr:{id:r}},Tr(),t.vDomIndex)}function Pr(t){return new Ir(this,t)}function Or(t,e,r,i){void 0===e&&(e={}),void 0===r&&(r=0),void 0===i&&(i=0);var n=this,o=e.id?e.id:"pattern-"+Math.ceil(1e3*Math.random());this.repeatInd=e.repeat?e.repeat:"repeat","NODE"===t.ENV?n.pattern=ii({},i,r):(n.pattern=Jr(null,{},{enableEvents:!1,enableResize:!1}),n.pattern.setSize(r,i)),n.pattern.setAttr("id",o),t.prependChild([n.pattern]),n.pattern.vDomIndex=t.vDomIndex+":"+o,n.pattern.onChange((function(){n.patternObj=t.ctx.createPattern(n.pattern.domEl,n.repeatInd)}))}function Lr(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new Or(this,t,e,r)}function Nr(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}function Fr(t,e,r,i,n,o){var a=this;for(var s in a.ctx=t,a.attr=e,a.style=r,a.nodeName="Image",a.nodeExe=o,e)this.setAttr(s,e[s]);br.vDomChanged(o.vDomIndex),a.stack=[a]}function Rr(t,e,r){var i=this;i.ctx=t,i.attr=e,i.style=r,i.nodeName="text",i.stack=[i]}(kr.prototype=new Ye).constructor=kr,kr.prototype.createNode=function(t,e,r){return new Qr(t,e,Tr(),r)},Dr.prototype.exe=function(t,e){return"linear"===this.type&&"percent"===this.mode?this.linearGradient(t,e):"linear"===this.type&&"absolute"===this.mode?this.absoluteLinearGradient(t):"radial"===this.type&&"percent"===this.mode?this.radialGradient(t,e):"radial"===this.type&&"absolute"===this.mode?this.absoluteRadialGradient(t):void console.error("wrong Gradiant type")},Dr.prototype.linearGradient=function(t,e){var r=t.createLinearGradient(e.x+e.width*(this.config.x1/100),e.y+e.height*(this.config.y1/100),e.x+e.width*(this.config.x2/100),e.y+e.height*(this.config.y2/100));return this.config.colorStops.forEach((function(t){r.addColorStop(t.value/100,t.color)})),r},Dr.prototype.absoluteLinearGradient=function(t){var e=t.createLinearGradient(this.config.x1,this.config.y1,this.config.x2,this.config.y2);return this.config.colorStops.forEach((function(t){e.addColorStop(t.value,t.color)})),e},Dr.prototype.radialGradient=function(t,e){var r=t.createRadialGradient(e.x+e.width*(this.config.innerCircle.x/100),e.y+e.height*(this.config.innerCircle.y/100),e.width>e.height?e.width*this.config.innerCircle.r/100:e.height*this.config.innerCircle.r/100,e.x+e.width*(this.config.outerCircle.x/100),e.y+e.height*(this.config.outerCircle.y/100),e.width>e.height?e.width*this.config.outerCircle.r/100:e.height*this.config.outerCircle.r/100);return this.config.colorStops.forEach((function(t){r.addColorStop(t.value/100,t.color)})),r},Dr.prototype.absoluteRadialGradient=function(t,e){var r=t.createRadialGradient(this.config.innerCircle.x,this.config.innerCircle.y,this.config.innerCircle.r,this.config.outerCircle.x,this.config.outerCircle.y,this.config.outerCircle.r);return this.config.colorStops.forEach((function(t){r.addColorStop(t.value/100,t.color)})),r},Dr.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,this)},Mr.prototype.get=function(t){var e=this.imageData?this.imageData.pixels:[],r=(t.y-1)*(4*this.width)+4*(t.x-1);return"rgba("+e[r]+", "+e[r+1]+", "+e[r+2]+", "+e[r+3]+")"},Mr.prototype.put=function(t,e){var r=(t.y-1)*(4*this.width)+4*(t.x-1);return this.imageData.pixels[r]=e[0],this.imageData.pixels[r+1]=e[1],this.imageData.pixels[r+2]=e[2],this.imageData.pixels[r+3]=e[3],this},_r.prototype.setAttr=function(t,e){this.config[t]=e},_r.prototype.exe=function(){return this.mask.execute(),this.mask.dom.ctx.globalCompositeOperation=this.config.globalCompositeOperation||"destination-atop",!0},Ir.prototype.exe=function(){return this.clip.execute(),this.clip.dom.ctx.clip(),!0},Or.prototype.repeat=function(t){this.repeatInd=t},Or.prototype.exe=function(){return this.patternObj},Nr.prototype={render:function(t){var e=this;if(t.transform){var r=t.transform,i=r.scale;void 0===i&&(i=[1,1]);var n=r.skew;void 0===n&&(n=[0,0]);var o=r.translate;void 0===o&&(o=[0,0]);var a=i[0];void 0===a&&(a=1);var s=i[1];void 0===s&&(s=a);var h=n[0];void 0===h&&(h=0);var c=n[1];void 0===c&&(c=h);var l=o[0];void 0===l&&(l=0);var d=o[1];void 0===d&&(d=l),e.ctx.transform(a,h,c,s,l,d),r.rotate&&r.rotate.length>0&&(e.ctx.translate(r.rotate[1]||0,r.rotate[2]||0),e.ctx.rotate(r.rotate[0]*(Math.PI/180)),e.ctx.translate(-r.rotate[1]||0,-r.rotate[2]||0))}for(var f=0;f<e.stack.length;f+=1)e.stack[f].execute()},setAttr:function(t,e){null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e},setStyle:function(t,e){null==e&&null!=this.style[t]?delete this.style[t]:this.style[t]=e},applyStyles:function(){"#000000"!==this.ctx.fillStyle&&this.ctx.fill(),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke()}},Fr.prototype=new Nr,Fr.prototype.constructor=Fr,Fr.prototype.setAttr=function(t,e){var r=this;"src"===t&&("string"==typeof e?(r.image=r.image?r.image:function(t){var e=new Image;return e.crossOrigin="anonymous",e.onload=function(){t.attr.height=t.attr.height?t.attr.height:this.height,t.attr.width=t.attr.width?t.attr.width:this.width,t.imageObj=this,t.nodeExe.attr.onload&&"function"==typeof t.nodeExe.attr.onload&&t.nodeExe.attr.onload.call(t.nodeExe,t.image),t.nodeExe.BBoxUpdate=!0,br.vDomChanged(t.nodeExe.vDomIndex)},e.onerror=function(e){t.nodeExe.attr.onerror&&"function"==typeof t.nodeExe.attr.onerror&&t.nodeExe.attr.onerror.call(t.nodeExe,e)},e}(r),r.image.src!==e&&(r.image.src=e)):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(r.imageObj=e,r.attr.height=r.attr.height?r.attr.height:e.height,r.attr.width=r.attr.width?r.attr.width:e.width):(e instanceof Qr||e instanceof ri)&&(r.imageObj=e.domEl,r.attr.height=r.attr.height?r.attr.height:e.height,r.attr.width=r.attr.width?r.attr.width:e.width)),this.attr[t]=e,br.vDomChanged(this.nodeExe.vDomIndex)},Fr.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x;void 0===i&&(i=0);var n=e.y;void 0===n&&(n=0);var o=e.width;void 0===o&&(o=0);var a=e.height;void 0===a&&(a=0);var s=Sr(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:(h+i)*l,y:(c+n)*d,width:o*l,height:a*d},r&&r.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},Fr.prototype.execute=function(){var t=this.attr,e=t.width;void 0===e&&(e=0);var r=t.height;void 0===r&&(r=0);var i=t.x;void 0===i&&(i=0);var n=t.y;void 0===n&&(n=0),this.imageObj&&this.ctx.drawImage(this.imageObj,i,n,e,r)},Fr.prototype.applyStyles=function(){},Fr.prototype.in=function(t){var e=this.attr,r=e.width;void 0===r&&(r=0);var i=e.height;void 0===i&&(i=0);var n=e.x;void 0===n&&(n=0);var o=e.y;return void 0===o&&(o=0),t.x>=n&&t.x<=n+r&&t.y>=o&&t.y<=o+i},Rr.prototype=new Nr,Rr.prototype.constructor=Rr,Rr.prototype.text=function(t){this.attr.text=t},Rr.prototype.updateBBox=function(){var t,e=this,r=1,i=e.attr,n=i.x;void 0===n&&(n=0);var o=i.y;void 0===o&&(o=0);var a=i.transform,s=Sr(a),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;this.style.font&&(this.ctx.font=this.style.font,r=parseInt(this.style.font.replace(/[^\d.]/g,""),10)||1),t=this.ctx.measureText(this.attr.text).width,"center"===this.style.textAlign?n-=t/2:"right"===this.style.textAlign&&(n-=t),e.width=t,e.height=r,e.x=n,e.y=o,e.BBox={x:(h+n)*l,y:(c+o)*d,width:t*l,height:r*d},a&&a.rotate?e.BBoxHit=gr.rotateBBox(this.BBox,a):e.BBoxHit=this.BBox},Rr.prototype.execute=function(){void 0!==this.attr.text&&null!==this.attr.text&&("#000000"!==this.ctx.fillStyle&&this.ctx.fillText(this.attr.text,this.attr.x,this.attr.y+this.height),"#000000"!==this.ctx.strokeStyle&&this.ctx.strokeText(this.attr.text,this.attr.x,this.attr.y+this.height))},Rr.prototype.applyStyles=function(){},Rr.prototype.in=function(t){var e=this,r=e.x;void 0===r&&(r=0);var i=e.y;void 0===i&&(i=0);var n=e.width;void 0===n&&(n=0);var o=e.height;return void 0===o&&(o=0),t.x>=r&&t.x<=r+n&&t.y>=i&&t.y<=i+o};var jr=function(t,e,r){var i=this;i.ctx=t,i.attr=e,i.style=r,i.nodeName="circle",i.stack=[i]};(jr.prototype=new Nr).constructor=jr,jr.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.r;void 0===i&&(i=0);var n=e.cx;void 0===n&&(n=0);var o=e.cy;void 0===o&&(o=0);var a=Sr(r),s=a.translateX,h=a.translateY,c=a.scaleX,l=a.scaleY;t.BBox={x:s+(n-i)*c,y:h+(o-i)*l,width:2*i*c,height:2*i*l},r&&r.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},jr.prototype.execute=function(){var t=this.attr,e=t.r;void 0===e&&(e=0);var r=t.cx;void 0===r&&(r=0);var i=t.cy;void 0===i&&(i=0),this.ctx.beginPath(),this.ctx.arc(r,i,e,0,2*Math.PI,!1),this.applyStyles(),this.ctx.closePath()},jr.prototype.in=function(t,e){var r=this.attr,i=r.r;void 0===i&&(i=0);var n=r.cx;void 0===n&&(n=0);var o=r.cy;return void 0===o&&(o=0),Math.sqrt((t.x-n)*(t.x-n)+(t.y-o)*(t.y-o))<=i};var Xr=function(t,e,r){var i=this;i.ctx=t,i.attr=e,i.style=r,i.nodeName="line",i.stack=[i]};function Gr(t,e,r){var i=this;i.ctx=t,i.attr=e,i.style=r,i.nodeName="polyline",i.stack=[i]}(Xr.prototype=new Nr).constructor=Xr,Xr.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x1;void 0===i&&(i=0);var n=e.y1;void 0===n&&(n=0);var o=e.x2;void 0===o&&(o=0);var a=e.y2;void 0===a&&(a=0);var s=Sr(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:h+(i<o?i:o)*l,y:c+(n<a?n:a)*d,width:Math.abs(o-i)*l,height:Math.abs(a-n)*d},r&&r.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},Xr.prototype.execute=function(){var t=this.ctx,e=this.attr,r=e.x1;void 0===r&&(r=0);var i=e.y1;void 0===i&&(i=0);var n=e.x2;void 0===n&&(n=0);var o=e.y2;void 0===o&&(o=0),t.beginPath(),t.moveTo(r,i),t.lineTo(n,o),this.applyStyles(),t.closePath()},Xr.prototype.in=function(t){var e=this.attr,r=e.x1;void 0===r&&(r=0);var i=e.y1;void 0===i&&(i=0);var n=e.x2;void 0===n&&(n=0);var o=e.y2;return void 0===o&&(o=0),parseFloat(gr.getDistance({x:r,y:i},t)+gr.getDistance(t,{x:n,y:o})).toFixed(1)===parseFloat(gr.getDistance({x:r,y:i},{x:n,y:o})).toFixed(1)},Gr.prototype=new Nr,Gr.constructor=Gr,Gr.prototype.execute=function(){var t;if(this.attr.points&&0!==this.attr.points.length){this.ctx.beginPath(),this.ctx.moveTo(this.attr.points[0].x,this.attr.points[0].y);for(var e=1;e<this.attr.points.length;e++)t=this.attr.points[e],this.ctx.lineTo(t.x,t.y);this.applyStyles(),this.ctx.closePath()}},Gr.prototype.updateBBox=Cr,Gr.prototype.in=function(t){for(var e=!1,r=0,i=this.attr.points.length;r<=i-2;r++){var n=this.attr.points[r],o=this.attr.points[r+1];e=e||parseFloat(gr.getDistance({x:n.x,y:n.y},t)+gr.getDistance(t,{x:o.x,y:o.y})).toFixed(1)===parseFloat(gr.getDistance({x:n.x,y:n.y},{x:o.x,y:o.y})).toFixed(1)}return e};var Yr=function(t,e,r){var i=this;return i.ctx=t,i.angle=0,i.nodeName="path",i.attr=e,i.style=r,i.attr.d&&(Mt.isTypePath(i.attr.d)?(i.path=i.attr.d,i.attr.d=i.attr.d.fetchPathString()):i.path=Mt.instance(i.attr.d),i.pathNode=new Path2D(i.attr.d)),i.stack=[i],i};function Ur(t){if("[object Array]"===Object.prototype.toString.call(t)){if(!t||0!==t.length){var e=new Path2D;e.moveTo(t[0].x,t[0].y);for(var r=1;r<t.length;r++)e.lineTo(t[r].x,t[r].y);return e.closePath(),{path:e,points:t,execute:function(t){t.beginPath();var e=this.points;t.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);t.closePath()}}}}else console.error("Points expected as array [{x: , y:}]")}(Yr.prototype=new Nr).constructor=Yr,Yr.prototype.updateBBox=function(){var t=this,e=t.attr.transform,r=Sr(e),i=r.translateX,n=r.translateY,o=r.scaleX,a=r.scaleY;t.BBox=t.path?t.path.BBox:{x:0,y:0,width:0,height:0},t.BBox.x=i+t.BBox.x*o,t.BBox.y=n+t.BBox.y*a,t.BBox.width*=o,t.BBox.height*=a,e&&e.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},Yr.prototype.setAttr=function(t,e){this.attr[t]=e,"d"===t&&(Mt.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=Mt.instance(this.attr.d),this.pathNode=new Path2D(this.attr.d))},Yr.prototype.getPointAtLength=function(t){return this.path?this.path.getPointAtLength(t):{x:0,y:0}},Yr.prototype.getAngleAtLength=function(t){return this.path?this.path.getAngleAtLength(t):0},Yr.prototype.getTotalLength=function(){return this.path?this.path.getTotalLength():0},Yr.prototype.execute=function(){this.attr.d&&("#000000"!==this.ctx.fillStyle||"#000000"!==this.ctx.strokeStyle?("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.pathNode),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.pathNode)):this.path.execute(this.ctx))},Yr.prototype.applyStyles=function(){},Yr.prototype.in=function(t){var e=!1;return this.attr.d&&this.pathNode?(this.ctx.save(),this.ctx.scale(1/this.ctx.pixelRatio,1/this.ctx.pixelRatio),e=this.ctx.isPointInPath(this.pathNode,t.x,t.y),this.ctx.restore(),e):e};var Hr=function(t,e,r){var i=this;return i.ctx=t,i.nodeName="polygon",i.attr=e,i.style=r,i.stack=[i],i.attr.points&&(i.polygon=Ur(i.attr.points)),this};(Hr.prototype=new Nr).constructor=Hr,Hr.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.polygon=Ur(this.attr.points),this.polygon&&(this.attr.points=this.polygon.points))},Hr.prototype.updateBBox=Cr,Hr.prototype.execute=function(){this.polygon&&("#000000"!==this.ctx.fillStyle||"#000000"!==this.ctx.strokeStyle?("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.polygon.path),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.polygon.path)):this.polygon.execute(this.ctx))},Hr.prototype.applyStyles=function(){},Hr.prototype.in=function(t){var e=!1;return!!this.polygon&&(this.ctx.save(),this.ctx.scale(1/this.ctx.pixelRatio,1/this.ctx.pixelRatio),e=this.style.fillStyle?this.ctx.isPointInPath(this.polygon.path,t.x,t.y):e,this.ctx.restore(),e)};var Vr=function(t,e,r){var i=this;return i.ctx=t,i.nodeName="ellipse",i.attr=e,i.style=r,i.stack=[i],this};(Vr.prototype=new Nr).constructor=Vr,Vr.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.cx;void 0===i&&(i=0);var n=e.cy;void 0===n&&(n=0);var o=e.rx;void 0===o&&(o=0);var a=e.ry;void 0===a&&(a=0);var s=Sr(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:h+(i-o)*l,y:c+(n-a)*d,width:2*o*l,height:2*a*d},r&&r.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},Vr.prototype.execute=function(){var t=this.ctx,e=this.attr,r=e.cx;void 0===r&&(r=0);var i=e.cy;void 0===i&&(i=0);var n=e.rx;void 0===n&&(n=0);var o=e.ry;void 0===o&&(o=0),t.beginPath(),t.ellipse(r,i,n,o,0,0,2*Math.PI),this.applyStyles(),t.closePath()},Vr.prototype.in=function(t){var e=this.attr,r=e.cx;void 0===r&&(r=0);var i=e.cy;void 0===i&&(i=0);var n=e.rx;void 0===n&&(n=0);var o=e.ry;return void 0===o&&(o=0),(t.x-r)*(t.x-r)/(n*n)+(t.y-i)*(t.y-i)/(o*o)<=1};var qr=function(t,e,r){var i=this;return i.ctx=t,i.nodeName="rect",i.attr=e,i.style=r,i.stack=[i],this};function Zr(t,e){var r=e.x;void 0===r&&(r=0);var i=e.y;void 0===i&&(i=0);var n=e.width;void 0===n&&(n=0);var o=e.height;void 0===o&&(o=0);var a=e.rx;void 0===a&&(a=0);var s=e.ry;void 0===s&&(s=0),t.beginPath(),t.moveTo(r+a,i),t.lineTo(r+n-a,i),t.quadraticCurveTo(r+n,i,r+n,i+s),t.lineTo(r+n,i+o-s),t.quadraticCurveTo(r+n,i+o,r+n-a,i+o),t.lineTo(r+a,i+o),t.quadraticCurveTo(r,i+o,r,i+o-s),t.lineTo(r,i+s),t.quadraticCurveTo(r,i,r+a,i),t.closePath()}(qr.prototype=new Nr).constructor=qr,qr.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x;void 0===i&&(i=0);var n=e.y;void 0===n&&(n=0);var o=e.width;void 0===o&&(o=0);var a=e.height;void 0===a&&(a=0);var s=Sr(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:h+i*l,y:c+n*d,width:o*l,height:a*d},r&&r.rotate?t.BBoxHit=gr.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},qr.prototype.applyStyles=function(){},qr.prototype.execute=function(){var t=this.ctx,e=this.attr,r=e.x;void 0===r&&(r=0);var i=e.y;void 0===i&&(i=0);var n=e.width;void 0===n&&(n=0);var o=e.height;void 0===o&&(o=0);var a=e.rx;void 0===a&&(a=0);var s=e.ry;void 0===s&&(s=0),"#000000"!==t.fillStyle||"#000000"!==t.strokeStyle?("#000000"!==t.fillStyle&&(a||s?(Zr(t,{x:r,y:i,width:n,height:o,rx:a,ry:s}),t.fill()):t.fillRect(r,i,n,o)),"#000000"!==t.strokeStyle&&(a||s?(Zr(t,{x:r,y:i,width:n,height:o,rx:a,ry:s}),t.stroke()):t.strokeRect(r,i,n,o))):t.rect(r,i,n,o)},qr.prototype.in=function(t){var e=this.attr,r=e.x;void 0===r&&(r=0);var i=e.y;void 0===i&&(i=0);var n=e.width;void 0===n&&(n=0);var o=e.height;return void 0===o&&(o=0),t.x>=r&&t.x<=r+n&&t.y>=i&&t.y<=i+o};var Wr=function(t,e,r){var i=this;return i.nodeName="g",i.ctx=t,i.attr=e,i.style=r,i.stack=new Array(0),this};(Wr.prototype=new Nr).constructor=Wr,Wr.prototype.updateBBox=function(t){var e,r,i,n,o=this,a=Sr(o.attr.transform),s=a.translateX,h=a.translateY,c=a.scaleX,l=a.scaleY;if(o.BBox={},t&&t.length>0)for(var d,f,u,p=0;p<t.length;p+=1)f=(d=t[p]).dom.BBoxHit.x,u=d.dom.BBoxHit.y,e=void 0===e||e>f?f:e,i=void 0===i||i>u?u:i,r=void 0===r||r<f+d.dom.BBoxHit.width?f+d.dom.BBoxHit.width:r,n=void 0===n||n<u+d.dom.BBoxHit.height?u+d.dom.BBoxHit.height:n;e=void 0===e?0:e,i=void 0===i?0:i,r=void 0===r?0:r,n=void 0===n?0:n,o.BBox.x=s+e*c,o.BBox.y=h+i*l,o.BBox.width=Math.abs(r-e)*c,o.BBox.height=Math.abs(n-i)*l,o.attr.transform&&o.attr.transform.rotate?o.BBoxHit=gr.rotateBBox(this.BBox,this.attr.transform):o.BBoxHit=this.BBox},Wr.prototype.child=function(t){var e=this,r=t;r instanceof Qr?(r.dom.parent=e,e.stack[e.stack.length]=r):r instanceof kr?r.stack.forEach((function(t){t.dom.parent=e,e.stack[e.stack.length]=t})):console.log("wrong Object")},Wr.prototype.in=function(t){var e=t.x,r=t.y,i=this.BBox,n=Sr(this.attr.transform),o=n.translateX,a=n.translateY,s=n.scaleX,h=n.scaleY;return e>=(i.x-o)/s&&e<=(i.x-o+i.width)/s&&r>=(i.y-a)/h&&r<=(i.y-a+i.height)/h};var Qr=function(t,e,r,i){switch(this.style=e.style||{},this.setStyle(e.style),this.attr=e.attr||{},this.id=r,this.nodeName=e.el,this.nodeType="CANVAS",this.children=[],this.events={},this.ctx=t,this.vDomIndex=i,this.bbox=void 0===e.bbox||e.bbox,e.el){case"circle":this.dom=new jr(this.ctx,this.attr,this.style);break;case"rect":this.dom=new qr(this.ctx,this.attr,this.style);break;case"line":this.dom=new Xr(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new Gr(this.ctx,this.attr,this.style);break;case"path":this.dom=new Yr(this.ctx,this.attr,this.style);break;case"group":case"g":this.dom=new Wr(this.ctx,this.attr,this.style);break;case"text":this.dom=new Rr(this.ctx,this.attr,this.style);break;case"image":this.dom=new Fr(this.ctx,this.attr,this.style,e.onload,e.onerror,this);break;case"polygon":this.dom=new Hr(this.ctx,this.attr,this.style,this);break;case"ellipse":this.dom=new Vr(this.ctx,this.attr,this.style,this);break;default:this.dom=null}this.dom.nodeExe=this,this.BBoxUpdate=!0};function $r(t){return Rt.RGBAInstanceCheck(t)&&(t=t.rgba),"#000"===t||"#000000"===t||"black"===t?"rgb(1, 1, 1)":t}function Jr(t,e,r){void 0===e&&(e={}),void 0===r&&(r={});var i=t?document.querySelector(t):null,n=i?i.clientHeight:0,o=i?i.clientWidth:0,a=document.createElement("canvas"),s=a.getContext("2d",e),h=r.enableEvents;void 0===h&&(h=!0);var c=r.autoUpdate;void 0===c&&(c=!0);var l=r.enableResize;void 0===l&&(l=!0);var d=Er(s);s.pixelRatio=d;var f,u=function(t){t.clearRect(0,0,o*d,n*d)};a.setAttribute("height",n*d),a.setAttribute("width",o*d),a.style.height=n+"px",a.style.width=o+"px",a.style.position="absolute";var p,y,x,m,g=999999;i?(i.appendChild(a),f=new v,c&&(g=br.addVdom(f))):h=!1;var b=new Qr(s,{el:"g",attr:{id:"rootNode"}},Tr(),g);f&&f.rootNode(b);var w=b.execute.bind(b);b.container=i,b.domEl=a,b.height=n,b.width=o,b.type="CANVAS",b.ctx=s,b.setClear=function(t){u=t},b.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),a.setAttribute(t,e),this.attr[t]=e},b.enableEvents=function(t){h=t},b.setStyle=function(t,e){this.domEl.style[t]=e},b.addDependentLayer=function(t){if(t instanceof Qr){var e=t.attr.id?t.attr.id:"dep-"+Math.ceil(1e3*Math.random());t.setAttr("id",e),t.vDomIndex=this.vDomIndex+":"+e,this.prependChild([t])}};var B=function(e){document.querySelector(t)?(n=p||e.height,o=y||e.width,b.width=o,b.height=n,A(b.domEl,o,n),x&&x(),b.execute()):Ve(b)},A=function(t,e,r){t.setAttribute("height",r*d),t.setAttribute("width",e*d),t.style.height=r+"px",t.style.width=e+"px"};if(b.setPixelRatio=function(t){d=t,this.ctx.pixelRatio=d,A(this.domEl,this.width,this.height)},b.onResize=function(t){x=t},b.onChange=function(t){m=t},b.toDataURL=function(t){return this.domEl.toDataURL(t)},b.invokeOnChange=function(){},b.setSize=function(t,e){p=e,y=t,o=t,n=e,this.width=o,this.height=n,A(this.domEl,o,n),this.execute()},b.setViewBox=function(t,e,r,i){},b.getPixels=function(t,e,r,i){return new Mr(this.ctx.getImageData(t,e,r,i),r,i)},b.putPixels=function(t,e,r){if(t instanceof Mr)return this.ctx.putImageData(t.imageData,e,r)},b.clear=function(){u()},b.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},b.createPattern=Lr,b.createClip=Pr,b.createMask=zr,b.execute=function(){u(s),s.setTransform(d,0,0,d,0,0),this.updateBBox(),w(),m&&this.stateModified&&m(),this.stateModified=!1},b.update=function(){this.execute()},b.createTexture=function(t){return new ri(this,t)},b.createAsyncTexture=function(t){var e=this;return new Promise((function(r,i){var n=new ri(e,t);n.onLoad((function(){r(n)}))}))},b.destroy=function(){var e=document.querySelector(t);e&&e.contains(a)&&e.removeChild(a),br.removeVdom(g),Ve(b,B)},h){var T=new jt(b);a.addEventListener("mousemove",(function(t){t.preventDefault(),T.mousemoveCheck(t)})),a.addEventListener("mousedown",(function(t){T.mousedownCheck(t)})),a.addEventListener("mouseup",(function(t){T.mouseupCheck(t)})),a.addEventListener("mouseleave",(function(t){T.mouseleaveCheck(t)})),a.addEventListener("contextmenu",(function(t){T.contextmenuCheck(t)})),a.addEventListener("touchstart",(function(t){T.touchstartCheck(t)})),a.addEventListener("touchend",(function(t){T.touchendCheck(t)})),a.addEventListener("touchmove",(function(t){t.preventDefault(),T.touchmoveCheck(t)})),a.addEventListener("touchcancel",(function(t){T.touchcancelCheck(t)})),a.addEventListener("wheel",(function(t){T.wheelEventCheck(t)})),a.addEventListener("pointerdown",(function(t){T.addPointer(t),T.pointerdownCheck(t)})),a.addEventListener("pointerup",(function(t){T.removePointer(t),T.pointerupCheck(t)})),a.addEventListener("pointermove",(function(t){t.preventDefault(),T.pointermoveCheck(t)}))}return br.execute(),l&&b.container&&He(b,B),b}function Kr(t,e){var r=document.createElement("canvas");r.setAttribute("height",e),r.setAttribute("width",t),r.style.height=e+"px",r.style.width=t+"px",this.canvas=r,this.context=this.canvas.getContext("2d")}function ti(t,e){var r=new Image;return r.crossOrigin="anonymous",r.src=e,t?(r.onload=function(){t&&(t.attr&&(t.attr.height=t.attr.height?t.attr.height:this.naturalHeight,t.attr.width=t.attr.width?t.attr.width:this.naturalWidth),t.imageObj=this,t.attr&&t.attr.onload&&"function"==typeof t.attr.onload&&t.attr.onload.call(t,t.image),t.asyncOnLoad&&"function"==typeof t.asyncOnLoad&&t.asyncOnLoad(t.image),ei(t))},r.onerror=function(e){console.error(e),t.nodeExe.attr.onerror&&"function"==typeof t.nodeExe.attr.onerror&&t.nodeExe.attr.onerror.call(t.nodeExe,e),t.asyncOnLoad&&"function"==typeof t.asyncOnLoad&&t.asyncOnLoad(t.image)},r):r}function ei(t){t.imageObj&&(t.attr&&t.attr.clip?function(t){var e=t.ctx,r=t.attr,i=r.clip,n=r.width;void 0===n&&(n=0);var o=r.height;void 0===o&&(o=0);var a=i.sx;void 0===a&&(a=0);var s=i.sy;void 0===s&&(s=0);var h=i.swidth;void 0===h&&(h=n);var c=i.sheight;void 0===c&&(c=o);e.clearRect(0,0,n,o),e.drawImage(t.imageObj,a,s,h,c,0,0,n,o)}(t):t.execute(),t.attr&&t.attr.filter&&function(t){var e=t.ctx,r=t.attr,i=r.width;void 0===i&&(i=0);var n=r.height;void 0===n&&(n=0);var o=e.getImageData(0,0,i,n);e.putImageData(t.attr.filter(o),0,0)}(t),br.vDomChanged(t.nodeExe.vDomIndex))}function ri(t,e){void 0===e&&(e={});var r=this;for(var i in r.attr=Object.assign({},e.attr)||{},r.style=Object.assign({},e.style)||{},r.rImageObj=new Kr(r.attr.width||1,r.attr.height||1),r.ctx=r.rImageObj.context,r.domEl=r.rImageObj.canvas,r.imageArray=[],r.seekIndex=0,r.nodeName="Sprite",r.nodeExe=t,r.attr)r.setAttr(i,r.attr[i]);br.vDomChanged(t.vDomIndex)}function ii(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=0),!Canvas)return console.error("Canvas missing from node"),console.error('Install "Canvas" "canvas-5-polyfill" node modules'),void console.error('Make "Canvas" "Image" "Path2D" objects global from the above modules');var i,n=new Canvas(r,e),o=n.getContext("2d",t),a=Er(o),s=function(t){t.clearRect(0,0,r*a,e*a)},h=new v,c=br.addVdom(h),l=new Qr(o,{el:"g",attr:{id:"rootNode"}},Tr(),c);h.rootNode(l);var d=l.execute.bind(l);return l.domEl=n,l.height=e,l.width=r,l.type="CANVAS",l.ENV="NODE",l.setClear=function(t){s=t},l.onChange=function(t){i=t},l.getPixels=function(t,e,r,i){return this.ctx.getImageData(t,e,r,i)},l.putPixels=function(t,e,r){return this.ctx.putImageData(t,e,r)},l.clear=function(){s()},l.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},l.setSize=function(i,n){r=i,e=n,this.domEl=new Canvas(r,e),o=this.domEl.getContext("2d",t),this.width=r,this.height=e,this.ctx=o,this.execute()},l.execute=function(){s(o),o.setTransform(a,0,0,a,0,0),l.updateBBox(),d()},l.execute=function(){s(o),o.setTransform(a,0,0,a,0,0),this.updateBBox(),d(),i&&this.stateModified&&i(),this.stateModified=!1},l.update=function(){this.execute()},l.toDataURL=function(t){return this.domEl.toDataURL(t)},l.getPixels=function(t,e,r,i){return new Mr(this.ctx.getImageData(t,e,r,i),r,i)},l.putPixels=function(t,e,r){if(t instanceof Mr)return this.ctx.putImageData(t.imageData,e,r)},l.clear=function(){s()},l.createTexture=function(t){return new ri(this,t)},l.createAsyncTexture=function(t){var e=this;return new Promise((function(r,i){var n=new ri(e,t);n.onLoad((function(){r(n)}))}))},l.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},l.createPattern=Lr,l.createClip=Pr,l.createMask=zr,l}Qr.prototype=new je,Qr.prototype.node=function(){return this.updateBBox(),this.dom},Qr.prototype.stylesExe=function(){var t,e,r=this.style;for(e in r)"string"==typeof r[e]||"number"==typeof r[e]?t=r[e]:"object"==typeof r[e]?t=r[e]instanceof Dr||r[e]instanceof Or||r[e]instanceof Ir||r[e]instanceof _r?r[e].exe(this.ctx,this.dom.BBox):r[e]:"function"==typeof r[e]?(r[e]=r[e].call(this,this.dataObj),t=r[e]):console.log("unkonwn Style"),"function"!=typeof this.ctx[e]?this.ctx[e]=t:"function"==typeof this.ctx[e]?this.ctx[e](t):console.log("junk comp")},Qr.prototype.remove=function(){var t=this.dom.parent.children,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.dom.parent.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex)},Qr.prototype.attributesExe=function(){this.dom.render(this.attr)},Qr.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:this.style[t]=$r(e);else if(1===arguments.length&&"object"==typeof t)for(var r=Object.keys(t),i=0,n=r.length;i<n;i+=1)null==t[r[i]]&&null!=this.style[r[i]]?delete this.style[r[i]]:this.style[r[i]]=$r(t[r[i]]);return br.vDomChanged(this.vDomIndex),this},Qr.prototype.setAttr=function(t,e){if(2===arguments.length)null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t)for(var r=Object.keys(t),i=0;i<r.length;i+=1)null==t[r[i]]&&null!=this.attr[r[i]]?delete this.attr[r[i]]:this.attr[r[i]]=t[r[i]],this.dom.setAttr(r[i],t[r[i]]);return this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),this},Qr.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),this},Qr.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),this)},Qr.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),this},Qr.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skew||(this.attr.transform.skew=[]),this.attr.transform.skew[0]=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),this},Qr.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skew||(this.attr.transform.skew=[]),this.attr.transform.skew[1]=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),this},Qr.prototype.execute=function(){if("none"!==this.style.display){if(this.ctx.save(),this.stylesExe(),this.attributesExe(),this.dom instanceof Wr)for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();this.ctx.restore()}},Qr.prototype.prependChild=function(t){var e=this,r=t;if(e.dom instanceof Wr)for(var i=0;i<r.length;i+=1)r[i].dom.parent=e,e.children.unshift(r[i]);else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),e},Qr.prototype.child=function(t){var e=this,r=t;if(e.dom instanceof Wr)for(var i=0;i<r.length;i+=1)r[i].dom.parent=e,e.children[e.children.length]=r[i];else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),e},Qr.prototype.updateBBox=function(){var t;if(this.bbox){for(var e=0,r=this.children.length;e<r;e+=1)this.children[e]&&(t=this.children[e].updateBBox()||t);if(this.BBoxUpdate||t)return this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0}return!1},Qr.prototype.in=function(t){return this.dom.in(t)},Qr.prototype.on=function(t,e){if(this.events||(this.events={}),!e&&this.events[t])delete this.events[t];else if(e)if("function"==typeof e){var r=e.bind(this);this.events[t]=function(t){r(t)}}else"object"==typeof e&&(this.events[t]=e,e.constructor!==Br.constructor&&e.constructor!==Ar.constructor||e.bindMethods(this));return this},Qr.prototype.animatePathTo=Mt.animatePathTo,Qr.prototype.morphTo=Mt.morphTo,Qr.prototype.vDomIndex=null,Qr.prototype.createRadialGradient=function(t){return new Dr(t,"radial")},Qr.prototype.createLinearGradient=function(t){return new Dr(t,"linear")},Qr.prototype.createEls=function(t,e){var r=new kr({type:"CANVAS",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(r.stack),br.vDomChanged(this.vDomIndex),r},Qr.prototype.text=function(t){return this.dom instanceof Rr&&this.dom.text(t),br.vDomChanged(this.vDomIndex),this},Qr.prototype.createEl=function(t){var e=new Qr(this.dom.ctx,t,Tr(),this.vDomIndex);return this.child([e]),br.vDomChanged(this.vDomIndex),e},Qr.prototype.removeChild=function(t){var e=-1;if(this.children.forEach((function(r,i){r===t&&(e=i)})),-1!==e){var r=this.children.splice(e,1)[0];this.dom.removeChild(r.dom)}this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex)},Qr.prototype.getBBox=function(){return{x:this.dom.BBox.x,y:this.dom.BBox.y,width:this.dom.BBox.width,height:this.dom.BBox.height}},Qr.prototype.getPixels=function(){return new Mr(this.ctx.getImageData(this.dom.BBox.x,this.dom.BBox.y,this.dom.BBox.width,this.dom.BBox.height),this.dom.BBox.width,this.dom.BBox.height)},Qr.prototype.putPixels=function(t){if(t instanceof Mr)return this.ctx.putImageData(t.imageData,this.dom.BBox.x,this.dom.BBox.y)},Kr.prototype.setAttr=function(t,e){"height"===t?(this.canvas.setAttribute("height",e),this.canvas.style.height=e+"px"):"width"===t&&(this.canvas.setAttribute("width",e),this.canvas.style.width=e+"px")},ri.prototype=new je,ri.prototype.constructor=ri,ri.prototype.setAttr=function(t,e){var r=this;if("src"===t)if(Array.isArray(e)){var i=e.map((function(t){return new Promise((function(e,r){var i=ti(null,t);i.onload=function(){e(this)},i.onerror=function(t){r(t)}}))}));Promise.all(i).then((function(t){r.image=t,r.imageObj=t[r.seekIndex],r.attr&&r.attr.onload&&"function"==typeof r.attr.onload&&r.attr.onload.call(r,t),r.asyncOnLoad&&"function"==typeof r.asyncOnLoad&&r.asyncOnLoad(t),ei(r)}))}else"string"==typeof e?(r.image||(r.image=ti(r,e)),r.image.src!==e&&(r.image.src=e)):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(r.imageObj=e,r.attr.height=r.attr.height?r.attr.height:e.height,r.attr.width=r.attr.width?r.attr.width:e.width,ei(r)):(e instanceof Qr||e instanceof ri)&&(r.imageObj=e.domEl,r.attr.height=r.attr.height?r.attr.height:e.height,r.attr.width=r.attr.width?r.attr.width:e.width,ei(r));this.attr[t]=e,"height"!==t&&"width"!==t||(this.rImageObj.setAttr(t,e),ei(r)),"clip"!==t&&"filter"!==t||ei(r)},ri.prototype.onLoad=function(t){this.asyncOnLoad=t},ri.prototype.clone=function(){var t=Object.assign({},this.attr),e=Object.assign({},this.style);return t.src=this,new ri(this.nodeExe,{attr:t,style:e})},ri.prototype.execute=function(){var t=this.attr,e=t.width;void 0===e&&(e=0);var r=t.height;void 0===r&&(r=0);var i=this.attr.draw||{};this.ctx.clearRect(0,0,e,r),this.ctx.drawImage(this.imageObj,i.x||0,i.y||0,i.width||e,i.height||r)},ri.prototype.next=function(t){Array.isArray(this.image)&&(t<this.image.length&&t>=0?this.seekIndex=t:this.seekIndex<this.image.length-1&&this.seekIndex++,this.imageObj=this.image[this.seekIndex],ei(this))};var ni=Jr,oi=ii;function ai(t){var e;switch(t){case"point":e={vertexShader:"\n          precision highp float;\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_size;\n          \n          attribute mat3 a_transformMatrix;\n          \n          varying vec4 v_color;\n          void main() {\n            gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n            gl_PointSize = a_size;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;case"circle":e={vertexShader:"\n                  precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    attribute float a_radius;\n                    attribute mat3 a_transformMatrix;\n                    varying vec4 v_color;\n\n                    void main() {\n                      gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n                      gl_PointSize = a_radius; // * a_transform.z * u_transform.z;\n                      v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = dot(cxy, cxy);\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"image":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec2 a_texCoord;\n                    uniform mat3 u_transformMatrix;\n                    varying vec2 v_texCoord;\n\n                    void main() {\n                      gl_Position = vec4(u_transformMatrix * vec3(a_position, 1), 1);\n                      v_texCoord = a_texCoord;\n                    }\n          ",fragmentShader:"\n                    precision mediump float;\n                    uniform sampler2D u_image;\n                    uniform float u_opacity;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      vec4 col = texture2D(u_image, v_texCoord);\n                      if (col.a == 0.0) {\n                        discard;\n                      } else {\n                        gl_FragColor = col;\n                        gl_FragColor.a *= u_opacity;\n                      }\n                    }\n                    "};break;case"polyline":case"polygon":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    uniform mat3 u_transformMatrix;\n\n                    void main() {\n                      gl_Position = vec4(u_transformMatrix * vec3(a_position, 1), 1);\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    uniform vec4 u_color;\n                    void main() {\n                        gl_FragColor = u_color;\n                    }\n                    "};break;case"rect":case"line":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    attribute mat3 a_transformMatrix;\n                    varying vec4 v_color;\n\n                    void main() {\n                      gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n                      v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;default:e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    attribute mat3 a_transformMatrix;\n                    varying vec4 v_color;\n\n                    void main() {\n                      gl_Position = vec4(a_transformMatrix * vec3(a_position, 1), 1);\n                      v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "}}return e}var si=ci,hi=ci;function ci(t,e,r){r=r||2;var i,n,o,a,s,h,c,l=e&&e.length,d=l?e[0]*r:t.length,f=li(t,0,d,r,!0),u=[];if(!f||f.next===f.prev)return u;if(l&&(f=function(t,e,r,i){var n,o,a,s=[];for(n=0,o=e.length;n<o;n++)(a=li(t,e[n]*i,n<o-1?e[n+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),s.push(wi(a));for(s.sort(vi),n=0;n<s.length;n++)mi(s[n],r),r=di(r,r.next);return r}(t,e,f,r)),t.length>80*r){i=o=t[0],n=a=t[1];for(var p=r;p<d;p+=r)(s=t[p])<i&&(i=s),(h=t[p+1])<n&&(n=h),s>o&&(o=s),h>a&&(a=h);c=0!==(c=Math.max(o-i,a-n))?1/c:0}return fi(f,u,r,i,n,c),u}function li(t,e,r,i,n){var o,a;if(n===Pi(t,e,r,i)>0)for(o=e;o<r;o+=i)a=_i(o,t[o],t[o+1],a);else for(o=r-i;o>=e;o-=i)a=_i(o,t[o],t[o+1],a);return a&&ki(a,a.next)&&(zi(a),a=a.next),a}function di(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!ki(i,i.next)&&0!==Ti(i.prev,i,i.next))i=i.next;else{if(zi(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function fi(t,e,r,i,n,o,a){if(t){!a&&o&&function(t,e,r,i){var n=t;do{null===n.z&&(n.z=bi(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,a,s,h,c=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,i=r,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(h=c;s>0||h>0&&i;)0!==s&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,c*=2}while(a>1)}(n)}(t,i,n,o);for(var s,h,c=t;t.prev!==t.next;)if(s=t.prev,h=t.next,o?pi(t,i,n,o):ui(t))e.push(s.i/r),e.push(t.i/r),e.push(h.i/r),zi(t),t=h.next,c=h.next;else if((t=h)===c){a?1===a?fi(t=yi(di(t),e,r),e,r,i,n,o,2):2===a&&xi(t,e,r,i,n,o):fi(di(t),e,r,i,n,o,1);break}}}function ui(t){var e=t.prev,r=t,i=t.next;if(Ti(e,r,i)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(Bi(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&Ti(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function pi(t,e,r,i){var n=t.prev,o=t,a=t.next;if(Ti(n,o,a)>=0)return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,h=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,c=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,l=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,d=bi(s,h,e,r,i),f=bi(c,l,e,r,i),u=t.prevZ,p=t.nextZ;u&&u.z>=d&&p&&p.z<=f;){if(u!==t.prev&&u!==t.next&&Bi(n.x,n.y,o.x,o.y,a.x,a.y,u.x,u.y)&&Ti(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,p!==t.prev&&p!==t.next&&Bi(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ti(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;u&&u.z>=d;){if(u!==t.prev&&u!==t.next&&Bi(n.x,n.y,o.x,o.y,a.x,a.y,u.x,u.y)&&Ti(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&Bi(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ti(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function yi(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!ki(n,o)&&Ei(n,i,i.next,o)&&Di(n,o)&&Di(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),zi(i),zi(i.next),i=t=o),i=i.next}while(i!==t);return di(i)}function xi(t,e,r,i,n,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Ai(a,s)){var h=Mi(a,s);return a=di(a,a.next),h=di(h,h.next),fi(a,e,r,i,n,o),void fi(h,e,r,i,n,o)}s=s.next}a=a.next}while(a!==t)}function vi(t,e){return t.x-e.x}function mi(t,e){if(e=function(t,e){var r,i=e,n=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&s>a){if(a=s,s===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===a)return r;var h,c=r,l=r.x,d=r.y,f=1/0;i=r;do{n>=i.x&&i.x>=l&&n!==i.x&&Bi(o<d?n:a,o,l,d,o<d?a:n,o,i.x,i.y)&&(h=Math.abs(o-i.y)/(n-i.x),Di(i,t)&&(h<f||h===f&&(i.x>r.x||i.x===r.x&&gi(r,i)))&&(r=i,f=h)),i=i.next}while(i!==c);return r}(t,e)){var r=Mi(e,t);di(e,e.next),di(r,r.next)}}function gi(t,e){return Ti(t.prev,t,e.prev)<0&&Ti(e.next,t,t.next)<0}function bi(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wi(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Bi(t,e,r,i,n,o,a,s){return(n-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(n-a)*(i-s)>=0}function Ai(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Ei(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(Di(t,e)&&Di(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)&&(Ti(t.prev,t,e.prev)||Ti(t,e.prev,e))||ki(t,e)&&Ti(t.prev,t,t.next)>0&&Ti(e.prev,e,e.next)>0)}function Ti(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function ki(t,e){return t.x===e.x&&t.y===e.y}function Ei(t,e,r,i){var n=Ci(Ti(t,e,r)),o=Ci(Ti(t,e,i)),a=Ci(Ti(r,i,t)),s=Ci(Ti(r,i,e));return n!==o&&a!==s||(!(0!==n||!Si(t,r,e))||(!(0!==o||!Si(t,i,e))||(!(0!==a||!Si(r,t,i))||!(0!==s||!Si(r,e,i)))))}function Si(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ci(t){return t>0?1:t<0?-1:0}function Di(t,e){return Ti(t.prev,t,t.next)<0?Ti(t,e,t.next)>=0&&Ti(t,t.prev,e)>=0:Ti(t,e,t.prev)<0||Ti(t,t.next,e)<0}function Mi(t,e){var r=new Ii(t.i,t.x,t.y),i=new Ii(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function _i(t,e,r,i){var n=new Ii(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function zi(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ii(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pi(t,e,r,i){for(var n=0,o=e,a=r-i;o<r;o+=i)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}ci.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,a=Math.abs(Pi(t,0,o,r));if(n)for(var s=0,h=e.length;s<h;s++){var c=e[s]*r,l=s<h-1?e[s+1]*r:t.length;a-=Math.abs(Pi(t,c,l,r))}var d=0;for(s=0;s<i.length;s+=3){var f=i[s]*r,u=i[s+1]*r,p=i[s+2]*r;d+=Math.abs((t[f]-t[p])*(t[u+1]-t[f+1])-(t[f]-t[u])*(t[p+1]-t[f+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)},ci.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[n][o][a]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r},si.default=hi;var Oi,Li=F,Ni=x,Fi=mr.zoom(),Ri=mr.drag();var ji=0;function Xi(){return ji+=1}function Gi(t){var e={translateX:0,translateY:0,scaleX:1,scaleY:1,angle:0};return t&&(t.translate&&t.translate.length>0&&(e.translateX=t.translate[0],e.translateY=t.translate[1]),t.scale&&t.scale.length>0&&(e.scaleX=t.scale[0],e.scaleY=t.scale[1]||e.scaleX),t.rotate&&t.rotate.length>0&&(e.angle=t.rotate[0])),e}function Yi(){var t=this,e=t.attr,r=e.transform,i=e.points;void 0===i&&(i=[]);var n=Gi(r),o=n.translateX,a=n.translateY,s=n.scaleX,h=n.scaleY;if(i&&i.length>0){for(var c=i[0].x,l=i[0].x,d=i[0].y,f=i[0].y,u=1;u<i.length;u+=1)c>i[u].x&&(c=i[u].x),l<i[u].x&&(l=i[u].x),d>i[u].y&&(d=i[u].y),f<i[u].y&&(f=i[u].y);t.BBox={x:o+c*s,y:a+d*h,width:(l-c)*s,height:(f-d)*h}}else t.BBox={x:0,y:0,width:0,height:0};r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox}var Ui=function(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],a=t[4],s=t[5],h=t[6],c=t[7],l=t[8],d=e[0],f=e[1],u=e[2],p=e[3],y=e[4],x=e[5],v=e[6],m=e[7],g=e[8];return[d*r+f*o+u*h,d*i+f*a+u*c,d*n+f*s+u*l,p*r+y*o+x*h,p*i+y*a+x*c,p*n+y*s+x*l,v*r+m*o+g*h,v*i+m*a+g*c,v*n+m*s+g*l]},Hi=function(t,e,r){return r&&r[6]===t&&r[7]===e?r:[1,0,0,0,1,0,t,e,1]},Vi=function(t){var e=Math.cos(t),r=Math.sin(t);return[e,-r,0,r,e,0,0,0,1]},qi=function(t,e){return[t,0,0,0,e,0,0,0,1]},Zi=function(){return[1,0,0,0,1,0,0,0,1]},Wi=function(t,e){return[2/t,0,0,0,-2/e,0,-1,1,1]};function Qi(t){var e=this.attr.transform,r=t||this.projectionMatrix;if(e&&e.translate&&(this.translationMatrix=Hi(e.translate[0],e.translate[1],this.translationMatrix),r=Ui(r,this.translationMatrix)),e&&e.rotate){var i=Math.PI/180*e.rotate[0];this.rotationMatrix=Vi(i),this.rotationCentric=Hi(e.rotate[1]||0,e.rotate[2]||0,this.rotationCentric),r=Ui(r,this.rotationMatrix)}e&&e.scale&&(this.scaleMatrix=qi(e.scale[0],e.scale[1]),r=Ui(r,this.scaleMatrix)),this.rotationCentric&&(r=Ui(r,this.rotationCentric)),this.transformMatrix=r}var $i=function(){Ye.apply(this,arguments)};function Ji(t,e,r){var i=t.createShader(r);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(i);return console.error("*** Error compiling shader '"+i+"':"+n),t.deleteShader(i),null}return i}function Ki(t,e){return function(t,e){var r=t.createProgram();if(e.forEach((function(e){t.attachShader(r,e)})),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS)){var i=t.getProgramInfoLog(r);return console.error("Error in program linking:"+i),t.deleteProgram(r),null}return r}(t,[Ji(t,e.vertexShader,t.VERTEX_SHADER),Ji(t,e.fragmentShader,t.FRAGMENT_SHADER)])}function tn(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}function en(t,e,r){this.ctx=t,this.attr=e||{},this.style=r||{},this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}function rn(t,e,r){this.ctx=t,this.attr=e||{},this.style=r||{},this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}function nn(t,e,r){var i=this;this.ctx=t,this.attr=e,this.style=r,this.pointsGeometry=[],this.transform=[0,0,1,1],this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),i.attr.d&&(Mt.isTypePath(i.attr.d)?(i.path=i.attr.d,i.attr.d=i.attr.d.fetchPathString()):i.path=Mt.instance(i.attr.d),this.points=new Float32Array(this.path.getPoints())),this.style.stroke&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255])),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}function on(t,e,r){this.ctx=t,this.attr=e||{},this.style=r||{},this.points=[],this.transform=[0,0,1,1];var i=[];if(this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.attr.points){for(var n=this.attr.points,o=0,a=n.length;o<a;o++)i[2*o]=n[o].x,i[2*o+1]=n[o].y;this.points=new Float32Array(i)}this.style.stroke&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255])),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}function an(t,e,r){this.ctx=t,this.attr=e||{},this.style=r||{},this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}function sn(t){return si(t.reduce((function(t,e){return t[t.length]=e.x,t[t.length]=e.y,t}),[])).map((function(e){return t[e]}))}function hn(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.positionArray=[],this.transform=[0,0,1,1];var i=[];if(this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.attr.points){for(var n=sn(this.attr.points),o=0,a=n.length;o<a;o++)i[2*o]=n[o].x,i[2*o+1]=n[o].y;this.points=new Float32Array(i)}this.style.fill&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255])),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}function cn(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}($i.prototype=new Ye).constructor=$i,$i.prototype.createNode=function(t,e,r){return new Xn(t,e,Xi(),r)},tn.prototype.exec=function(t,e){"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,e)},tn.prototype.setStyle=function(t,e){e?(this.style[t]=e,this.shader&&"fill"===t&&(void 0!==this.style.opacity&&(e.a*=this.style.opacity),this.shader.indexBased&&this.shader.updateColor(this.pindex,e)),this.shader&&"opacity"===t&&(void 0!==this.style.fill&&(this.style.fill.a*=this.style.opacity),this.shader.updateColor(this.pindex,this.style.fill))):this.style[t]&&delete this.style[t]},tn.prototype.getAttr=function(t){return this.attr[t]},tn.prototype.getStyle=function(t){return this.style[t]},en.prototype=new tn,en.prototype.constructor=en,en.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.pindex),this.shader.addColors(this.style.fill||xn,this.pindex),this.shader.addSize(this.attr.size||0,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},en.prototype.setAttr=function(t,e){this.attr[t]=e,"transform"===t&&this.exec(Qi,this.p_matrix),this.shader&&("x"===t||"y"===t?this.shader.updateVertex(this.pindex,this.attr.x,this.attr.y):"size"===t?this.shader.updateSize(this.pindex,this.attr.size||0):"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix))},en.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},en.prototype.in=function(t){var e=this.attr,r=e.x;void 0===r&&(r=0);var i=e.y;void 0===i&&(i=0);var n=e.size;return void 0===n&&(n=0),t.x>=r&&t.x<=r+n&&t.y>=i&&t.y<=i+n},en.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x;void 0===i&&(i=0);var n=e.y;void 0===n&&(n=0);var o=e.size;void 0===o&&(o=0);var a=Gi(r),s=a.translateX,h=a.translateY,c=a.scaleX,l=a.scaleY;t.BBox={x:s+i*c,y:h+n*l,width:o*c,height:o*l},r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},rn.prototype=new tn,rn.prototype.constructor=rn,rn.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex),this.shader.addColors(this.style.fill||xn,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},rn.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},rn.prototype.setAttr=function(t,e){this.attr[t]=e,"transform"===t&&this.exec(Qi,this.p_matrix),this.shader&&("x"===t||"width"===t||"y"===t||"height"===t?this.shader.updateVertex(this.pindex,this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0):"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix))},rn.prototype.in=function(t){var e=this.attr,r=e.x;void 0===r&&(r=0);var i=e.y;void 0===i&&(i=0);var n=e.width;void 0===n&&(n=0);var o=e.height;return void 0===o&&(o=0),t.x>=r&&t.x<=r+n&&t.y>=i&&t.y<=i+o},rn.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x;void 0===i&&(i=0);var n=e.y;void 0===n&&(n=0);var o=e.width;void 0===o&&(o=0);var a=e.height;void 0===a&&(a=0);var s=Gi(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:h+i*l,y:c+n*d,width:o*l,height:a*d},r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},nn.prototype=new tn,nn.prototype.constructor=nn,nn.prototype.setShader=function(t){this.shader=t},nn.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t)},nn.prototype.setAttr=function(t,e){this.attr[t]=e,null!==e?"d"===t?(Mt.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=Mt.instance(this.attr.d),this.points=new Float32Array(this.path.getPoints())):"transform"===t&&this.exec(Qi,this.p_matrix):delete this.attr[t]},nn.prototype.updateBBox=function(){var t=this,e=t.attr.transform,r=Gi(e),i=r.translateX,n=r.translateY,o=r.scaleX,a=r.scaleY;t.BBox=t.path?t.path.BBox:{x:0,y:0,width:0,height:0},t.BBox.x=i+t.BBox.x*o,t.BBox.y=n+t.BBox.y*a,t.BBox.width*=o,t.BBox.height*=a,e&&e.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,e):t.BBoxHit=this.BBox},on.prototype=new tn,on.prototype.constructor=on,on.prototype.setShader=function(t){this.shader=t},on.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t)},on.prototype.setAttr=function(t,e){if(this.attr[t]=e,"points"===t){for(var r=this.attr.points,i=[],n=0,o=r.length;n<o;n++)i[2*n]=r[n].x,i[2*n+1]=r[n].y;this.points=new Float32Array(i)}else"transform"===t&&this.exec(Qi,this.p_matrix)},on.prototype.updateBBox=Yi,on.prototype.setStyle=function(t,e){this.style[t]=e,"stroke"===t&&(this.color=new Float32Array([this.style.stroke.r/255,this.style.stroke.g/255,this.style.stroke.b/255,void 0===this.style.stroke.a?1:this.style.stroke.a/255]))},an.prototype=new tn,an.prototype.constructor=an,an.prototype.setShader=function(t){this.shader=t;var e=this.attr,r=e.x1;void 0===r&&(r=0);var i=e.y1;void 0===i&&(i=0);var n=e.x2;void 0===n&&(n=r);var o=e.y2;void 0===o&&(o=i),this.shader&&(this.shader.addVertex(r,i,n,o,this.pindex),this.shader.addColors(this.style.stroke||xn,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},an.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},an.prototype.setAttr=function(t,e){this.attr[t]=e,null!==e||null===this.attr[t]?("transform"===t&&this.exec(Qi,this.p_matrix),!this.shader||"x1"!==t&&"y1"!==t&&"x2"!==t&&"y2"!==t?this.shader&&"transform"===t&&this.shader.updateTransform(this.pindex,this.transformMatrix):this.shader.updateVertex(this.pindex,this.attr.x1,this.attr.y1,this.attr.x2,this.attr.y2)):delete this.attr[t]},an.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x1;void 0===i&&(i=0);var n=e.y1;void 0===n&&(n=0);var o=e.x2;void 0===o&&(o=0);var a=e.y2;void 0===a&&(a=0);var s=Gi(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:h+(i<o?i:o)*l,y:c+(n<a?n:a)*d,width:Math.abs(o-i)*l,height:Math.abs(a-n)*d},r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},hn.prototype=new tn,hn.prototype.constructor=hn,hn.prototype.setShader=function(t){this.shader=t},hn.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t)},hn.prototype.setAttr=function(t,e){if(this.attr[t]=e,null!==e)if("points"===t){for(var r=[],i=sn(e),n=0,o=i.length;n<o;n++)r[2*n]=i[n].x,r[2*n+1]=i[n].y;this.points=new Float32Array(r)}else"transform"===t&&this.exec(Qi,this.p_matrix);else delete this.attr[t]},hn.prototype.setStyle=function(t,e){this.style[t]=e,"fill"===t&&(this.color=new Float32Array([this.style.fill.r/255,this.style.fill.g/255,this.style.fill.b/255,void 0===this.style.fill.a?1:this.style.fill.a/255]))},hn.prototype.updateBBox=Yi,cn.prototype=new tn,cn.prototype.constructor=cn,cn.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.cx||0,this.attr.cy||0,this.pindex),this.shader.addColors(this.style.fill||xn,this.pindex),this.shader.addSize(this.attr.r||0,this.pindex),this.shader.addTransform(this.transformMatrix,this.pindex))},cn.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t),this.shader&&this.shader.addTransform(this.transformMatrix,this.pindex)},cn.prototype.setAttr=function(t,e){this.attr[t]=e,null!==e?("transform"===t&&this.exec(Qi,this.p_matrix),"cx"!==t&&"cy"!==t||!this.shader?"r"===t&&this.shader?this.shader.updateSize(this.pindex,this.attr.r||0):"transform"===t&&this.shader&&this.shader.updateTransform(this.pindex,this.transformMatrix):this.shader.updateVertex(this.pindex,this.attr.cx,this.attr.cy)):delete this.attr[t]},cn.prototype.in=function(t,e){var r=this.attr,i=r.r;void 0===i&&(i=0);var n=r.cx;void 0===n&&(n=0);var o=r.cy;return void 0===o&&(o=0),Math.sqrt((t.x-n)*(t.x-n)+(t.y-o)*(t.y-o))<=i},cn.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.r;void 0===i&&(i=0);var n=e.cx;void 0===n&&(n=0);var o=e.cy;void 0===o&&(o=0);var a=Gi(r),s=a.translateX,h=a.translateY,c=a.scaleX,l=a.scaleY;t.BBox={x:s+(n-i)*c,y:h+(o-i)*l,width:2*i*c,height:2*i*l},r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox};var ln={};function dn(t){return 0==(t&t-1)}function fn(t,e){var r=document.createElement("canvas"),i=r.getContext("2d");(e=e||{fill:"#fff"}).font||(e.font="10px Arial");var n=parseFloat(e.font,10)||12;i.font=e.font;var o=i.measureText(t).width,a=n;for(var s in r.setAttribute("height",a*Oi),r.setAttribute("width",o*Oi),r.style.width=o,r.style.height=a,e.font=n*Oi+(isNaN(parseFloat(e.font,10))?e.font:e.font.substring(n.toString().length)),e)i[s]=e[s];return i.fillText(t,0,.75*a*Oi),{dom:r,ctx:i,width:o,height:a,ratio:Oi,style:e,str:t,updateText:function(){for(var t in function(t,e,r,i){t.clearRect(0,0,e*i,r*i)}(this.ctx,this.width,this.height,this.ratio),this.style)this.ctx[t]=this.style[t];this.ctx.fillText(this.str,0,.75*this.height)}}}function un(t,e,r,i){var n=this;this.ctx=t,this.attr=e,this.style=r,this.vDomIndex=i,this.positionArray=new Float32Array(12),this.transform=[0,0,1,1],this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null),n.attr.text&&"string"==typeof n.attr.text&&(this.text=fn(n.attr.text,n.style),this.attr.width=this.text.width,this.attr.height=this.text.height),this.text&&(this.textureNode=new Un(t,{src:this.text.dom},this.vDomIndex))}function pn(t,e,r,i){var n=this;if(this.ctx=t,this.attr=e,this.style=r,this.vDomIndex=i,this.positionArray=new Float32Array(12),this.transform=[0,0,1,1],this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null),n.attr.src&&"string"==typeof n.attr.src&&!ln[n.attr.src]?(this.textureNode=new Un(t,{src:this.attr.src},this.vDomIndex),ln[n.attr.src]=this.textureNode):n.attr.src&&n.attr.src instanceof je?this.textureNode=new Un(t,{src:this.attr.src},this.vDomIndex):"string"==typeof n.attr.src&&ln[n.attr.src]?this.textureNode=ln[n.attr.src]:n.attr.src&&n.attr.src instanceof Un&&(this.textureNode=n.attr.src),this.attr.x||this.attr.y||this.attr.width||this.attr.height){var o=this.attr.x||0,a=this.attr.y||0,s=o+(this.attr.width||0),h=a+(this.attr.height||0);this.positionArray[0]=this.positionArray[4]=this.positionArray[6]=o,this.positionArray[1]=this.positionArray[3]=this.positionArray[9]=a,this.positionArray[2]=this.positionArray[8]=this.positionArray[10]=s,this.positionArray[5]=this.positionArray[7]=this.positionArray[11]=h}}function yn(t,e,r,i,n){this.ctx=t,this.attr=e,this.style=r,this.renderTarget=i,this.vDomIndex=n,e.shaderType&&(this.shader=jn(t,e,r,e.shaderType,this.renderTarget,n)),this.projectionMatrix=Wi(this.ctx.canvas.width/Oi,this.ctx.canvas.height/Oi),this.transformMatrix=Ui(this.projectionMatrix,Zi()),this.attr.transform&&this.exec(Qi,null)}un.prototype=new tn,un.prototype.constructor=un,un.prototype.setShader=function(t){this.shader=t},un.prototype.setAttr=function(t,e){if(this.attr[t]=e,null!==e){if("text"===t&&"string"==typeof e&&(this.text?this.text=fn(this.attr.text,this.style):this.text=fn(e,this.style),this.attr.width=this.text.width,this.attr.height=this.text.height,this.textureNode?this.textureNode.setAttr("src",this.text.dom):this.textureNode=new Un(this.ctx,{src:this.text.dom},this.vDomIndex)),"transform"===t)this.exec(Qi,this.p_matrix);else if("x"===t||"y"===t){var r=this.attr.x||0,i=this.attr.y||0,n=r+(this.attr.width||0),o=i+(this.attr.height||0);this.positionArray[0]=this.positionArray[4]=this.positionArray[6]=r,this.positionArray[1]=this.positionArray[3]=this.positionArray[9]=i,this.positionArray[2]=this.positionArray[8]=this.positionArray[10]=n,this.positionArray[5]=this.positionArray[7]=this.positionArray[11]=o}}else delete this.attr[t]},un.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t)},un.prototype.setStyle=function(t,e){if(this.style[t]=e,this.text)if(this.text.style[t]=e,"font"===t){var r=parseFloat(e,10)||12;this.text.ctx.font=e;var i=this.text.ctx.measureText(this.attr.text).width,n=r;this.text.style.font=r*Oi+(isNaN(parseFloat(e,10))?this.style.font:this.style.font.substring(r.toString().length)),this.text.updateText(),this.text.dom.setAttribute("height",n*Oi),this.text.dom.setAttribute("width",i*Oi),this.attr.width=i,this.attr.height=n,this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0)}else this.text.style[t]=e,this.text.updateText(),this.textureNode.setAttr("src",this.text.dom)},un.prototype.getAttr=function(t){return this.attr[t]},un.prototype.getStyle=function(t){return this.style[t]},un.prototype.in=function(t){var e=this.attr,r=e.width;void 0===r&&(r=0);var i=e.height;void 0===i&&(i=0);var n=e.x;void 0===n&&(n=0);var o=e.y;return void 0===o&&(o=0),t.x>=n&&t.x<=n+r&&t.y>=o&&t.y<=o+i},un.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x;void 0===i&&(i=0);var n=e.y;void 0===n&&(n=0);var o=e.width;void 0===o&&(o=0);var a=e.height;void 0===a&&(a=0);var s=Gi(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:(h+i)*l,y:(c+n)*d,width:o*l,height:a*d},r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},pn.prototype=new tn,pn.prototype.constructor=pn,pn.prototype.setShader=function(t){this.shader=t},pn.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t)},pn.prototype.setAttr=function(t,e){if(this.attr[t]=e,null!==e)if("src"===t&&"string"==typeof e)e&&!ln[e]?(this.textureNode=new Un(this.ctx,{src:e},this.vDomIndex),ln[e]=this.textureNode):e&&ln[e]&&(this.textureNode=ln[e]);else if("src"===t&&e instanceof je)this.textureNode=new Un(this.ctx,{src:e},this.vDomIndex);else if("src"===t&&e instanceof Un)this.textureNode=e;else if("x"===t||"width"===t||"y"===t||"height"===t){var r=this.attr.x||0,i=this.attr.y||0,n=r+(this.attr.width||0),o=i+(this.attr.height||0);this.positionArray[0]=this.positionArray[4]=this.positionArray[6]=r,this.positionArray[1]=this.positionArray[3]=this.positionArray[9]=i,this.positionArray[2]=this.positionArray[8]=this.positionArray[10]=n,this.positionArray[5]=this.positionArray[7]=this.positionArray[11]=o}else"transform"===t&&this.exec(Qi,this.p_matrix);else delete this.attr[t]},pn.prototype.setStyle=function(t,e){e?this.style[t]=e:this.style[t]&&delete this.style[t]},pn.prototype.getAttr=function(t){return this.attr[t]},pn.prototype.getStyle=function(t){return this.style[t]},pn.prototype.in=function(t){var e=this.attr,r=e.width;void 0===r&&(r=0);var i=e.height;void 0===i&&(i=0);var n=e.x;void 0===n&&(n=0);var o=e.y;return void 0===o&&(o=0),t.x>=n&&t.x<=n+r&&t.y>=o&&t.y<=o+i},pn.prototype.updateBBox=function(){var t=this,e=t.attr,r=e.transform,i=e.x;void 0===i&&(i=0);var n=e.y;void 0===n&&(n=0);var o=e.width;void 0===o&&(o=0);var a=e.height;void 0===a&&(a=0);var s=Gi(r),h=s.translateX,c=s.translateY,l=s.scaleX,d=s.scaleY;t.BBox={x:(h+i)*l,y:(c+n)*d,width:o*l,height:a*d},r&&r.rotate?t.BBoxHit=Li.rotateBBox(this.BBox,r):t.BBoxHit=this.BBox},yn.prototype=new tn,yn.prototype.constructor=yn,yn.prototype.applyTransformationMatrix=function(t){this.p_matrix=t,this.exec(Qi,t),this.transformMatrix=Ui(this.transformMatrix,t)},yn.prototype.setAttr=function(t,e){this.attr[t]=e,"shaderType"===t&&(this.shader=jn(this.ctx,this.attr,this.style,e,this.renderTarget,this.vDomIndex)),"transform"===t&&this.exec(Qi,this.p_matrix)},yn.prototype.setShader=function(){},yn.prototype.in=function(t){var e=t.x,r=t.y,i=this.BBox,n=Gi(this.attr.transform),o=n.translateX,a=n.translateY,s=n.scaleX,h=n.scaleY;return e>=(i.x-o)/s&&e<=(i.x-o+i.width)/s&&r>=(i.y-a)/h&&r<=(i.y-a+i.height)/h},yn.prototype.updateBBox=function(t){var e,r,i,n,o=this,a=Gi(o.attr.transform),s=a.translateX,h=a.translateY,c=a.scaleX,l=a.scaleY;if(o.BBox={},t&&t.length>0)for(var d,f,u,p=0;p<t.length;p+=1)(d=t[p])&&(f=d.dom.BBoxHit.x,u=d.dom.BBoxHit.y,e=void 0===e||e>f?f:e,i=void 0===i||i>u?u:i,r=void 0===r||r<f+d.dom.BBoxHit.width?f+d.dom.BBoxHit.width:r,n=void 0===n||n<u+d.dom.BBoxHit.height?u+d.dom.BBoxHit.height:n);e=void 0===e?0:e,i=void 0===i?0:i,r=void 0===r?0:r,n=void 0===n?0:n,o.BBox.x=s+e*c,o.BBox.y=h+i*l,o.BBox.width=Math.abs(r-e)*c,o.BBox.height=Math.abs(n-i)*l,o.attr.transform&&o.attr.transform.rotate?o.BBoxHit=Li.rotateBBox(this.BBox,this.attr.transform):o.BBoxHit=this.BBox};var xn=Rt.rgba(0,0,0,255);function vn(t,e,r,i){var n=i.type;n||(n="FLOAT",i.value instanceof Float32Array?n="FLOAT":i.value instanceof Int8Array?n="BYTE":i.value instanceof Int16Array?n="SHORT":i.value instanceof Uint8Array?n="UNSIGNED_BYTE":i.value instanceof Uint16Array&&(n="UNSIGNED_SHORT"));var o=t.createBuffer(),a={bufferType:t.ARRAY_BUFFER,buffer:o,drawType:t.STATIC_DRAW,valueType:t[n],size:i.size,attributeLocation:t.getAttribLocation(e,r),value:i.value,attr:r};return t.bindBuffer(a.bufferType,a.buffer),t.bufferData(a.bufferType,a.value,a.drawType),a}function mn(t,e,r,i){var n,o=i.size?i.size:i.value.length;return i.matrix?Number.isInteger(Math.sqrt(i.value.length))?n="uniformMatrix"+Math.sqrt(i.value.length)+"fv":console.error("Not Square Matrix"):i.value instanceof Un?n="uniform1i":i.value instanceof Float32Array?n="uniform"+o+"fv":i.value instanceof Int8Array||i.value instanceof Int16Array||i.value instanceof Uint8Array?n="uniform"+o+"iv":Number.isInteger(i.value)?Number.isInteger(i.value)&&(n="uniform1i"):n="uniform1f",{matrix:i.matrix,transpose:void 0!==i.transpose&&i.transpose,type:n,value:i.value,uniformLocation:t.getUniformLocation(e,r)}}function gn(t,e,r){for(var i in this.ctx=t,this.dom={BBoxHit:{x:0,y:0,height:0,width:0}},this.shader=e,this.vDomIndex=r,this.program=Ki(t,e),this.uniforms={},this.attr={},this.attrObjs={},this.indexesObj=null,this.preDraw=e.preDraw,this.postDraw=e.postDraw,this.geometry=e.geometry,this.renderTarget=e.renderTarget,e.uniforms)this.uniforms[i]=mn(t,this.program,i,e.uniforms[i]);for(var n in this.geometry&&(this.geometry instanceof qn||this.geometry instanceof Zn||this.geometry instanceof Wn?(this.attributes=this.geometry.attributes,this.indexes=this.geometry.indexes):console.error("Wrong Geometry type")),this.attributes)this.attrObjs[n]=vn(t,this.program,n,this.attributes[n]);this.indexes&&(this.indexesObj=function(t,e,r){var i="FLOAT";return r.value instanceof Float32Array?i="FLOAT":r.value instanceof Int8Array?i="BYTE":r.value instanceof Int16Array?i="SHORT":r.value instanceof Uint8Array?i="UNSIGNED_BYTE":r.value instanceof Uint16Array&&(i="UNSIGNED_SHORT"),{bufferType:t.ELEMENT_ARRAY_BUFFER,buffer:t.createBuffer(),drawType:t.STATIC_DRAW,valueType:t[i],value:r.value,count:r.count,offset:r.offset}}(t,this.program,this.indexes))}function bn(){}function wn(t,e,r,i){t.transform=t.transformTyped&&t.transformTyped.length>0?Array.from(t.transformTyped):t.transform,t.transformTyped=null;for(var n=e*r*9,o=0;o<r;)t.transform[n+9*o]=i[0],t.transform[n+9*o+1]=i[1],t.transform[n+9*o+2]=i[2],t.transform[n+9*o+3]=i[3],t.transform[n+9*o+4]=i[4],t.transform[n+9*o+5]=i[5],t.transform[n+9*o+6]=i[6],t.transform[n+9*o+7]=i[7],t.transform[n+9*o+8]=i[8],o++;t.addTransform_=!0,t.transformUpdate=!0}function Bn(t,e,r,i){for(var n=t.addTransform_?t.transform:t.transformTyped,o=e*r*9,a=0;a<r;)n[o+9*a]=i[0],n[o+9*a+1]=i[1],n[o+9*a+2]=i[2],n[o+9*a+3]=i[3],n[o+9*a+4]=i[4],n[o+9*a+5]=i[5],n[o+9*a+6]=i[6],n[o+9*a+7]=i[7],n[o+9*a+8]=i[8],a++;t.updateTransform_=!0}function An(t,e,r){for(var i=t.addTransform_?t.transform:t.transformTyped,n=e*r*9,o=0;o<r;)i[n+9*o]=void 0,i[n+9*o+1]=void 0,i[n+9*o+2]=void 0,i[n+9*o+3]=void 0,i[n+9*o+4]=void 0,i[n+9*o+5]=void 0,i[n+9*o+6]=void 0,i[n+9*o+7]=void 0,i[n+9*o+8]=void 0,o++;t.clearTransform_=!0,t.filterTransformUpdate=!0}function Tn(t){t.addTransform_&&(t.clearTransform_&&(t.transform=t.transform.filter((function(t){return!isNaN(t)})),t.clearTransform_=!1),t.transformTyped=new Float32Array(t.transform),t.transform=[],t.addTransform_=!1,t.updateTransform_=!1,t.shaderInstance.setAttributeData("a_transformMatrix",t.transformTyped)),t.clearTransform_&&(t.transformTyped=t.transformTyped.filter((function(t){return!isNaN(t)})),t.clearTransform_=!1,t.shaderInstance.setAttributeData("a_transformMatrix",t.transformTyped)),t.updateTransform_&&(t.shaderInstance.setAttributeData("a_transformMatrix",t.transformTyped),t.updateTransform_=!1)}function kn(t,e,r,i){t.positionArray=t.typedPositionArray&&t.typedPositionArray.length>0?Array.from(t.typedPositionArray):t.positionArray,t.typedPositionArray=null;for(var n=e*r*2,o=0;o<i.length;)t.positionArray[n+o]=i[o],o++;t.addVertex_=!0}function En(t,e,r,i){var n=t.addVertex_?t.positionArray:t.typedPositionArray,o=e*r*2,a=0;for(isNaN(n[o])&&console.log("overriding Nan");a<i.length;)n[o+a]=i[a],a++;t.updateVertex_=!0}function Sn(t,e,r){for(var i=t.addVertex_?t.positionArray:t.typedPositionArray,n=e*r*2,o=0;o<r;)i[n+2*o]=void 0,i[n+2*o+1]=void 0,o++;t.filterVertex_=!0}function Cn(t){t.addVertex_&&(t.filterVertex_&&(t.positionArray=t.positionArray.filter((function(t){return!isNaN(t)})),t.filterVertex_=!1),t.typedPositionArray=new Float32Array(t.positionArray),t.positionArray=[],t.addVertex_=!1,t.updateVertex_=!1,t.shaderInstance.setAttributeData("a_position",t.typedPositionArray)),t.filterVertex_&&(t.typedPositionArray=t.typedPositionArray.filter((function(t){return!isNaN(t)})),t.filterVertex_=!1,t.shaderInstance.setAttributeData("a_position",t.typedPositionArray)),t.updateVertex_&&(t.shaderInstance.setAttributeData("a_position",t.typedPositionArray),t.updateVertex_=!1)}function Dn(t,e,r,i){t.colorArray=t.typedColorArray&&t.typedColorArray.length>0?Array.from(t.typedColorArray):t.colorArray,t.typedColorArray=null;var n=e*r*4,o=0;for(i=Rt.colorToRGB(i);o<r;)t.colorArray[n+4*o]=i.r/255,t.colorArray[n+4*o+1]=i.g/255,t.colorArray[n+4*o+2]=i.b/255,t.colorArray[n+4*o+3]=void 0===i.a?1:i.a/255,o++;t.addColor_=!0}function Mn(t,e,r,i){var n=t.addColor_?t.colorArray:t.typedColorArray;isNaN(n[e*r*4])&&console.log("overriding Nan");for(var o=e*r*4,a=0;a<r;)n[o+4*a]=i.r/255,n[o+4*a+1]=i.g/255,n[o+4*a+2]=i.b/255,n[o+4*a+3]=void 0===i.a?1:i.a/255,a++;t.updateColor_=!0}function _n(t,e,r){var i=t.addColor_?t.colorArray:t.typedColorArray;isNaN(i[e*r*4])&&console.log("overriding Nan");for(var n=e*r*4,o=0;o<r;)i[n+4*o]=void 0,i[n+4*o+1]=void 0,i[n+4*o+2]=void 0,i[n+4*o+3]=void 0,o++;t.filterColor_=!0}function zn(t){t.addColor_&&(t.filterColor_&&(t.colorArray=t.colorArray.filter((function(t){return!isNaN(t)})),t.filterColor_=!1),t.typedColorArray=new Float32Array(t.colorArray),t.colorArray=[],t.addColor_=!1,t.updateColor_=!1,t.shaderInstance.setAttributeData("a_color",t.typedColorArray)),t.filterColor_&&(t.typedColorArray=t.typedColorArray.filter((function(t){return!isNaN(t)})),t.shaderInstance.setAttributeData("a_color",t.typedColorArray),t.filterColor_=!1),t.updateColor_&&(t.shaderInstance.setAttributeData("a_color",t.typedColorArray),t.updateColor_=!1)}function In(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.indexBased=!0,this.transform=[],this.selftransform=[0,0,1,1],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Zn,this.geometry.setAttr("a_color",{value:new Float32Array([]),size:4}),this.geometry.setAttr("a_size",{value:new Float32Array([]),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.shaderInstance=new gn(t,{fragmentShader:ai("point").fragmentShader,vertexShader:ai("point").vertexShader,uniforms:{},geometry:this.geometry},i),this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.transform=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.sizeUpdate=!0,this.transformUpdate=!0}function Pn(t,e,r,i,n){this.ctx=t,this.dom={},this.positionArray=[],this.colorArray=[],this.transform=[],this.rotate=[],this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.renderTarget=i,this.indexBased=!0,this.selftransform=[0,0,1,1],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new qn,this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new gn(t,{fragmentShader:ai("rect").fragmentShader,vertexShader:ai("rect").vertexShader,uniforms:{},geometry:this.geometry},n)}function On(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.transform=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.renderTarget=i,this.indexBased=!0,this.selftransform=new Float32Array([0,0,1,1]),this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Wn,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new gn(t,{fragmentShader:ai("line").fragmentShader,vertexShader:ai("line").vertexShader,uniforms:{},geometry:this.geometry},n)}function Ln(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.renderTarget=i,this.indexBased=!1,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]});var o=Gi(this.attr.transform),a=o.translateX,s=o.translateY,h=o.scaleX,c=o.scaleY;this.transform=new Float32Array([a,s,h,c]),this.geometry=new Wn,this.geometry.drawType="LINE_STRIP",this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new gn(t,{fragmentShader:ai("polyline").fragmentShader,vertexShader:ai("polyline").vertexShader,uniforms:{u_transformMatrix:{value:new Float32Array(Zi()),matrix:!0},u_color:{value:new Float32Array(4)}},geometry:this.geometry},n)}function Nn(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.colorArray=[],this.positionArray=[],this.renderTarget=i,this.indexBased=!1,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]});var o=Gi(this.attr.transform),a=o.translateX,s=o.translateY,h=o.scaleX,c=o.scaleY;this.transform=new Float32Array([a,s,h,c]),this.geometry=new qn,this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.shaderInstance=new gn(t,{fragmentShader:ai("polygon").fragmentShader,vertexShader:ai("polygon").vertexShader,uniforms:{u_transformMatrix:{value:new Float32Array(Zi()),matrix:!0},u_color:{value:new Float32Array(4)}},geometry:this.geometry},n)}function Fn(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.transform=[],this.pointsSize=[],this.renderTarget=i,this.indexBased=!0,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Zn,this.geometry.setAttr("a_transformMatrix",{value:new Float32Array(this.transform),size:3}),this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_radius",{value:new Float32Array(this.pointsSize),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,0),this.shaderInstance=new gn(t,{fragmentShader:ai("circle").fragmentShader,vertexShader:ai("circle").vertexShader,uniforms:{},geometry:this.geometry},n)}function Rn(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.textCoor=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.renderTarget=i,this.indexBased=!1,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new qn,this.geometry.setAttr("a_texCoord",{value:this.textCoor,size:2}),this.geometry.setAttr("a_position",{value:new Float32Array([0,0]),size:2}),this.geometry.setDrawRange(0,6),this.shaderInstance=new gn(t,{fragmentShader:ai("image").fragmentShader,vertexShader:ai("image").vertexShader,uniforms:{u_transformMatrix:{value:new Float32Array(Zi()),matrix:!0},u_image:{value:new Un(this.ctx,{},this.vDomIndex)},u_opacity:{value:1..toFixed(2)}},geometry:this.geometry},n),this.positionArray=[],this.vertexUpdate=!0}function jn(t,e,r,i,n,o){var a;switch(i){case"rect":a=new Pn(t,e,r,n,o);break;case"point":a=new In(t,e,r,n,o);break;case"line":a=new On(t,e,r,n,o);break;case"polyline":case"path":a=new Ln(t,e,r,n,o);break;case"polygon":a=new Nn(t,e,r,n,o);break;case"circle":a=new Fn(t,e,r,n,o);break;case"image":case"text":a=new Rn(t,e,r,n,o);break;default:a=null}return a}function Xn(t,e,r,i){switch(this.ctx=t,this.style=e.style||{},this.attr=e.attr||{},this.id=r,this.nodeName=e.el,this.nodeType="WEBGL",this.children=[],this.ctx=t,this.vDomIndex=i,this.el=e.el,this.shaderType=e.shaderType,this.exeCtx=e.ctx,this.bbox=void 0===e.bbox||e.bbox,this.events={},e.el){case"point":this.dom=new en(this.ctx,this.attr,this.style);break;case"rect":this.dom=new rn(this.ctx,this.attr,this.style);break;case"line":this.dom=new an(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new on(this.ctx,this.attr,this.style);break;case"polygon":this.dom=new hn(this.ctx,this.attr,this.style);break;case"path":this.dom=new nn(this.ctx,this.attr,this.style);break;case"circle":this.dom=new cn(this.ctx,this.attr,this.style);break;case"image":this.dom=new pn(this.ctx,this.attr,this.style,i);break;case"text":this.dom=new un(this.ctx,this.attr,this.style,i);break;case"group":this.dom=new yn(this.ctx,this.attr,this.style,e.renderTarget,i);break;default:this.dom=null}this.dom.nodeExe=this,this.dom instanceof yn||(delete this.createEl,delete this.createEls)}function Gn(t){var e=new Image;return e.crossOrigin="anonymous",e.onload=function(){t.update(),t.updated=!0,Ni.vDomChanged(t.vDomIndex)},e.onerror=function(t){},e}function Yn(t,e){return new Uint8Array(new ArrayBuffer(t*e*4))}function Un(t,e,r){var i=this,n=t.getParameter(t.MAX_TEXTURE_SIZE);this.ctx=t,this.texture=t.createTexture(),this.type="TEXTURE_2D",this.width=e.width>n?n:e.width,this.height=e.height>n?n:e.height,this.border=e.border?e.border:0,this.format=e.format?e.format:"RGBA",this.type=e.type?e.type:"UNSIGNED_BYTE",this.warpS=e.warpS?e.warpS:"CLAMP_TO_EDGE",this.warpT=e.warpT?e.warpT:"CLAMP_TO_EDGE",this.magFilter=e.magFilter?e.magFilter:"LINEAR",this.minFilter=e.minFilter?e.minFilter:"LINEAR",this.mipMap=e.mipMap,this.updated=!1,this.image=null,this.vDomIndex=r,"string"==typeof e.src?(i.image=Gn(i),i.image.src=e.src):e.src instanceof HTMLImageElement||e.src instanceof SVGImageElement||e.src instanceof HTMLCanvasElement||e.src instanceof Uint8Array?(i.image=e.src,i.update(),i.updated=!0):e.src instanceof je?(i.image=e.src.domEl,i.update(),i.updated=!0):(this.width&&this.height&&(i.image=Yn(this.width,this.height),i.update()),i.updated=!0),Ni.vDomChanged(i.vDomIndex)}function Hn(t,e){this.ctx=t,this.fbo=t.createFramebuffer(),this.texture=e.texture,this.texture.updated||this.texture.update()}function Vn(){}function qn(t){this.attributes={},this.drawType="TRIANGLES",this.indexes=null,this.drawRange=[0,0]}function Zn(t){this.attributes={},this.drawType="POINTS",this.indexes=null,this.drawRange=[0,0]}function Wn(t){this.attributes={},this.drawType="LINES",this.indexes=null,this.drawRange=[0,0]}gn.prototype=new bn,gn.prototype.constructor=gn,gn.prototype.useProgram=function(){this.ctx.useProgram(this.program)},gn.prototype.applyUniforms=function(){for(var t in this.uniforms)this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.uniforms[t].value instanceof Un?(this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value.texture),this.uniforms[t].value.loadTexture()):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value)},gn.prototype.applyAttributes=function(){var t;for(var e in this.attrObjs)t=this.attrObjs[e],"a_transformMatrix"===e?(this.ctx.enableVertexAttribArray(t.attributeLocation+0),this.ctx.enableVertexAttribArray(t.attributeLocation+1),this.ctx.enableVertexAttribArray(t.attributeLocation+2),this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.vertexAttribPointer(t.attributeLocation+0,t.size,t.valueType,!1,4*t.size*3,0),this.ctx.vertexAttribPointer(t.attributeLocation+1,t.size,t.valueType,!1,4*t.size*3,12),this.ctx.vertexAttribPointer(t.attributeLocation+2,t.size,t.valueType,!1,4*t.size*3,24)):(this.ctx.enableVertexAttribArray(t.attributeLocation),this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.vertexAttribPointer(t.attributeLocation,t.size,t.valueType,!1,0,0))},gn.prototype.applyIndexes=function(){var t=this.indexesObj;this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.bufferData(t.bufferType,t.value,t.drawType)},gn.prototype.draw=function(){this.ctx.drawArrays(this.ctx[this.geometry.drawType],this.geometry.drawRange[0],this.geometry.drawRange[1])},gn.prototype.drawElements=function(){this.ctx.drawElements(this.ctx[this.geometry.drawType],this.indexesObj.count,this.indexesObj.type?this.indexesObj.type:this.ctx.UNSIGNED_SHORT,this.indexesObj.offset)},gn.prototype.updateBBox=function(t){return!0},gn.prototype.execute=function(){this.ctx.useProgram(this.program),this.applyUniforms(),this.applyAttributes(),this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),this.indexesObj?(this.applyIndexes(),this.drawElements()):this.draw(),this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},gn.prototype.addUniform=function(t,e){this.uniforms[t]=mn(this.ctx,this.program,t,e),Ni.vDomChanged(this.vDomIndex)},gn.prototype.addAttribute=function(t,e){this.attributes[t]=e,this.attrObjs[t]=vn(this.ctx,this.program,t,e),Ni.vDomChanged(this.vDomIndex)},gn.prototype.setAttributeData=function(t,e){var r=this.attrObjs[t];this.attributes[t].value=e,this.attrObjs[t].value=e,this.ctx.bindBuffer(r.bufferType,r.buffer),this.ctx.bufferData(r.bufferType,r.value,r.drawType),Ni.vDomChanged(this.vDomIndex)},gn.prototype.applyAttributeData=function(t,e){this.attributes[t].value=e,this.attrObjs[t].value=e;var r=this.attrObjs[t];this.ctx.bindBuffer(r.bufferType,r.buffer),this.ctx.bufferData(r.bufferType,this.attributes[r.attr].value,r.drawType),this.ctx.enableVertexAttribArray(r.attributeLocation),this.ctx.vertexAttribPointer(r.attributeLocation,r.size,r.valueType,!1,0,0)},gn.prototype.setUniformData=function(t,e){this.uniforms[t].value=e,Ni.vDomChanged(this.vDomIndex)},gn.prototype.applyUniformData=function(t,e){this.uniforms[t].value=e,this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value)},bn.prototype.setAttr=function(t,e){if(this.attr[t]=e,"transform"===t){var r=Gi(this.attr.transform),i=r.translateX,n=r.translateY,o=r.scaleX,a=r.scaleY;this.selftransform=new Float32Array([i,n,o,a])}},bn.prototype.translate=function(t){this.attr.transform.translate=t},bn.prototype.scale=function(t){this.attr.transform.scale=t},bn.prototype.rotate=function(t){this.attr.transform.rotate=t},In.prototype=new bn,In.prototype.constructor=In,In.prototype.clear=function(t){_n(this,t,1),Sn(this,t,1),An(this,t,1),(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterSizeFlag=!0},In.prototype.addTransform=function(t,e){wn(this,e,1,t)},In.prototype.updateTransform=function(t,e){Bn(this,t,1,e)},In.prototype.updateVertex=function(t,e,r){En(this,t,1,[e,r])},In.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},In.prototype.updateColor=function(t,e){Mn(this,t,1,e)},In.prototype.addVertex=function(t,e,r){kn(this,r,1,[t,e])},In.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},In.prototype.addColors=function(t,e){Dn(this,e,1,t)},In.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),Cn(this),zn(this),Tn(this),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setAttributeData("a_size",this.typedSizeArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update()},Pn.prototype=new bn,Pn.prototype.constructor=Pn,Pn.prototype.clear=function(t){_n(this,t,6),Sn(this,t,6),An(this,t,6)},Pn.prototype.updateVertex=function(t,e,r,i,n){var o=e+i,a=r+n;En(this,t,6,[e,r,o,r,e,a,e,a,o,r,o,a])},Pn.prototype.updateTransform=function(t,e){Bn(this,t,6,e)},Pn.prototype.addTransform=function(t,e){wn(this,e,6,t)},Pn.prototype.updateColor=function(t,e){Mn(this,t,6,e)},Pn.prototype.addVertex=function(t,e,r,i,n){var o=t+r,a=e+i;kn(this,n,6,[t,e,o,e,t,a,t,a,o,e,o,a])},Pn.prototype.addColors=function(t,e){Dn(this,e,6,t)},Pn.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),zn(this),Tn(this),Cn(this),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},On.prototype=new bn,On.prototype.constructor=On,On.prototype.clear=function(t){_n(this,t,2),Sn(this,t,2)},On.prototype.updateTransform=function(t,e){Bn(this,t,2,e)},On.prototype.addTransform=function(t,e){wn(this,e,2,t)},On.prototype.updateVertex=function(t,e,r,i,n){En(this,t,2,[e,r,i,n])},On.prototype.updateColor=function(t,e){Mn(this,t,2,e)},On.prototype.addVertex=function(t,e,r,i,n){kn(this,n,2,[t,e,r,i])},On.prototype.addColors=function(t,e){Dn(this,e,2,t)},On.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),Cn(this),zn(this),Tn(this),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},Ln.prototype=new bn,Ln.prototype.constructor=Ln,Ln.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update();for(var e=0,r=t.length;e<r;e++)this.shaderInstance.setUniformData("u_transformMatrix",t[e].dom.transformMatrix),this.shaderInstance.setAttributeData("a_position",t[e].dom.points),this.shaderInstance.setUniformData("u_color",t[e].dom.color),this.geometry.setDrawRange(0,t[e].dom.points.length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},Nn.prototype=new bn,Nn.prototype.constructor=Nn,Nn.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),this.shaderInstance.useProgram();for(var e=0,r=t.length;e<r;e++)this.shaderInstance.setUniformData("u_transformMatrix",t[e].dom.transformMatrix),this.shaderInstance.setAttributeData("a_position",t[e].dom.points),this.shaderInstance.setUniformData("u_color",t[e].dom.color),this.geometry.setDrawRange(0,t[e].dom.points.length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},Fn.prototype=new bn,Fn.prototype.constructor=Fn,Fn.prototype.clear=function(t){_n(this,t,1),Sn(this,t,1),An(this,t,1),(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterSizeFlag=!0},Fn.prototype.updateTransform=function(t,e){Bn(this,t,1,e)},Fn.prototype.addTransform=function(t,e){wn(this,e,1,t)},Fn.prototype.updateVertex=function(t,e,r){En(this,t,1,[e,r])},Fn.prototype.updateColor=function(t,e){Mn(this,t,1,e)},Fn.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},Fn.prototype.addVertex=function(t,e,r){kn(this,r,1,[t,e])},Fn.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},Fn.prototype.addColors=function(t,e){Dn(this,e,1,t)},Fn.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),Cn(this),zn(this),Tn(this),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setAttributeData("a_radius",this.typedSizeArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},Rn.prototype=new bn,Rn.prototype.constructor=Rn,Rn.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.update(),this.shaderInstance.useProgram(),this.shaderInstance.applyAttributeData("a_texCoord",this.textCoor);for(var e,r=void 0!==this.style.opacity?this.style.opacity:1,i=0,n=t.length;i<n;i++){var o=t[i];o.dom.textureNode&&o.dom.textureNode.updated&&("none"!==o.style.display&&(this.shaderInstance.applyUniformData("u_transformMatrix",o.dom.transformMatrix),o.dom.textureNode!==e&&(o.dom.textureNode.loadTexture(),e=o.dom.textureNode,this.shaderInstance.applyUniformData("u_image",o.dom.textureNode)),this.shaderInstance.applyAttributeData("a_position",o.dom.positionArray),this.shaderInstance.applyUniformData("u_opacity",((void 0!==o.style.opacity?o.style.opacity:1)*r).toFixed(2)),this.shaderInstance.draw()))}this.renderTarget&&this.renderTarget instanceof Hn&&this.renderTarget.clear()},Xn.prototype=new je,Xn.prototype.reIndexChildren=function(t){for(var e=t||this,r=e.children,i=0,n=(r=r.filter((function(t){return t}))).length;i<n;i++)r[i].dom.pindex=i;e.children=r},Xn.prototype.applyTransformationMatrix=function(t){this.dom.applyTransformationMatrix(t),this.children.forEach((function(t){t.applyTransformationMatrix(self.dom.transformMatrix)}))},Xn.prototype.setAttr=function(t,e){var r=this;if(2===arguments.length)null===e&&null!==this.attr[t]?delete this.attr[t]:this.attr[t]=e,this.dom.setAttr(t,e),"transform"===t&&this.children.length>0&&this.children.forEach((function(t){t.applyTransformationMatrix(r.dom.transformMatrix)}));else if(1===arguments.length&&"object"==typeof t)for(var i in t)null===t[i]&&null!==this.attr[t]?delete this.attr[i]:this.attr[i]=t[i],this.dom.setAttr(i,t[i]),"transform"===t&&this.children.length>0&&this.children.forEach((function(t){t.applyTransformationMatrix(r.dom.transformMatrix)}));return this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex),this},Xn.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex),this)},Xn.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex),this},Xn.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex),this},Xn.prototype.setStyle=function(t,e){if(2===arguments.length)null===e&&null!=this.style[t]?delete this.style[t]:("fill"!==t&&"stroke"!==t||(e=Rt.colorToRGB(e)),this.style[t]=e),this.dom.setStyle(t,e);else if(1===arguments.length&&"object"==typeof t)for(var r in t)null===(e=t[r])&&null!=this.style[r]?delete this.style[r]:("fill"!==r&&"stroke"!==r||(e=Rt.colorToRGB(e)),this.style[r]=e),this.dom.setStyle(r,e);return Ni.vDomChanged(this.vDomIndex),this},Xn.prototype.setReIndex=function(){this.reindex=!0},Xn.prototype.updateBBox=function(){var t;if(this.bbox){for(var e=0,r=this.children.length;e<r;e+=1)this.children[e]&&(t=this.children[e].updateBBox()||t);if(this.BBoxUpdate||t)return this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0}return!1},Xn.prototype.in=function(t){return this.dom.in(t)},Xn.prototype.on=function(t,e){if(this.events||(this.events={}),null===e&&null!==this.events[t])delete this.events[t];else if(e)if("function"==typeof e){var r=e.bind(this);this.events[t]=function(t){r(t)}}else"object"==typeof e&&(this.events[t]=e,e.constructor!==Fi.constructor&&e.constructor!==Ri.constructor||e.bindMethods(this));return this},Xn.prototype.execute=function(){if("none"!==this.style.display)if(!this.dom.shader&&!this.dom.shaderGroup&&this.dom instanceof yn)for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();else if(this.dom.shader&&this.dom instanceof yn)this.reindex&&(this.reIndexChildren(),this.reindex=!1),this.exeCtx&&this.exeCtx(this.ctx),this.dom.shader.execute(this.children);else if(this.dom.shaderGroup&&this.dom instanceof yn)for(var r in this.exeCtx&&this.exeCtx(this.ctx),this.dom.shaderGroup){var i=this.dom.shaderGroup[r];i.reindex&&(this.reIndexChildren(i),i.reindex=!1),i.shader.execute(i.children)}},Xn.prototype.child=function(t){var e,r=this;if(r.dom instanceof yn)for(var i=0;i<t.length;i+=1)(e=t[i]).dom.parent=r,r.children[r.children.length]=e,e.dom.pindex=r.children.length-1,e instanceof gn||e.dom instanceof yn||(this.dom.shader?e.el===this.dom.shader.attr.shaderType?e.dom.setShader(this.dom.shader):(console.warn("wrong el type '"+e.el+"' being added to shader group - '"+this.dom.shader.attr.shaderType+"'"),r.children.pop()):(this.dom.shaderGroup||(this.dom.shaderGroup={}),this.dom.shaderGroup[e.el]||(this.dom.shaderGroup[e.el]={children:[],shader:jn(r.ctx,r.attr,r.style,e.el,r.renderTarget,r.vDomIndex)}),this.dom.shaderGroup[e.el].children[this.dom.shaderGroup[e.el].children.length]=e,e.dom.pindex=this.dom.shaderGroup[e.el].children.length-1,e.dom.setShader(this.dom.shaderGroup[e.el].shader))),r.dom.attr&&r.dom.attr.transform&&e.applyTransformationMatrix(r.dom.transformMatrix);else console.log("Error");return this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex),r},Xn.prototype.createEls=function(t,e){var r=new $i({type:"WEBGL",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(r.stack),Ni.vDomChanged(this.vDomIndex),r},Xn.prototype.createEl=function(t){var e=new Xn(this.ctx,t,Xi(),this.vDomIndex);return this.child([e]),Ni.vDomChanged(this.vDomIndex),e},Xn.prototype.createShaderEl=function(t){var e=new gn(this.ctx,t,this.vDomIndex);return this.child([e]),Ni.vDomChanged(this.vDomIndex),e},Xn.prototype.remove=function(){var t=this.dom.parent.children,e=t.indexOf(this);if(-1!==e)if(this.dom.parent.dom.shader)this.dom.parent.dom.shader.indexBased&&this.dom.parent.dom.shader.clear(this.dom.pindex),this.dom.parent.setReIndex(),t[this.dom.pindex]=void 0;else if(this.dom.parent.dom.shaderGroup){var r=this.dom.parent.dom.shaderGroup[this.el];if(r){var i=r.children.indexOf(this);r.reindex=!0,r.shader.indexBased&&(r.shader.clear(this.dom.pindex),this.dom.parent.setReIndex()),r.children[i]=void 0}t[e]=void 0}else t.splice(e,1);this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex)},Xn.prototype.removeChild=function(t){var e=-1;if(this.children.forEach((function(r,i){r===t&&(e=i)})),-1!==e){var r=this.children.splice(e,1)[0];this.dom.removeChild(r.dom)}this.BBoxUpdate=!0,Ni.vDomChanged(this.vDomIndex)},Un.prototype.setAttr=function(t,e){if(1===arguments.length)for(var r in t)this[r]=t[r],"src"===r&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Gn(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement||e instanceof Uint8Array?(this.image=e,this.update()):e instanceof je&&(this.image=e.domEl,this.update())),(t.height||t.width)&&(self.image=Yn(this.width,this.height));else this[t]=e,console.warning("Instead of key, value, pass Object of key,value for optimal rendering"),"src"===t&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Gn(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement||e instanceof Uint8Array?(this.image=e,this.update()):e instanceof je&&(this.image=e.domEl,this.update()))},Un.prototype.loadTexture=function(){this.updated&&(this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.texture))},Un.prototype.clear=function(t){},Un.prototype.update=function(){var t=this.ctx;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),!this.image||this.image instanceof Uint8Array?t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],this.width,this.height,0,t[this.format],t[this.type],this.image):t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],t[this.format],t[this.type],this.image),this.mipMap?(dn(self.image.width)&&dn(self.image.height)||console.warn("Image dimension not in power of 2"),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.magFilter])):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this.warpS]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this.warpT]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.minFilter])),this.updated=!0},Hn.prototype.setAttr=function(t,e){this[t]=e},Hn.prototype.update=function(){this.texture&&this.texture instanceof Un&&(this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.fbo),this.ctx.framebufferTexture2D(this.ctx.FRAMEBUFFER,this.ctx.COLOR_ATTACHMENT0,this.ctx.TEXTURE_2D,this.texture.texture,0),this.ctx.clearColor(0,0,0,0),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT))},Hn.prototype.clear=function(){this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null)},Vn.prototype.setAttr=function(t,e){!e&&this.attributes[t]?delete this.attributes[t]:this.attributes[t]=e},Vn.prototype.setDrawRange=function(t,e){this.drawRange=[t,e]},Vn.prototype.setDrawType=function(t){this.drawType=t},Vn.prototype.setIndex=function(t){this.indexes=t},qn.prototype=new Vn,qn.constructor=qn,Zn.prototype=new Vn,Zn.constructor=Zn,Wn.prototype=new Vn,Wn.constructor=Wn;var Qn=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],$n=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];var Jn=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},Kn={blur:function(t){return void 0===t&&(t=1),function(e){return function(t,e,r,i,n,o){for(var a,s=t.data,h=2*o+1,c=i-1,l=n-1,d=o+1,f=d*(d+1)/2,u=new Jn,p=u,y=1;y<h;y++)p=p.next=new Jn,y===d&&(a=p);p.next=u;for(var x=null,v=null,m=0,g=0,b=Qn[o],w=$n[o],B=0;B<n;B++){p=u;for(var A=s[g],T=s[g+1],k=s[g+2],E=s[g+3],S=0;S<d;S++)p.r=A,p.g=T,p.b=k,p.a=E,p=p.next;for(var C=0,D=0,M=0,_=0,z=d*A,I=d*T,P=d*k,O=d*E,L=f*A,N=f*T,F=f*k,R=f*E,j=1;j<d;j++){var X=g+((c<j?c:j)<<2),G=s[X],Y=s[X+1],U=s[X+2],H=s[X+3],V=d-j;L+=(p.r=G)*V,N+=(p.g=Y)*V,F+=(p.b=U)*V,R+=(p.a=H)*V,C+=G,D+=Y,M+=U,_+=H,p=p.next}x=u,v=a;for(var q=0;q<i;q++){var Z=R*b>>w;if(s[g+3]=Z,0!==Z){var W=255/Z;s[g]=(L*b>>w)*W,s[g+1]=(N*b>>w)*W,s[g+2]=(F*b>>w)*W}else s[g]=s[g+1]=s[g+2]=0;L-=z,N-=I,F-=P,R-=O,z-=x.r,I-=x.g,P-=x.b,O-=x.a;var Q=q+o+1;Q=m+(Q<c?Q:c)<<2,L+=C+=x.r=s[Q],N+=D+=x.g=s[Q+1],F+=M+=x.b=s[Q+2],R+=_+=x.a=s[Q+3],x=x.next;var $=v,J=$.r,K=$.g,tt=$.b,et=$.a;z+=J,I+=K,P+=tt,O+=et,C-=J,D-=K,M-=tt,_-=et,v=v.next,g+=4}m+=i}for(var rt=0;rt<i;rt++){var it=s[g=rt<<2],nt=s[g+1],ot=s[g+2],at=s[g+3],st=d*it,ht=d*nt,ct=d*ot,lt=d*at,dt=f*it,ft=f*nt,ut=f*ot,pt=f*at;p=u;for(var yt=0;yt<d;yt++)p.r=it,p.g=nt,p.b=ot,p.a=at,p=p.next;for(var xt=i,vt=0,mt=0,gt=0,bt=0,wt=1;wt<=o;wt++){g=xt+rt<<2;var Bt=d-wt;dt+=(p.r=it=s[g])*Bt,ft+=(p.g=nt=s[g+1])*Bt,ut+=(p.b=ot=s[g+2])*Bt,pt+=(p.a=at=s[g+3])*Bt,bt+=it,vt+=nt,mt+=ot,gt+=at,p=p.next,wt<l&&(xt+=i)}g=rt,x=u,v=a;for(var At=0;At<n;At++){var Tt=g<<2;s[Tt+3]=at=pt*b>>w,at>0?(at=255/at,s[Tt]=(dt*b>>w)*at,s[Tt+1]=(ft*b>>w)*at,s[Tt+2]=(ut*b>>w)*at):s[Tt]=s[Tt+1]=s[Tt+2]=0,dt-=st,ft-=ht,ut-=ct,pt-=lt,st-=x.r,ht-=x.g,ct-=x.b,lt-=x.a,Tt=rt+((Tt=At+d)<l?Tt:l)*i<<2,dt+=bt+=x.r=s[Tt],ft+=vt+=x.g=s[Tt+1],ut+=mt+=x.b=s[Tt+2],pt+=gt+=x.a=s[Tt+3],x=x.next,st+=it=v.r,ht+=nt=v.g,ct+=ot=v.b,lt+=at=v.a,bt-=it,vt-=nt,mt-=ot,gt-=at,v=v.next,g+=i}}return t}(e,0,0,e.width,e.height,t)}},greyScale:function(){}},to=Mt.instance,eo=ni,ro=oi;t.Path=to,t.behaviour=mr,t.canvasLayer=eo,t.canvasNodeLayer=ro,t.chain=yt,t.color=Rt,t.ease=J,t.geometry=F,t.queue=x,t.svgLayer=function(t,e){void 0===e&&(e={});var r=document.querySelector(t),i=r.clientHeight,n=r.clientWidth,o=e.autoUpdate;void 0===o&&(o=!0);var a=e.enableResize;void 0===a&&(a=!0);var s,h=document.createElementNS(rr.svg,"svg");h.setAttribute("height",i),h.setAttribute("width",n),h.style.position="absolute";var c,l,d,f,u=999999;r&&(r.appendChild(h),s=new v,o&&(u=qe.addVdom(s)));var p=new or(h,{},We(),u);p.container=r,p.type="SVG",p.width=n,p.height=i,p.domEl=h;var y=new jt(p);s&&s.rootNode(p),p.setLayerId=function(t){h.setAttribute("id",t)},p.onResize=function(t){d=t},p.onChange=function(t){f=t},p.invokeOnChange=function(){f&&f()},p.setSize=function(t,e){this.dom.setAttribute("height",e),this.dom.setAttribute("width",t),this.width=t,this.height=e,c=e,l=t},p.update=function(){this.execute()},p.setViewBox=function(t,e,r,i){this.dom.setAttribute("viewBox",t+","+e+","+i+","+r)},p.destroy=function(){var e=document.querySelector(t);e&&e.contains(h)&&e.removeChild(h),qe.removeVdom(u)},p.createPattern=function(t){return new Ke(this,t)},p.createClip=function(t){return new Je(this,t)},p.createMask=function(t){return new $e(this,t)};var x=null;return p.dom.addEventListener("pointerdown",(function(t){y.addPointer(t),t.target.drag_&&(t.target.drag_(t,"pointerdown",y),x=t.target)})),p.dom.addEventListener("pointerup",(function(t){x&&(x.drag_(t,"pointerup",y),x=null),y.removePointer(t)})),p.dom.addEventListener("pointermove",(function(t){t.preventDefault(),x&&x.drag_(t,"pointermove",y)})),qe.execute(),a&&He(p,(function(e){document.querySelector(t)?(i=c||e.height,n=l||e.width,h.setAttribute("height",i),h.setAttribute("width",n),p.width=n,p.height=i,d&&d(),p.update()):Ve(p)})),p},t.utility=Kn,t.webglLayer=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r={});var i=t?document.querySelector(t):null,n=i?i.clientHeight:0,o=i?i.clientWidth:0,a=Rt.rgba(0,0,0,0),s=r.enableEvents;void 0===s&&(s=!1);var h=r.autoUpdate;void 0===h&&(h=!0);var c=r.enableResize;void 0===c&&(c=!1),(e=e||{premultipliedAlpha:!1,depth:!1,antialias:!1,alpha:!0}).premultipliedAlpha=void 0!==e.premultipliedAlpha&&e.premultipliedAlpha,e.depth=void 0!==e.depth&&e.depth,e.antialias=void 0!==e.antialias&&e.antialias,e.alpha=void 0===e.alpha||e.alpha;var l,d=document.createElement("canvas"),f=d.getContext("webgl",e),u=function(t){var e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);return e<1?1:e}(f);Oi=u>=2?2:Math.floor(u),d.setAttribute("height",n*Oi),d.setAttribute("width",o*Oi),d.style.height=n+"px",d.style.width=o+"px",d.style.position="absolute";var p,y,x=999999;i&&(i.appendChild(d),l=new v,h&&(x=Ni.addVdom(l)));var m=new Xn(f,{el:"group",attr:{id:"rootNode"},ctx:function(t){t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.clearColor(a.r,a.g,a.b,a.a)}},Xi(),x);l&&l.rootNode(m);var g=m.execute.bind(m);m.container=i,m.domEl=d,m.height=n,m.width=o,m.type="WEBGL",m.ctx.pixelRatio=Oi;var b=function(t){t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)};m.execute=function(){b(this.ctx),this.updateBBox(),this.ctx.enable(this.ctx.BLEND),this.ctx.blendFunc(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA),g()},m.update=function(){this.execute()},m.destroy=function(){var e=document.querySelector(t);e&&e.contains(d)&&e.removeChild(d),Ni.removeVdom(x)},m.getPixels=function(t,e,r,i){var n=new Uint8Array(r*i*4);return this.ctx.readPixels(t,e,r,i,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,n),n},m.putPixels=function(t,e,r){return this.ctx.putImageData(t,e,r)},m.clear=function(){b(this.ctx)},m.setClearColor=function(t){a=t},m.setClear=function(t){b=t};var w=function(t,e,r){t.width=Math.floor(e*Oi),t.height=Math.floor(r*Oi),t.style.height=r+"px",t.style.width=e+"px"};if(m.onResize=function(t){p=t},m.onChange=function(t){y=t},m.invokeOnChange=function(){y&&y()},m.setPixelRatio=function(t){Oi=t,this.ctx.pixelRatio=Oi,w(this.domEl,this.width,this.height)},m.setSize=function(t,e){this.width=t,this.height=e,n=e,o=t,w(this.domEl,this.width,this.height),this.execute()},m.setViewBox=function(t,e,r,i){},m.setStyle=function(t,e){this.domEl.style[t]=e},m.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),d.setAttribute(t,e)},m.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},m.MeshGeometry=function(){return new qn(this.ctx)},m.PointsGeometry=function(){return new Zn(this.ctx)},m.LineGeometry=function(){return new Wn(this.ctx)},m.createWebglTexture=function(t){return new Un(this.ctx,t,this.vDomIndex)},m.RenderTarget=function(t){return new Hn(this.ctx,t,this.vDomIndex)},s){var B=new jt(m);d.addEventListener("mousemove",(function(t){t.preventDefault(),B.mousemoveCheck(t)})),d.addEventListener("mousedown",(function(t){B.mousedownCheck(t)})),d.addEventListener("mouseup",(function(t){B.mouseupCheck(t)})),d.addEventListener("mouseleave",(function(t){B.mouseleaveCheck(t)})),d.addEventListener("contextmenu",(function(t){B.contextmenuCheck(t)})),d.addEventListener("touchstart",(function(t){B.touchstartCheck(t)})),d.addEventListener("touchend",(function(t){B.touchendCheck(t)})),d.addEventListener("touchmove",(function(t){t.preventDefault(),B.touchmoveCheck(t)})),d.addEventListener("touchcancel",(function(t){B.touchcancelCheck(t)})),d.addEventListener("wheel",(function(t){B.wheelEventCheck(t)})),d.addEventListener("pointerdown",(function(t){B.addPointer(t),B.pointerdownCheck(t)})),d.addEventListener("pointerup",(function(t){B.removePointer(t),B.pointerupCheck(t)})),d.addEventListener("pointermove",(function(t){t.preventDefault(),B.pointermoveCheck(t)}))}return Ni.execute(),c&&m.container&&He(m,(function(e){document.querySelector(t)?(n=e.height,o=e.width,m.width=o,m.height=n,w(m.domEl,o,n),b(m.ctx),p&&p(),m.execute(),d.style.height=n+"px",d.style.width=o+"px"):Ve(m)})),m},Object.defineProperty(t,"__esModule",{value:!0})}));
