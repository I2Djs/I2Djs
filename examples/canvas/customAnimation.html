<!DOCTYPE html>
<html style="height: 100%">
<head>
	<title></title>
</head>
<body style="height: 100%">
    <div id="fps" style="position: absolute;top:10px;left: 90%;height: 50px;width: 100px; background: #888888;color: #fff;font-size: 40px;text-align: center">
        70
    </div>
	<div style="position: absolute; height: 100%;width:100%" id="myCanvas">
	</div>
	<script type="text/javascript" src="../../dist/i2d.js"></script>

	<script type="text/javascript">

        var renderer = i2d.CanvasLayer('#myCanvas',{events:false,selectiveClear:false});
        var nodes = [];
        var data= [],circles = [];

            for(var i=1;i<=10;i++){
                data.push(i-10/2);
            }
            for(var i=1;i<=20;i++){
                circles.push(i);
            }

        var g_ = renderer.createEls(data,{
                el:'group',
                attr:{
                    transform:{
                        translate:[100,300]
                    }
                }
            })
            .forEach(function(d,i){

                var path = this.createEl({
                                el:'path',
                                attr:{
                                    d: pathGenerator(0,(40*d),((60*d)),1300)
                                },
                                style:{
                                    lineWidth:2,
                                    setLineDash:[4,2],
                                    strokeStyle:'#f00000'
                                }
                            })
                    var length = path.node().getTotalLength();

                    this.createEls(circles,{
                        el:'group',
                        attr:{

                        }
                    }).forEach(function(d,i){

                        this.createEl({
                                el:'image',
                                attr:{
                                    src:'Linux_HISH.png',
                                    width:20,
                                    height:20,
                                    x:-10,
                                    y:-10
                                }
                            })
                            .on('mouseover',function(){
                                this.animateTo({
                                    duration:100,
                                    attr:{
                                        transform:{
                                            scale:[2]
                                        }
                                    }
                                })
                            })
                            .on('mouseout',function(){
                                this.animateTo({
                                    duration:100,
                                    attr:{
                                        transform:{
                                            scale:[1]
                                        }
                                    }
                                })
                            });

                            this.createEl({
                                el:'text',
                                attr:{
                                    x:-25,
                                    y:20
                                },
                                style:{
                                    fillStyle:'red'
                                }
                            })
                            .text('10.75.10.3');

                    })
                    .animateTo({
                                duration:3000,
                                ease:'easeInOutCubic',
                                delay:function(d,i){
                                    return 70*d;
                                },
                                attr:{

                                    transform:function(data,i){

                                                var Tlength = length - i* 50;
                                                var dim = (Tlength < 0 || Tlength > length) ? 0 : (Tlength >= 300 && Tlength <= (1300 - 300) ) ? 1.7 : (Tlength < 300) ? ((1.5 / 300) * Tlength) : ((1.5 / 300) * (1300 - Tlength));
							                        dim = dim < 0 ? 0.5 : dim;
                                                
                                                return function(f){
                                                    var point = path.node().getPointAtLength(f*Tlength);
                                                    // var angle = path.node().getAngleAtLength(f*Tlength,'dest');

                                                    return {
                                                        translate:[point.x,point.y],
                                                        // scale:[dim+(1-f)*(1.5-dim)]
                                                        // ,
                                                        // rotate:[(angle*180/Math.PI)]
                                                    };
                                                }

                                    }
                                }
                            })
            })
        
        function pathGenerator(x,y,y1,width){

				var startBegin={x:0,
								y:y
							},
					startEnd={x:startBegin.x+width*0.2,
							  y:y1},
					endBegin={
								x:startEnd.x+width*0.6,
							  	y:y1
							},
					endEnd={
								x:width,
							  	y:y
							};
				var c1 = {
						x:startBegin.x+(startEnd.x- startBegin.x)*0.6,
						y:startEnd.y+(startBegin.y- startEnd.y)*0.9
					},
					c2 = {
						x:startBegin.x+(startEnd.x- startBegin.x)/2,
						y:startEnd.y+(startBegin.y- startEnd.y)*0.05
					},
					c3 = {
						x:endBegin.x+(endEnd.x- endBegin.x)/2,
						y:endEnd.y+(endBegin.y- endEnd.y)*0.05
					},
					c4 = {
						x:endBegin.x+(endEnd.x- endBegin.x)*0.6,
						y:endEnd.y+(endBegin.y- endEnd.y)*0.9
					};

				return "M"+startBegin.x+","+startBegin.y+
						" C"+c1.x+","+c1.y+" "+c2.x+","+c2.y +" "+startEnd.x+","+startEnd.y +
						" h"+width*0.6+
						" C"+c4.x+","+c4.y+" "+c3.x+","+c3.y +" "+endEnd.x+","+endEnd.y;
		}
	</script>

</body>
</html>